!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=309)}({309:function(e,t){function n(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var s=e.apply(t,r);function i(e){n(s,o,a,i,l,"next",e)}function l(e){n(s,o,a,i,l,"throw",e)}i(void 0)}))}}function o(e,t,n){return String.fromCharCode.apply(null,e.split("").map((function(e,r){var o=t[r%t.length].charCodeAt();return n&&(o=-o),(e.charCodeAt()+o+65536)%65536})))}function a(){return s.apply(this,arguments)}function s(){return(s=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:/[/][/].*[.]sharepoint[.]com.*/i.test(Office.context.document.url)?self.location=Office.context.document.url.replace(/(.*)[/][^/]*$/i,"$1"):self.location="https://anthroplogic.com";case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(){return l.apply(this,arguments)}function l(){return(l=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,a,s,i,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.contentControls.getByTag("ws365_quiz")).load(["length","items","text","title"]),(r=t.document.contentControls.getByTag("ws365_solutions")).load(["length","items","text","title"]),e.next=6,t.sync();case 6:if(i=new DOMParser,l=i.parseFromString(o(r.items[0].title,r.items[0].id.toString(),!0),"text/xml"),null==(c=l.evaluate("/solutions[1]",l,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=13;break}return c.childNodes.forEach((function(e,t,o){try{console.log("value",e);var i=l.evaluate("id",e,null,XPathResult.ANY_TYPE,null).iterateNext().childNodes[0].nodeValue.trim();console.log("valueID",i);var c=l.evaluate("content",e,null,XPathResult.ANY_TYPE,null).iterateNext().childNodes[0].nodeValue.trim(),u=n.items.filter((function(e){return e.title.split("/")[0].split(";")[0].trim()==i}));console.log("questionCC",u),0==u.length?(s=!1,a=r.items[0].insertParagraph(s?"OK":"KO",Word.InsertLocation.after).insertContentControl()):(s=u[0].text.trim()==c,a=u[0].insertParagraph(s?"OK":"KO",Word.InsertLocation.after).insertContentControl()),a.appearance=Word.ContentControlAppearance.tags,a.color=s?"green":"red",a.font.highlightColor=s?"green":"red",a.tag="ws365_grade",a.title=" "+i+" / ws365_grade "}catch(e){console.log(e)}})),e.next=13,t.sync();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e,t,n){return u.apply(this,arguments)}function u(){return(u=r(regeneratorRuntime.mark((function e(t,n,r){var o,a,s,i,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=document.createElement("PRE"),Office.context.platform!=Office.PlatformType.PC){e.next=16;break}return(a=n.split(["\n"],!1,!1)).load(["items","text"]),e.next=6,t.sync();case 6:console.log(a),s=a.items.map((function(e){return e.text})).join(""),o.innerHTML=hljs.highlight(r,s.substr(0,s.length)).value,document.body.getElementsByClassName("ws365_canvas")[0].appendChild(o),computedStyleToInlineStyle(o,{recursive:!0,properties:["color","font-style","font-weight"]}),console.log(o.innerHTML),n.insertHtml("<pre>"+o.innerHTML.replace(/\u000B/g,"<br/>").replace(/\n/g,"\r\n")+"\r\n</pre>","Replace"),n.styleBuiltIn="NoSpacing",e.next=28;break;case 16:return(a=n.split(["\n"],!1,!1)).load(["items","text"]),e.next=20,t.sync();case 20:for(i=a.items.map((function(e){return e.text})).join(""),o.innerHTML=hljs.highlight(r,i.substr(0,i.length-1)).value,document.body.getElementsByClassName("ws365_canvas")[0].appendChild(o),computedStyleToInlineStyle(o,{recursive:!0,properties:["color","font-style","font-weight"]}),l=o.innerHTML.split(/\r\n|\n|\r|\u000B/g),console.log(l),n.clear(),c=0;c<l.length;c++)c!=l.length-1?n.insertHtml(l[c].replace(/  /g,"&nbsp;&nbsp;")+"<br/>","End"):0!=l[c].length&&n.insertHtml(l[c].replace(/  /g,"&nbsp;&nbsp;"),"End");case 28:return n.font.name="Consolas",e.next=31,t.sync();case 31:document.body.getElementsByClassName("ws365_canvas")[0].removeChild(o),o.innerHTML="";case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return m.apply(this,arguments)}function m(){return(m=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).load(["isEmpty"]),e.next=4,t.sync();case 4:return(n=r.isEmpty?t.document.body.contentControls:r.contentControls).load(["items","tag"]),e.next=8,t.sync();case 8:o=0;case 9:if(!(o<n.items.length)){e.next=18;break}if(!/ws365_code_.*/i.test(n.items[o].tag)){e.next=15;break}return a="output"==(a=n.items[o].tag.match(/ws365_code_(.*)/i)[1])?"text":a,e.next=15,c(t,n.items[o],a);case 15:o++,e.next=9;break;case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(n){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n.document.getSelection()).load(["isEmpty"]),e.next=4,n.sync();case 4:return(r=o.isEmpty?n.document.body.contentControls.getByTag(t):o.contentControls.getByTag(t)).load(["items","tag"]),e.next=8,n.sync();case 8:for(a=0;a<r.items.length;a++)r.items[a].clear(),"ws365_quiz"==t&&(r.items[a].color="yellow",r.items[a].font.highlightColor="yellow");return e.next=11,n.sync();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return h.apply(this,arguments)}function h(){return(h=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,a,s,i,l,u,g,m,d,p,f,h,y,x,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).load(["isEmpty"]),e.next=4,t.sync();case 4:return(n=r.isEmpty?t.document.body.search("[<]ws365[>]*[<]/ws365[>]",{matchWildcards:!0}):r.search("[<]ws365[>]*[<]/ws365[>]",{matchWildcards:!0})).load(["text"]),e.next=8,t.sync();case 8:a=new DOMParser,"",document.createElement("PRE"),h=0;case 12:if(!(h<n.items.length)){e.next=102;break}if(e.prev=13,y=new RegExp("^[^]*$","g"),s=a.parseFromString(n.items[h].text,"text/xml"),null==(i=s.evaluate("/ws365/content[child::title and child::tag][1]",s,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=25;break}return g=i.getElementsByTagName("title")[0].childNodes[0].nodeValue,(f=t.document.contentControls.getByTitle(g)).load("length"),e.next=23,t.sync();case 23:0==f.items.length&&((p=n.items[h].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,p.color="blue",p.tag=i.getElementsByTagName("tag")[0].childNodes[0].nodeValue,p.title=g),0!=i.getElementsByTagName("clean").length&&(n.items[h].delete(),n.items[h].paragraphs.getLast().delete());case 25:if(null==(i=s.evaluate("/ws365/quiz[child::id][1]",s,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=35;break}return u=0!=i.getElementsByTagName("weight").length?i.getElementsByTagName("weight")[0].childNodes[0].nodeValue.trim():"10",g=" "+i.getElementsByTagName("id")[0].childNodes[0].nodeValue.trim()+" ; "+u+" / quiz ",(f=t.document.contentControls.getByTitle(g)).load("length"),e.next=33,t.sync();case 33:0==f.items.length&&((p=n.items[h].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,p.color="yellow",p.font.highlightColor="yellow",p.tag="ws365_quiz",p.title=g),0!=i.getElementsByTagName("clean").length&&(n.items[h].delete(),n.items[h].paragraphs.getLast().delete());case 35:if(null==(i=s.evaluate("/ws365/solutions[1]",s,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=55;break}return(f=t.document.contentControls.getByTag("ws365_solutions")).load(["length","title"]),e.next=41,t.sync();case 41:if(0!=f.items.length){e.next=53;break}return(p=n.items[h].insertParagraph("ws365_solutions",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.hidden,p.color="cyan",p.font.highlightColor="cyan",p.tag="ws365_solutions",p.cannotEdit=!0,e.next=50,t.sync();case 50:p.title=o(i.parentNode.innerHTML,p.id.toString(),!1),e.next=54;break;case 53:f.items[0].title=o(i.parentNode.innerHTML,f.items[0].id.toString(),!1);case 54:0!=i.getElementsByTagName("clean").length&&(n.items[h].delete(),n.items[h].paragraphs.getLast().delete());case 55:if(null==(i=s.evaluate("/ws365/code[child::id and child::lang][1]",s,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=91;break}return l=i.getElementsByTagName("lang")[0].childNodes[0].nodeValue.trim(),g=" "+i.getElementsByTagName("id")[0].childNodes[0].nodeValue.trim()+" / "+l+" ",(f=t.document.contentControls.getByTitle(g)).load("length"),e.next=63,t.sync();case 63:if(0!=f.items.length){e.next=87;break}if((p=n.items[h].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,p.color="purple",p.tag="ws365_code_"+l,p.title=g,0==i.getElementsByTagName("url").length){e.next=80;break}return 0!=i.getElementsByTagName("regex").length&&(y=new RegExp(i.getElementsByTagName("regex")[0].childNodes[0].nodeValue,"g")),e.next=73,fetch(i.getElementsByTagName("url")[0].childNodes[0].nodeValue.trim());case 73:return m=e.sent,e.next=76,m.text();case 76:for(d=e.sent,x=0,w=void 0;null!==(w=y.exec(d));)0!=x&&p.insertParagraph("",Word.InsertLocation.end),null==w[1]?p.insertText(w[0],"End"):p.insertText(w[1],"End"),x++;case 80:return 0!=i.getElementsByTagName("content").length&&i.getElementsByTagName("content")[0].hasChildNodes()&&p.insertText(i.getElementsByTagName("content")[0].childNodes[0].nodeValue,Word.InsertLocation.end),e.next=83,t.sync();case 83:return(f=t.document.contentControls.getByTitle(g)).load("length"),e.next=87,t.sync();case 87:if(0==i.getElementsByTagName("format").length){e.next=90;break}return e.next=90,c(t,f.items[0],l);case 90:0!=i.getElementsByTagName("clean").length&&(n.items[h].delete(),n.items[h].paragraphs.getLast().delete());case 91:e.next=97;break;case 93:e.prev=93,e.t0=e.catch(13),console.log("ERROR TO PROCESS: ",n.items[h].text),console.error(e.t0);case 97:return e.next=99,t.sync();case 99:h++,e.next=12;break;case 102:return e.abrupt("return",t.sync());case 103:case"end":return e.stop()}}),e,null,[[13,93]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return x.apply(this,arguments)}function x(){return(x=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}document.getElementById("process-tags").onclick=function(){return y(f)},document.getElementById("reformat-code").onclick=function(){return y(g)},document.getElementById("clear-output").onclick=function(){return y((function(){return d("ws365_code_output")}))},document.getElementById("clear-quiz").onclick=function(){return y((function(){return d("ws365_quiz")}))},document.getElementById("coq-taskpane").onclick=function(){self.location="./taskpane.html?et="},document.getElementById("anon-user").onclick=function(){return y(i)},document.getElementById("signed-in-user").onclick=function(){return y(a)},Office.onReady((function(e){e.host===Office.HostType.Word&&Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}});
//# sourceMappingURL=workschool365.js.map