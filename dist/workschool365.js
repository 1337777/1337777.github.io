!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=309)}({309:function(e,t){function n(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var i=e.apply(t,r);function s(e){n(i,o,a,s,c,"next",e)}function c(e){n(i,o,a,s,c,"throw",e)}s(void 0)}))}}if(Office.onReady((function(e){e.host===Office.HostType.Word&&Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})),document.documentMode){console.error("Unsupported Browser!");var o=document.createElement("div");o.innerHTML='<h1 style="color: orange">Unsupported Browser!</h1>\n   <h3>This add-in does not support the Internet Explorer web browser, \n  consider upgrading your host to Microsoft Edge \n  ( <a target="_blank" href="https://developer.microsoft.com/en-us/microsoft-edge/">https://developer.microsoft.com/en-us/microsoft-edge/</a> ) \n  or to Microsoft Word with the latest Microsoft Edge WebView 2 \n  ( <a target="_blank" href="https://developer.microsoft.com/en-us/microsoft-edge/webview2/">https://developer.microsoft.com/en-us/microsoft-edge/webview2/</a> ) </h3>',document.body.insertBefore(o,document.body.firstChild)}function a(e){return i.apply(this,arguments)}function i(){return(i=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function s(){return(s=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Word.run(function(){var e=r(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.document.getSelection().insertParagraph(t.textContent.replace(/\s+/g," ").replace(/> </g,"><").trim(),"After").select(),e.next=4,n.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e,t,n){return String.fromCharCode.apply(null,e.split("").map((function(e,r){var o=t[r%t.length].charCodeAt();return n&&(o=-o),(e.charCodeAt()+o+65536)%65536})))}function l(){return u.apply(this,arguments)}function u(){return(u=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:/^https:[/][/][^/]*sharepoint[.]com.*/i.test(Office.context.document.url)?self.location=Office.context.document.url.replace(/(.*)[/][^/]*$/i,"$1"):self.location="https://anthroplogic.com";case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return e.replace(/[^\w]/g," ").replace(/[\n\s]+/g," ").trim().toLowerCase()}function m(){return p.apply(this,arguments)}function p(){return(p=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a,i,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.contentControls.getByTag("ws365_quiz")).load(["length","items","text","title"]),(r=t.document.contentControls.getByTag("ws365_solutions")).load(["length","items","text","title"]),e.next=6,t.sync();case 6:if(0==r.items.length){e.next=14;break}if(i=new DOMParser,s=i.parseFromString(c(r.items[0].title,r.items[0].id.toString(),!0),"text/xml"),null==(l=s.evaluate("/solutions[1]",s,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=14;break}return l.childNodes.forEach((function(e,t,i){try{var c=s.evaluate("id",e,null,XPathResult.ANY_TYPE,null).iterateNext().childNodes[0].nodeValue.trim(),l=s.evaluate("content",e,null,XPathResult.ANY_TYPE,null).iterateNext().childNodes[0].nodeValue,u=n.items.filter((function(e){return e.title.split("/")[0].split(";")[0].trim()==c}));0==u.length?(a=!1,o=r.items[0].insertParagraph(a?"OK":"KO",Word.InsertLocation.after).insertContentControl()):(a=d(u[0].text)==d(l),o=u[0].insertParagraph(a?"OK":"KO",Word.InsertLocation.after).insertContentControl()),o.cannotEdit=!0,o.cannotDelete=!0,o.appearance=Word.ContentControlAppearance.tags,o.color=a?"green":"red",o.font.highlightColor=a?"green":"red",o.font.color="white",o.tag="ws365_grade",o.title=" "+c+" / grade "}catch(e){console.error(e)}})),e.next=14,t.sync();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,n){return f.apply(this,arguments)}function f(){return(f=r(regeneratorRuntime.mark((function e(t,n,r){var o,a,i,s,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=document.createElement("PRE"),Office.context.platform==Office.PlatformType.OfficeOnline){e.next=14;break}return(a=n.split(["\n"],!1,!1)).load(["items","text"]),e.next=6,t.sync();case 6:i=a.items.map((function(e){return e.text})).join(""),o.innerHTML=hljs.highlight(r,i.substr(0,i.length)).value,document.body.getElementsByClassName("ws365_canvas")[0].appendChild(o),computedStyleToInlineStyle(o,{recursive:!0,properties:["color","font-style","font-weight"]}),n.insertHtml("<pre>"+o.innerHTML.replace(/\u000B/g,"<br/>").replace(/\n/g,"\r\n")+"\r\n</pre>","Replace"),n.styleBuiltIn="NoSpacing",e.next=25;break;case 14:return(a=n.split(["\n"],!1,!1)).load(["items","text"]),e.next=18,t.sync();case 18:for(s=a.items.map((function(e){return e.text})).join(""),o.innerHTML=hljs.highlight(r,s.substr(0,s.length-1)).value,document.body.getElementsByClassName("ws365_canvas")[0].appendChild(o),computedStyleToInlineStyle(o,{recursive:!0,properties:["color","font-style","font-weight"]}),c=o.innerHTML.split(/\r\n|\n|\r|\u000B/g),n.clear(),l=0;l<c.length;l++)l!=c.length-1?n.insertHtml(c[l].replace(/  /g,"&nbsp;&nbsp;")+"<br/>","End"):0!=c[l].length&&n.insertHtml(c[l].replace(/  /g,"&nbsp;&nbsp;"),"End");case 25:return n.font.name="Consolas",e.next=28,t.sync();case 28:document.body.getElementsByClassName("ws365_canvas")[0].removeChild(o),o.innerHTML="";case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return y.apply(this,arguments)}function y(){return(y=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).load(["isEmpty"]),e.next=4,t.sync();case 4:return(n=r.isEmpty?t.document.body.contentControls:r.contentControls).load(["items","tag"]),e.next=8,t.sync();case 8:o=0;case 9:if(!(o<n.items.length)){e.next=18;break}if(!/ws365_code_.*/i.test(n.items[o].tag)){e.next=15;break}return a="output"==(a=n.items[o].tag.match(/ws365_code_(.*)/i)[1])?"text":a,e.next=15,g(t,n.items[o],a);case 15:o++,e.next=9;break;case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return v.apply(this,arguments)}function v(){return(v=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(n){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n.document.getSelection()).load(["isEmpty"]),e.next=4,n.sync();case 4:return(r=o.isEmpty?n.document.body.contentControls.getByTag(t):o.contentControls.getByTag(t)).load(["items","tag"]),e.next=8,n.sync();case 8:for(a=0;a<r.items.length;a++)r.items[a].clear(),"ws365_quiz"==t&&(r.items[a].color="yellow",r.items[a].font.highlightColor="yellow");return e.next=11,n.sync();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return E.apply(this,arguments)}function E(){return(E=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a,i,s,l,u,d,m,p,f,h,y,x,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).load(["isEmpty"]),e.next=4,t.sync();case 4:return(n=r.isEmpty?t.document.body.search("[<]ws365[>]*[<]/ws365[>]",{matchWildcards:!0,matchCase:!1}):r.search("[<]ws365[>]*[<]/ws365[>]",{matchWildcards:!0,matchCase:!1})).load(["text"]),e.next=8,t.sync();case 8:o=new DOMParser,a=0;case 10:if(!(a<n.items.length)){e.next=111;break}if(e.prev=11,i=void 0,s=void 0,l=void 0,u=void 0,d=void 0,m=void 0,p=void 0,f=void 0,h=void 0,y=new RegExp("^[^]*$","g"),i=o.parseFromString(n.items[a].text,"text/xml"),null==(s=i.evaluate("/ws365/content[child::title and child::tag][1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=29;break}return d=s.getElementsByTagName("title")[0].childNodes[0].nodeValue,(h=t.document.contentControls.getByTitle(d)).load("length"),e.next=25,t.sync();case 25:return 0==h.items.length&&((f=n.items[a].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,f.color="blue",f.tag=s.getElementsByTagName("tag")[0].childNodes[0].nodeValue,f.title=d),0!=s.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete()),e.next=29,t.sync();case 29:if(null==(s=i.evaluate("/ws365/quiz[child::id][1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=41;break}return u=0!=s.getElementsByTagName("weight").length?s.getElementsByTagName("weight")[0].childNodes[0].nodeValue.trim():"10",d=" "+s.getElementsByTagName("id")[0].childNodes[0].nodeValue.trim()+" ; "+u+" / quiz ",(h=t.document.contentControls.getByTitle(d)).load("length"),e.next=37,t.sync();case 37:return 0==h.items.length&&((f=n.items[a].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,f.color="yellow",f.font.highlightColor="yellow",f.tag="ws365_quiz",f.title=d),0!=s.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete()),e.next=41,t.sync();case 41:if(null==(s=i.evaluate("/ws365/solutions[1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=63;break}return(h=t.document.contentControls.getByTag("ws365_solutions")).load(["length","title"]),e.next=47,t.sync();case 47:if(0!=h.items.length){e.next=59;break}return(f=n.items[a].insertParagraph("ws365_solutions",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.hidden,f.color="cyan",f.font.highlightColor="cyan",f.tag="ws365_solutions",f.cannotEdit=!0,e.next=56,t.sync();case 56:f.title=c(s.parentNode.innerHTML,f.id.toString(),!1),e.next=60;break;case 59:h.items[0].title=c(s.parentNode.innerHTML,h.items[0].id.toString(),!1);case 60:return 0!=s.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete()),e.next=63,t.sync();case 63:if(null==(s=i.evaluate("/ws365/code[child::id and child::lang][1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=100;break}return l=s.getElementsByTagName("lang")[0].childNodes[0].nodeValue.trim(),d=" "+s.getElementsByTagName("id")[0].childNodes[0].nodeValue.trim()+" / "+l+" ",(h=t.document.contentControls.getByTitle(d)).load("length"),e.next=71,t.sync();case 71:if(0!=h.items.length){e.next=91;break}if((f=n.items[a].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,f.color="purple",f.tag="ws365_code_"+l,f.title=d,0==s.getElementsByTagName("url").length){e.next=88;break}return 0!=s.getElementsByTagName("regex").length&&(y=new RegExp(s.getElementsByTagName("regex")[0].childNodes[0].nodeValue,"g")),e.next=81,fetch(s.getElementsByTagName("url")[0].childNodes[0].nodeValue.trim());case 81:return m=e.sent,e.next=84,m.text();case 84:for(p=e.sent,x=0,v=void 0;null!==(v=y.exec(p));)0!=x&&f.insertParagraph("",Word.InsertLocation.end),null==v[1]?f.insertText(v[0],"End"):f.insertText(v[1],"End"),x++;case 88:0!=s.getElementsByTagName("content").length&&s.getElementsByTagName("content")[0].hasChildNodes()&&f.insertText(s.getElementsByTagName("content")[0].childNodes[0].nodeValue,Word.InsertLocation.end),e.next=92;break;case 91:f=h.items[0];case 92:return e.next=94,t.sync();case 94:if(0==s.getElementsByTagName("format").length){e.next=97;break}return e.next=97,g(t,f,l);case 97:return 0!=s.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete()),e.next=100,t.sync();case 100:e.next=106;break;case 102:e.prev=102,e.t0=e.catch(11),console.error(e.t0),console.error("ERROR TO PROCESS: ",n.items[a].text);case 106:return e.next=108,t.sync();case 108:a++,e.next=10;break;case 111:return e.abrupt("return",t.sync());case 112:case"end":return e.stop()}}),e,null,[[11,102]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}document.getElementById("process-tags").onclick=function(){return a(w)},document.getElementById("reformat-code").onclick=function(){return a(h)},document.getElementById("clear-output").onclick=function(){return a((function(){return x("ws365_code_output")}))},document.getElementById("clear-quiz").onclick=function(){return a((function(){return x("ws365_quiz")}))},document.getElementById("coq-taskpane").onclick=function(){self.location="./taskpane.html?et="},document.getElementById("anon-user").onclick=function(){return a(m)},document.getElementById("signed-in-user").onclick=function(){return a(l)},document.querySelectorAll(".doc-tags").forEach((function(e){e.addEventListener("click",(function(){return a((function(){return function(e){return s.apply(this,arguments)}(e)}))}))}))}});
//# sourceMappingURL=workschool365.js.map