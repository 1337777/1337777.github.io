<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>laoziSolution.v</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Ubuntu" />
<link rel="stylesheet" type="text/css" href="./code/style.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<p><a href="index.html">top</a> | <a href="theindex.html">index</a> | <a href="sitemap.html">sitemap</a> | <a href="https://github.com/1337777/OOO1337777">edit</a></p>
</div>
<div id="content">
<h1 class="title">laoziSolution.v</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgbc37ed8">1. Grammatical description of polymorph grammatical-coparametrism functor</a>
<ul>
<li><a href="#org0016568">1.1. Importing the functional-monoidal logic</a></li>
<li><a href="#orgcbb684d">1.2. Base generating graph</a></li>
<li><a href="#org6559f38">1.3. Grammatical generation of the morhisms</a></li>
<li><a href="#org525b7f9">1.4. Decoding into the common sense : grammatical is indeed free</a></li>
<li><a href="#orgb266784">1.5. Some notations</a></li>
<li><a href="#org967844b">1.6. More functional-monoidal logic</a></li>
<li><a href="#org6cd96c2">1.7. The generated conversion relations over the morhisms</a></li>
</ul>
</li>
<li><a href="#orgef5e84f">2. Iterated constructors</a>
<ul>
<li><a href="#orgb3fff68">2.1. Indexed list, lemmas</a></li>
<li><a href="#org8177098">2.2. Chained lists, lemmas</a></li>
<li><a href="#org9a5722b">2.3. Iterated constructors</a></li>
</ul>
</li>
<li><a href="#org8391fb0">3. Grade</a></li>
<li><a href="#orgdd57311">4. Reduction</a>
<ul>
<li><a href="#org72c51cd">4.1. Grammatical generation of the reduction relation</a></li>
<li><a href="#orgd6b578b">4.2. Degradation lemmas</a></li>
</ul>
</li>
<li><a href="#orgd94353e">5. Solution</a>
<ul>
<li><a href="#org8317458">5.1. Grammatical generation of the solution morphisms</a></li>
<li><a href="#org49c7fff">5.2. Containment of the solution morphisms into all the morphisms</a></li>
<li><a href="#org0232603">5.3. Destruction of morphisms with inner-instantiation of object-indices</a></li>
<li><a href="#orgf36d000">5.4. Iterated <code>DeClassifying</code> prefix</a></li>
</ul>
</li>
<li><a href="#org197d6a2">6. Resolution</a></li>
</ul>
</div>
</div>
<p>
Proph
</p>

<p>
<a href="https://github.com/1337777/laozi/blob/master/laoziSolution2.v">https://github.com/1337777/laozi/blob/master/laoziSolution2.v</a>
</p>

<p>
solves some question of 老子 <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> which is how to program polymorph coparametrism
functors ( "comonad" ) &#x2026; Whatever is discovered, its format, its communication is
simultaneously some predictable logical discovery and some random dia-para-logical
discovery.
</p>

<p>
In particular this text programs the grammatical / inductive (therefore free)
description of polymorph coparametrism functor and the conversion relations over the
generated morphisms. This text is based on earlier texts which describe
functional-monoidal logic and the decidable coherence of this logic.
</p>

<p>
Next this text programs the iterated comultiplication (DeClassifying) and the
corresponding deduced conversion relations over the morphisms. Then the reduction
relation and degradation lemmas are programmed and deduced.
</p>

<p>
Finally the solution morphisms are programmed with their (dependent-)destruction
lemmas such to inner-instantiate the object-indices. And the (non-congruent)
resolution by cut elimination / desintegration technique is programmed and deduced :
this deduction is mostly-automated.
</p>

<p>
For instant first impression, the common saying that the counit inner-cancels the
comultiplication is written as :
</p>

<pre class="example">
| IterCancelInner :
  forall {trf : obV log -&gt; obV log}
    (Vb Vb' : obV log) (vb : V(0 Vb' |- Vb )0)
    (W W_dft : obV log) (V0Vb' : obV log) (Vs : list (obV log))
    (vs : (hlist (toArrowV (trf:=trf)) (chain Vs)))
    (va : V(0 trf(last W_dft Vs) |- W )0)
    (v0b : V(0 V0Vb' |- (0 trf(head W_dft Vs) &amp; Vb' )0 )0)
    (B : obMod) (A : obMod) (b : 'D(0 Vb |- [0 B ~&gt; A ]0 )0)
    (A' : obMod)(a : 'D(0 W |- [0 A ~&gt; A' ]0 )0),
    ( v0b o&gt;| ( vb o&gt;' b)  o&gt;D (iterDeClassifying (V_dft := W_dft) vs ( va o&gt;' a)) )
      &lt;~~ ( v0b o&gt;| (vb o&gt;| b o&gt;Mod 'declfy )
	      o&gt;D (iterDeClassifying (V_dft := W_dft) vs (va o&gt;| 'clfy o&gt;Mod a) )
	  : 'D(0 V0Vb' |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A') ]0)0 )
</pre>

<div id="outline-container-orgbc37ed8" class="outline-2">
<h2 id="orgbc37ed8"><span class="section-number-2">1</span> Grammatical description of polymorph grammatical-coparametrism functor</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-org0016568" class="outline-3">
<h3 id="org0016568"><span class="section-number-3">1.1</span> Importing the functional-monoidal logic</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Importing the functional-monoidal logic, the ssreflect grammar and deduction tactics
and math definitions, the congruent rewriting tactics, and the linear arithmetic
decidability-solver. (Memo that <code>COQ</code> &#x2013;version &gt; 8.5)
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Require Import</span> borceuxSolution_half_old.
<span style="font-weight: bold;">Require Import</span> mathcomp.ssreflect.ssreflect.
From mathcomp <span style="font-weight: bold;">Require Import</span> ssrbool ssrfun eqtype ssrnat seq.
<span style="font-weight: bold;">Require Import</span> Setoid.
<span style="font-weight: bold;">Require</span> Omega.

<span style="font-weight: bold;">Set Implicit Arguments</span>.
Unset Strict Implicits.
<span style="font-weight: bold;">Unset Printing Implicit</span> Defensive.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcbb684d" class="outline-3">
<h3 id="orgcbb684d"><span class="section-number-3">1.2</span> Base generating graph</h3>
<div class="outline-text-3" id="text-1-2">
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">COPARAM</span>.

<span style="font-weight: bold;">Import</span> LOGIC.
<span style="font-weight: bold;">Import</span> LOGIC.Ex_Notations3.

<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">obMod_gen</span> : <span style="font-weight: bold; text-decoration: underline;">Set</span>.
<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">Mod_gen</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, obV log -&gt; obMod_gen -&gt; obMod_gen -&gt; <span style="font-weight: bold; text-decoration: underline;">Set</span>.

<span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">obMod</span> : <span style="font-weight: bold; text-decoration: underline;">Set</span> :=
| GenObMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A</span> : obMod_gen, obMod
| DeClass0 : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A</span> : obMod, obMod.

<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"#0| A"</span> := (GenObMod A) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 4, <span style="text-decoration: underline;">right</span> associativity).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"'D0| A"</span> := (DeClass0 A) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 4, <span style="text-decoration: underline;">right</span> associativity).
</pre>
</div>
</div>
</div>

<div id="outline-container-org6559f38" class="outline-3">
<h3 id="org6559f38"><span class="section-number-3">1.3</span> Grammatical generation of the morhisms</h3>
<div class="outline-text-3" id="text-1-3">
<p>
The grammatical description of polymorph coparametrism functor, primo the morphisms :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Reserved Notation</span> <span style="font-style: italic;">"''Mod' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
         (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"''Mod' (0  V  |-  [0  A1  ~&gt;  A2  ]0 )0"</span>).
<span style="font-weight: bold;">Reserved Notation</span> <span style="font-style: italic;">"''D' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
         (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"''D' (0  V  |-  [0  A1  ~&gt;  A2  ]0 )0"</span>).

<span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : obV log -&gt; obMod -&gt; obMod -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

| PolyV_Mod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log),
    V(0 V' |- V )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod), 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt;
                                       'Mod(0 V' |- [0 A1 ~&gt; A2 ]0 )0

| GenArrowsMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen
    , Mod_gen V A1 A2 -&gt; V(0 V' |- V )0 -&gt; 
      'Mod(0 V' |- [0 (#0| A1) ~&gt; (#0| A2) ]0 )0

| UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obMod}
    ,  V(0 V |- log.-I )0 -&gt; 'Mod(0 V |- [0 A ~&gt; A ]0 )0

| PolyMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod)
  , 'Mod(0 V |- [0 A2 ~&gt; A1 ]0 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1'</span> : obMod, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W WV</span> : obV log),
        V(0 WV |- (0 W &amp; V )0 )0 -&gt;
        'Mod(0 W |- [0 A1 ~&gt; A1' ]0 )0 -&gt; 'Mod(0 WV |- [0 A2 ~&gt; A1' ]0 )0

| UnitDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
  , V(0 W' |- (0 W &amp; log.-I)0 )0 -&gt;
    'Mod(0 W |- [0 A ~&gt; A' ]0 )0 -&gt; 'D(0 W' |- [0 'D0| A ~&gt; A' ]0 )0

| PolyDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod),
    'D(0 V |- [0 B ~&gt; A ]0 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A'</span> : obMod, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W WV</span> : obV log),
        V(0 WV |- (0 W &amp; V )0 )0 -&gt;
        'Mod(0 W |- [0 A ~&gt; A' ]0 )0 -&gt; 'D(0 WV |- [0 B ~&gt; A' ]0 )0

<span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">common CoUnit, errata: Unit </span><span style="font-weight: bold; font-style: italic;">*)</span>
| Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
      V(0 V' |- V )0 -&gt;
      'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; 'Mod(0 V' |- [0 ('D0| A1) ~&gt; A2 ]0 )0

| DeClassifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
      V(0 V' |- V )0 -&gt; 
      'D(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; 'D(0 V' |- [0 A1 ~&gt; ('D0| A2) ]0 )0

<span style="font-weight: bold; text-decoration: underline;">where</span>
<span style="font-style: italic;">"''Mod' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
  := (@Mod00 _ V A1 A2) and <span style="font-style: italic;">"''D' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
       := (@Mod00 _ V A1 ('D0| A2)).
</pre>
</div>
</div>
</div>

<div id="outline-container-org525b7f9" class="outline-3">
<h3 id="org525b7f9"><span class="section-number-3">1.4</span> Decoding into the common sense : grammatical is indeed free</h3>
<div class="outline-text-3" id="text-1-4">
<p>
How to decode from the grammatical description to the non-grammatical description such
to deduce that it is indeed some instance of polymorph coparametrism functor, in the
common sense :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">Mod'00</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, obMod -&gt; obMod -&gt; obV log.
<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">decode</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod},
    <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; V(0 V |- Mod'00 A1 A2 )0.
<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">encode</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod},
    <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, V(0 V |- Mod'00 A1 A2 )0 -&gt; 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0.
<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">decodeK</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
      cancel (@decode _ A1 A2 V) (@encode _ A1 A2 V).
<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">encodeK</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
      cancel (@encode _ A1 A2 V) (@decode _ A1 A2 V).

<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">decode_metaPoly</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">f</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
          ( v o&gt; (decode f) )
            ~~ ( decode (PolyV_Mod v f)
                 : log.-V(0 V' |- Mod'00 A1 A2 )0 ) .
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb266784" class="outline-3">
<h3 id="orgb266784"><span class="section-number-3">1.5</span> Some notations</h3>
<div class="outline-text-3" id="text-1-5">
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">PolyV_Mod_rewrite</span> log V V' A1 A2 v a :=
  (@PolyV_Mod log V V' v A1 A2 a).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;' a"</span> := (@PolyV_Mod_rewrite _ _ _ _ _ v a)
                        (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity, format <span style="font-style: italic;">"v  o&gt;'  a"</span>).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| #1| a"</span> :=
  (@GenArrowsMod _ _ _ _ _ a v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| 'uMod'"</span> := (@UnitMod _ _ _ v)(<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| @ 'uMod' A"</span> :=
  (@UnitMod _ _ A v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, only parsing).
<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">PolyMod_rewrite</span> log V A2 A1 A1' W WV wv a_ a' :=
  (@PolyMod log V A2 A1 a_ A1' W WV wv a').
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| a_ o&gt;Mod a'"</span> :=
  (@PolyMod_rewrite _ _ _ _ _ _ _ v a_ a')
    (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity, a_ <span style="font-weight: bold; text-decoration: underline;">at</span> next level, 
    format <span style="font-style: italic;">"v  o&gt;|  a_  o&gt;Mod  a'"</span>).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| ''D1|' a"</span> := (@UnitDeClass _ _ _ _ _ v a)
                               (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity).
<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">PolyDeClass_rewrite</span> log V B A A' W WV wv b a :=
  (@PolyDeClass log V B A b A' W WV wv a).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| b o&gt;D a"</span> :=
  (@PolyDeClass_rewrite _ _ _ _ _ _ _ v b a)
    (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity, b <span style="font-weight: bold; text-decoration: underline;">at</span> next level, format <span style="font-style: italic;">"v  o&gt;|  b  o&gt;D  a"</span>).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| 'clfy o&gt;Mod a'"</span> :=
  (@Classifying _ _ _ _ _ v a') (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity).
<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| a_ o&gt;Mod 'declfy"</span> :=
  (@DeClassifying _ _ _ _ _ v a_) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, a_ <span style="font-weight: bold; text-decoration: underline;">at</span> next level,
  <span style="text-decoration: underline;">right</span> associativity).
</pre>
</div>
</div>
</div>

<div id="outline-container-org967844b" class="outline-3">
<h3 id="org967844b"><span class="section-number-3">1.6</span> More functional-monoidal logic</h3>
<div class="outline-text-3" id="text-1-6">
<p>
More description of the functional-monoidal logic which is assumed. These equations
are decidable by coherence lemmas &#x2026;
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">PolyV_unitPre</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log} (<span style="font-weight: bold; font-style: italic;">v</span> : log.-V(0 V |- V')0), log.-1 o&gt; v ~~ v.
<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">PolyV_unitPost</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log} (<span style="font-weight: bold; font-style: italic;">v</span> : log.-V(0 V |- V')0), v o&gt; log.-1 ~~ v.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">desIdenObLK</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, log.-V(0 log.-(0 log.-I &amp; V )0 |- V )0
  := <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">log V</span> =&gt; Des (log.-uV) .
<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">desIdenObLKV</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, log.-V(0 V |- log.-(0 log.-I &amp; V )0 )0 .

<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">desIdenObLK_K</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V</span> : obV log},
    log.-1 ~~ (@desIdenObLK log V) o&gt; (@desIdenObLKV log V).

<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">desIdenObLKV_K</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V</span> : obV log},
    log.-1 ~~ (@desIdenObLKV log V) o&gt; (@desIdenObLK log V).

<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">desIdenObLKV_Assoc_Rev_desIdenObLK</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V W</span> : obV log),
    log.-1 ~~ ( ( log.-(1 desIdenObLKV &amp; V )0 o&gt; Assoc_Rev ) o&gt; desIdenObLK
                : log.-V(0 log.-(0 W &amp; V )0 |- log.-(0 W &amp; V )0 )0 ).

<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">desIdenObRK</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, log.-V(0 log.-(0 V &amp; log.-I )0 |- V )0.

<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">desIdenObRKV</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, log.-V(0 V |- log.-(0 V &amp; log.-I )0 )0. 

<span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">desV01</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">V2 V2' V1</span> : obV log},
    log.-V(0 V2 |- V2' )0 -&gt; log.-V(0 log.-(0 V1 &amp; V2 )0 |- log.-(0 V1 &amp; V2' )0 )0.
<span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"dat .-(0 V1 &amp; v )1"</span> := (@desV01 dat _ _ V1 v)
                                    (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"dat .-(0  V1  &amp;  v  )1"</span>).
<span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"(0 V1 &amp; v )1"</span> := (_ .-(0 V1 &amp; v )1)
                              (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"(0  V1  &amp;  v  )1"</span>).
<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">desV01_consV10</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V2 V2' V1</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : log.-V(0 V2' |- V2 )0) (<span style="font-weight: bold; font-style: italic;">W</span> : obV log)
    (<span style="font-weight: bold; font-style: italic;">w</span> : log.-V(0 log.-(0 V1 &amp; V2 )0 |- W )0),
    Des( [1 v ~&gt; W ]0 &lt;o (Cons w) ) ~~ w &lt;o log.-(0 V1 &amp; v )1 .

<span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">desIdenObLKV_IdenOb_Assoc_Rev_desIdenObLK</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
    log.-1 ~~ ( ( (log.-(1 desIdenObLKV &amp; V )0)
                    o&gt; Assoc_Rev ) o&gt; (log.-(0 log.-I &amp; desIdenObLK )1)
                : log.-V(0 log.-(0 log.-I &amp; V )0 |- log.-(0 log.-I &amp; V )0 )0 ).
</pre>
</div>
</div>
</div>

<div id="outline-container-org6cd96c2" class="outline-3">
<h3 id="org6cd96c2"><span class="section-number-3">1.7</span> The generated conversion relations over the morhisms</h3>
<div class="outline-text-3" id="text-1-7">
<p>
The grammatical description of polymorph coparametrism functor, secondo the conversion
relations over the morphisms :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Reserved Notation</span> <span style="font-style: italic;">"f2 ~~~ f1"</span> (<span style="font-weight: bold; text-decoration: underline;">at</span> level 70).

<span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">convMod</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
    'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">Prop</span> :=

| Mod_ReflV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
    a ~~~ a

| Mod_TransV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
             (<span style="font-weight: bold; font-style: italic;">uTrans a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
    uTrans ~~~ a -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      a0 ~~~ uTrans -&gt; a0 ~~~ a

| Mod_SymV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
                    (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2]0 )0),
    a ~~~ a0 -&gt; a0 ~~~ a

| PolyV_Mod_cong : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0)
                     (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
    v0 ~~ v -&gt; a0 ~~~ a -&gt; ( v0 o&gt;' a0 ) ~~~ ( v o&gt;' a )

| GenArrowsMod_cong : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen) 
                             (<span style="font-weight: bold; font-style: italic;">aGen</span> : Mod_gen V A1 A2)
    , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0), v0 ~~ v -&gt; v0 o&gt;| #1| aGen ~~~ v o&gt;| #1| aGen

| UnitMod_cong : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obMod} (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V |- log.-I )0),
      v0 ~~ v -&gt; v0 o&gt;| @uMod A ~~~ v o&gt;| @uMod A

| Mod_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a_ a_0</span> : 'Mod(0 V |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a' a'0</span> : 'Mod(0 W |- [0 A' ~&gt; A'' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
      v0 ~~ v -&gt; a_0 ~~~ a_ -&gt; a'0 ~~~ a' -&gt; 
                                ( v0 o&gt;| a_0 o&gt;Mod a'0 ) ~~~ ( v o&gt;| a_ o&gt;Mod a' )

| UnitDeClass_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
       (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 W' |- (0 W &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      v0 ~~ v -&gt; a0 ~~~ a -&gt; ( v0 o&gt;| 'D1| a0 ) ~~~ ( v o&gt;| 'D1| a )

| PolyDeClass_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b b0</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
      v0 ~~ v -&gt; b0 ~~~ b -&gt; a0 ~~~ a -&gt; ( v0 o&gt;| b0 o&gt;D a0 ) ~~~ ( v o&gt;| b o&gt;D a )

| Classifying_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
           (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      v0 ~~ v -&gt; a0 ~~~ a -&gt; (v0 o&gt;| 'clfy o&gt;Mod a0 ) ~~~ (v o&gt;| 'clfy o&gt;Mod a )

| DeClassifying_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
           (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      v0 ~~ v -&gt; a0 ~~~ a -&gt; (v0 o&gt;| a0 o&gt;Mod 'declfy ) ~~~ (v o&gt;| a o&gt;Mod 'declfy )

| GenArrowsMod_arrowLog : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen) 
                                 (<span style="font-weight: bold; font-style: italic;">aGen</span> : Mod_gen V A1 A2)
                            (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V'' |- V' )0),
    ( ( v' o&gt; v) o&gt;| #1| aGen )
      ~~~ (v' o&gt;' (v o&gt;| #1| aGen)
          : 'Mod(0 V'' |- [0 #0| A1 ~&gt; #0| A2 ]0)0 )

| UnitMod_arrowLog : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0)
                       (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V' |- V )0),
    ( ( v' o&gt; v ) o&gt;| @uMod A )
      ~~~ (v' o&gt;' (v o&gt;| @uMod A)
          : 'Mod(0 V' |- [0 A ~&gt; A ]0)0 )

| Mod_arrowLog :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 WV |- (0 W &amp; V )0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV0</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV0 |- WV )0),
      ( ( v0 o&gt; v ) o&gt;| a_ o&gt;Mod a' )
        ~~~ ( v0 o&gt;' ( v o&gt;| a_ o&gt;Mod a' )
              : 'Mod(0 WV0 |- [0 A0 ~&gt; A' ]0)0 )

| Mod_arrowPre :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
      ( ( v0 o&gt; log.-(0 _ &amp; v )1 ) o&gt;| a_ o&gt;Mod a' )
        ~~~ ( v0 o&gt;| ( v o&gt;' a_ ) o&gt;Mod a'
              : 'Mod(0 WV' |- [0 A0 ~&gt; A' ]0)0 )

| Mod_arrowPost :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 W'V |- (0 W' &amp; V )0 )0),
      ( ( w0 o&gt; log.-(1 w &amp; _ )0 ) o&gt;| a_ o&gt;Mod a' )
        ~~~ ( w0 o&gt;| a_ o&gt;Mod ( w o&gt;' a' )
              : 'Mod(0 W'V |- [0 A0 ~&gt; A' ]0)0 )

| UnitDeClass_arrowLog :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W' W''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- (0 W &amp; log.-I )0 )0)
      (<span style="font-weight: bold; font-style: italic;">w'</span> : V(0 W'' |- W' )0)
        (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      ( ( w' o&gt; w ) o&gt;| 'D1| a )
        ~~~ (  w' o&gt;' ( w o&gt;| 'D1| a )
              : 'D(0 W'' |- [0 'D0| A ~&gt; A' ]0)0 )

| UnitDeClass_arrow :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W' W''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0)
      (<span style="font-weight: bold; font-style: italic;">w'</span> : V(0 W'' |- (0 W' &amp; log.-I )0 )0)
        (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      ( ( w' o&gt; log.-(1 w &amp; log.-I )0 ) o&gt;| 'D1| a )
        ~~~ (  w' o&gt;| 'D1| ( w o&gt;' a)
              : 'D(0 W'' |- [0 'D0| A ~&gt; A' ]0)0 )

| DeClass_arrowLog :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 WV |- (0 W &amp; V )0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV0</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV0 |- WV )0),
      ( ( v0 o&gt; v ) o&gt;| b o&gt;D a )
        ~~~ ( v0 o&gt;' ( v o&gt;| b o&gt;D a )
              : 'D(0 WV0 |- [0 B ~&gt; A' ]0)0 )

| DeClass_arrowPre :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
      ( ( v0 o&gt; log.-(0 _ &amp; v )1 ) o&gt;| b o&gt;D a )
        ~~~ ( v0 o&gt;| ( v o&gt;' b ) o&gt;D a
              : 'D(0 WV' |- [0 B ~&gt; A' ]0)0 )

| DeClass_arrowPost :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 W'V |- (0 W' &amp; V )0 )0),
      ( ( w0 o&gt; log.-(1 w &amp; _ )0 ) o&gt;| b o&gt;D a )
        ~~~ ( w0 o&gt;| b o&gt;D ( w o&gt;' a )
              : 'D(0 W'V |- [0 B ~&gt; A' ]0)0 )

| Classifying_arrowLog : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) 
                                (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                        (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
    ( ( v0 o&gt; v ) o&gt;| 'clfy o&gt;Mod a )
      ~~~ ( v0 o&gt;' ( v o&gt;| 'clfy o&gt;Mod a ) 
            : 'Mod(0 V'' |- [0 'D0| A1 ~&gt; A2 ]0)0 )

| Classifying_arrow : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
                        (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                        (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ( ( v0 o&gt; v ) o&gt;| 'clfy o&gt;Mod a )
        ~~~ ( v0 o&gt;| 'clfy o&gt;Mod ( v o&gt;' a )
              : 'Mod(0 V'' |- [0 'D0| A1 ~&gt; A2 ]0)0 )

| DeClassifying_arrowLog :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) 
           (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ( ( v0 o&gt; v ) o&gt;| a o&gt;Mod 'declfy )
      ~~~ ( v0 o&gt;' ( v o&gt;| a o&gt;Mod 'declfy )
              : 'D(0 V'' |- [0 A1 ~&gt; 'D0| A2 ]0)0 )

| DeClassifying_arrow :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) 
           (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0),
    ( ( v0 o&gt; v ) o&gt;| a o&gt;Mod 'declfy )
      ~~~ ( v0 o&gt;| ( v o&gt;' a ) o&gt;Mod 'declfy
            : 'D(0 V'' |- [0 A1 ~&gt; 'D0| A2 ]0)0 )

| PolyV_Mod_arrowLog :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V'' V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log)
      (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ( ( v' o&gt; v ) o&gt;' a )
        ~~~ ( v' o&gt;' ( v o&gt;' a )
              : 'Mod(0 V'' |- [0 A1 ~&gt; A2 ]0)0 )

<span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">non for reduction </span><span style="font-weight: bold; font-style: italic;">*)</span>
| Mod_morphism :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'Mod(0 V |- [0 B ~&gt; A ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">W_</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 W_ |- [0 A ~&gt; A' ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W' |- [0 A' ~&gt; A'' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W_V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W_V |- (0 W_ &amp; V )0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'W_V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'W_V |- (0 W' &amp; W_V )0 )0),
      ( ( v0 o&gt; (0 W' &amp; v )1 o&gt; Assoc ) o&gt;| b o&gt;Mod ( log.-1 o&gt;| a_ o&gt;Mod a' ) )
        ~~~ ( v0 o&gt;| ( v o&gt;| b o&gt;Mod a_ ) o&gt;Mod a'
              : 'Mod(0 W'W_V |- [0 B ~&gt; A'' ]0)0 )

| DeClass_morphismPost :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
      (<span style="font-weight: bold; font-style: italic;">W_ W_'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W_' |- (0 W_ &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 W_ |- [0 A ~&gt; A' ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W' |- [0 A' ~&gt; A'' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'W_'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'W_' |- (0 W' &amp; W_' )0 )0),
      ( ( v0 o&gt; desIdenObRKV ) o&gt;| 
                    'D1| ( (log.-1) o&gt;| ( ( v o&gt; desIdenObRK ) o&gt;' a_ ) o&gt;Mod a' )  )
        ~~~ ( v0 o&gt;| ( v o&gt;| 'D1| a_ ) o&gt;D a'
              : 'D(0 W'W_' |- [0 'D0| A ~&gt; A'' ]0)0 )

| DeClass_morphismPre :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b'</span> : 'D(0 V' |- [0 B' ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I )0 )0) 
           (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
      ( v0  o&gt;| b' o&gt;D ( ( v o&gt; desIdenObRK )  o&gt;' a ) )
        ~~~ ( v0 o&gt;| b' o&gt;Mod ( v o&gt;| 'D1| a )
              : 'D(0 W'V' |- [0 B' ~&gt; A' ]0)0 )

| PolyV_Mod_unit :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ( a ) ~~~ ( log.-1 o&gt;' a
                  : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0)0 )

| Mod_unit :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0)
      (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
      ( ( v0 o&gt; log.-(0 W &amp; v )1 o&gt; desIdenObRK ) o&gt;' a )
        ~~~ ( v0 o&gt;| ( v o&gt;| uMod ) o&gt;Mod a
              : 'Mod(0 WV |- [0 A ~&gt; A' ]0)0 )

| Mod_inputUnitMod :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'Mod(0 V |- [0 B ~&gt; A ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- log.-I )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 WV |- (0 W &amp; V )0 )0),
      ( ( w0 o&gt; log.-(1 w &amp; V )0 o&gt; desIdenObLK ) o&gt;' b )
        ~~~  ( w0 o&gt;| b o&gt;Mod ( w o&gt;| uMod )
               : 'Mod(0 WV |- [0 B ~&gt; A ]0)0 )

| DeClass_unit :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
           (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
      ( ( v0 o&gt; log.-(0 W &amp; v )1 ) o&gt;| 'D1| a )
        ~~~ ( v0 o&gt;| ( v o&gt;| uMod ) o&gt;D a
              : 'D(0 WV |- [0 'D0| A ~&gt; A' ]0 )0 )

| DeClass_inputUnitMod :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- log.-I )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 WV |- (0 W &amp; V )0 )0),
      ( ( w0 o&gt; ( log.-(1 w &amp; _ )0 ) o&gt; desIdenObLK ) o&gt;' b )
        ~~~ ( w0 o&gt;| b o&gt;D ( w o&gt;| uMod )
              : 'D(0 WV |- [0 B ~&gt; A ]0)0 )

| Classifying_morphismPre :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0 ) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
           (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A2 ~&gt; A3 ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
      ( ( log.-1 ) o&gt;| 'clfy o&gt;Mod ( ( v0 o&gt; (0 _ &amp; v )1 ) o&gt;| a_ o&gt;Mod a' ) )
        ~~~ ( v0 o&gt;| (v o&gt;| 'clfy o&gt;Mod a_ ) o&gt;Mod a'
              : 'Mod(0 WV' |- [0 'D0| A1 ~&gt; A3 ]0)0 )

<span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">non-necessary, deductible </span><span style="font-weight: bold; font-style: italic;">*)</span>
| Classifying_morphismPre_DeClass :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0 ) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
           (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A2 ~&gt; A3 ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
      ( ( log.-1 ) o&gt;| 'clfy o&gt;Mod ( ( v0 o&gt; (0 _ &amp; v )1 ) o&gt;| b o&gt;D a' ) )
        ~~~ ( v0 o&gt;| (v o&gt;| 'clfy o&gt;Mod b ) o&gt;D a'
            : 'D(0 WV' |- [0 'D0| A1 ~&gt; A3 ]0)0 )

| Classifying_morphismPost :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- (0 V &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
           (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
           (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A2 ~&gt; A3 ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
      ( ( log.-1 )
         o&gt;| 'clfy o&gt;Mod ( v0 o&gt;| ( ( v o&gt; desIdenObRK ) o&gt;' a_ ) o&gt;Mod (w o&gt;' a') ) )
        ~~~ ( v0 o&gt;| ( v o&gt;| 'D1| a_ ) o&gt;Mod ( w o&gt;| 'clfy o&gt;Mod a' )
              : 'Mod(0 W'V' |- [0 'D0| A1 ~&gt; A3 ]0)0 ) 

| DeClassifying_morphismPost :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">b'</span> : 'D(0 W |- [0 A2 ~&gt; A3 ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 W'V |- (0 W' &amp; V )0 )0),
      ( log.-1 o&gt;| ( ( w0 o&gt; (1 w &amp; _ )0 ) o&gt;| b_ o&gt;Mod b' ) o&gt;Mod 'declfy )
        ~~~ ( w0 o&gt;| b_ o&gt;Mod ( w o&gt;| b' o&gt;Mod 'declfy )
              : 'D(0 W'V |- [0 A1 ~&gt; 'D0| A3 ]0)0 )

| DeClassifying_morphismPre :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
           (<span style="font-weight: bold; font-style: italic;">b_</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
           (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- (0 W &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">A4</span> : obMod)
           (<span style="font-weight: bold; font-style: italic;">b'</span> : 'Mod(0 W |- [0 A2 ~&gt; A4 ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
      ( log.-1 o&gt;| 
           ( wv o&gt;| ( v o&gt;' b_ ) o&gt;D ( ( w o&gt; desIdenObRK ) o&gt;' b') ) o&gt;Mod 'declfy )
        ~~~ ( wv o&gt;| ( v o&gt;| b_ o&gt;Mod 'declfy ) o&gt;D ( w o&gt;| 'D1| b' )
            : 'D(0 W'V' |- [0 A1 ~&gt; 'D0| A4 ]0)0 )

| CancelOuter : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
                  (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 'D0| A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
   ( wv o&gt;| ( v o&gt;' b ) o&gt;Mod ( w o&gt;' a ) )
     ~~~ ( wv o&gt;| ( v o&gt;| b o&gt;Mod 'declfy ) o&gt;Mod ( w o&gt;| 'clfy o&gt;Mod a )
                        : 'Mod(0 W'V' |- [0 B ~&gt; A' ]0)0 )

| CancelInner : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
                  (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
         (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
    ( wv o&gt;| (v o&gt;' b) o&gt;D (w o&gt;' a) )
      ~~~ ( wv o&gt;| (v o&gt;| b o&gt;Mod 'declfy ) o&gt;D (w o&gt;| 'clfy o&gt;Mod a )
                      : 'D(0 W'V' |- [0 B ~&gt; A' ]0)0 )

| PermOuterInner : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) 
                          (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
                          (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">u</span> : V(0 W |- log.-I )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
    ( wv o&gt;| ( ( log.-(1 w &amp; _ )0 o&gt; log.-(1 u &amp; _ )0 o&gt; desIdenObLK ) o&gt;| 
                                          ( v o&gt;' b ) o&gt;Mod 'declfy ) o&gt;Mod 'declfy )
      ~~~ ( wv o&gt;| ( v o&gt;| b o&gt;Mod 'declfy ) o&gt;D ( w o&gt;| (u o&gt;| uMod) o&gt;Mod 'declfy )
            : 'D(0 W'V' |- [0 B ~&gt; 'D0| 'D0| A ]0)0 )

<span style="font-weight: bold; text-decoration: underline;">where</span> <span style="font-style: italic;">"f2 ~~~ f1"</span> := (@convMod _ _ _ _ f2 f1).

<span style="font-weight: bold;">Hint Constructors</span> convMod.

<span style="font-weight: bold;">Hint Extern</span> 4 (_ ~~?lo` _) =&gt; <span style="text-decoration: underline;">eapply</span> (@ReflV lo _).
<span style="font-weight: bold;">Ltac</span> <span style="font-weight: bold;">rewriterMod</span> := repeat <span style="font-weight: bold; text-decoration: underline;">match</span> goal <span style="font-weight: bold; text-decoration: underline;">with</span> 
    | [ HH : @eq (Mod00 _ _ _) _ _  |- _ ] =&gt;  try <span style="text-decoration: underline;">rewrite</span> -&gt; HH <span style="font-weight: bold; text-decoration: underline;">in</span> *; <span style="text-decoration: underline;">clear</span> HH <span style="font-weight: bold; text-decoration: underline;">end</span>.
</pre>
</div>

<p>
Descriptions for the congruent rewriting tactics :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Add Parametric Relation</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) :
  ('Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0) (@convMod log V A1 A2)
      reflexivity proved by (@Mod_ReflV log V A1 A2)
      <span style="text-decoration: underline;">symmetry</span> proved by (@Mod_SymV log V A1 A2)
      <span style="text-decoration: underline;">transitivity</span> proved by
      (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">x y z r1 r2</span> =&gt;  ((@Mod_TransV log V A1 A2) y z r2 x r1))
        <span style="font-weight: bold; text-decoration: underline;">as</span> convMod_rewrite.

<span style="font-weight: bold;">Add Parametric Relation</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V1 V2</span> : obV log) :
  (log.-V(0 V1 |- V2 )0) (@convV log V1 V2)
    reflexivity proved by (@ReflV log log V1 V2)
    <span style="text-decoration: underline;">symmetry</span> proved by (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">x</span> =&gt; (@SymV log log V1 V2)^~ x)
    <span style="text-decoration: underline;">transitivity</span> proved by
    (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">x y z r1 r2</span> =&gt;  ((@TransV log log V1 V2) y z r2 x r1))
      <span style="font-weight: bold; text-decoration: underline;">as</span> convV_rewrite.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) :
  (@PolyV_Mod_rewrite log V V' A1 A2) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log V' V)
                 ==&gt; (@convMod log V A1 A2)
                 ==&gt; (@convMod log V' A1 A2))
      <span style="font-weight: bold; text-decoration: underline;">as</span> PolyV_Mod_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: PolyV_Mod_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen)
    (<span style="font-weight: bold; font-style: italic;">aGen</span> : Mod_gen V A1 A2) :
  (@GenArrowsMod log V V' A1 A2 aGen) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log V' V)
                 ==&gt; (@convMod log V' (#0| A1) (#0| A2)))
      <span style="font-weight: bold; text-decoration: underline;">as</span> GenArrowsMod_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: GenArrowsMod_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
  : (@UnitMod log V A) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log V log.-I)
                 ==&gt; (@convMod log V A A))
      <span style="font-weight: bold; text-decoration: underline;">as</span> UnitMod_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: UnitMod_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) :
  (@PolyMod_rewrite log V A A' A'' W WV ) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log WV ((0 W &amp; V)0) )
               ==&gt;(@convMod log V A A')
               ==&gt; (@convMod log W A' A'')
               ==&gt; (@convMod log WV A A''))
      <span style="font-weight: bold; text-decoration: underline;">as</span> Mod_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: Mod_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) :
  (@UnitDeClass log A A' W W') <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ( (@convV log W' ((0 W &amp; log.-I )0) )
                  ==&gt; (@convMod log W A A')
                  ==&gt; (@convMod log W' ('D0| A) ('D0| A')))
      <span style="font-weight: bold; text-decoration: underline;">as</span> UnitDeClass_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: UnitDeClass_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A A'</span> : obMod) 
                        (<span style="font-weight: bold; font-style: italic;">W WV</span> : obV log) :
  (@PolyDeClass_rewrite log V B A A' W WV) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log WV ((0 W &amp; V )0) )
                 ==&gt; (@convMod log V B ('D0| A))
                 ==&gt; (@convMod log W A A')
                 ==&gt; (@convMod log WV B ('D0| A')))
      <span style="font-weight: bold; text-decoration: underline;">as</span> PolyDeClass_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: PolyDeClass_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) :
  (@Classifying log V V' A1 A2) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log V' V)
                 ==&gt; (@convMod log V A1 A2)
                 ==&gt; (@convMod log V' ('D0| A1) A2))
      <span style="font-weight: bold; text-decoration: underline;">as</span> Classifying_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: Classifying_cong. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Add Parametric Morphism</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) :
  (@DeClassifying log V V' A1 A2) <span style="font-weight: bold; text-decoration: underline;">with</span>
<span style="font-weight: bold; text-decoration: underline;">    signature</span> ((@convV log V' V)
                 ==&gt; (@convMod log V A1 ('D0| A2))
                 ==&gt; (@convMod log V' A1 ('D0| ('D0| A2))))
      <span style="font-weight: bold; text-decoration: underline;">as</span> DeClassifying_cong_rewrite.
    by <span style="text-decoration: underline;">move</span> =&gt; *; <span style="text-decoration: underline;">apply</span>: DeClassifying_cong. <span style="font-weight: bold;">Qed</span>.
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgef5e84f" class="outline-2">
<h2 id="orgef5e84f"><span class="section-number-2">2</span> Iterated constructors</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-orgb3fff68" class="outline-3">
<h3 id="orgb3fff68"><span class="section-number-3">2.1</span> Indexed list, lemmas</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Some definitions :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Import</span> Destruct_hlist.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">hlist</span> (<span style="font-weight: bold; font-style: italic;">A</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>) (<span style="font-weight: bold; font-style: italic;">B</span>  : A -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span>)
  : list A -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
  | HNil : hlist B nil
  | HCons : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">x</span> : A) (<span style="font-weight: bold; font-style: italic;">ls</span> : list A), B x -&gt; hlist B ls -&gt; hlist B (x :: ls).

  <span style="font-weight: bold;">Implicit Arguments</span> HNil [A B].
  <span style="font-weight: bold;">Implicit Arguments</span> HCons [A B x ls].

  <span style="font-weight: bold;">Infix</span> <span style="font-style: italic;">":::"</span> := HCons (<span style="text-decoration: underline;">right</span> associativity, <span style="font-weight: bold; text-decoration: underline;">at</span> level 60).

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Section1</span>.
    <span style="font-weight: bold;">Variable</span> (<span style="font-weight: bold; font-style: italic;">A</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>) (<span style="font-weight: bold; font-style: italic;">B1 B2</span> : A -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span>).
    <span style="font-weight: bold;">Variable</span> <span style="font-weight: bold; font-style: italic;">f</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">x</span>, B1 x -&gt; B2 x.

    <span style="font-weight: bold;">Fixpoint</span> <span style="font-weight: bold;">hmap</span> (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hl</span> : hlist B1 ls) : hlist B2 ls :=
      <span style="font-weight: bold; text-decoration: underline;">match</span> hl <span style="font-weight: bold; text-decoration: underline;">with</span>
      | HNil =&gt; HNil
      | HCons _ _ x hl' =&gt; f x ::: hmap hl'
      <span style="font-weight: bold; text-decoration: underline;">end</span>.
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Section1</span>.

  <span style="font-weight: bold;">Implicit Arguments</span> hmap [A B1 B2 ls].
</pre>
</div>

<p>
Lemmas for (dependent-)destruction by inner instantiations of indices :
</p>

<div class="org-src-container">
<pre class="src src-coq">  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Section2</span>.

  <span style="font-weight: bold;">Variables</span> (<span style="font-weight: bold; font-style: italic;">A</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>) (<span style="font-weight: bold; font-style: italic;">B</span>  : A -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span>).

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">hlist_nil</span> : hlist B ( [::]) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
  | Hlist_nil : hlist_nil (<span style="font-weight: bold; font-style: italic;">HNil</span> : hlist B [::]).

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">hlist_cons</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a</span> : A) (<span style="font-weight: bold; font-style: italic;">ls'</span> : list A), hlist B (a :: ls') -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
  | Hlist_cons : <span style="font-weight: bold; text-decoration: underline;">forall</span> a ls' (<span style="font-weight: bold; font-style: italic;">ba</span> : B a) (<span style="font-weight: bold; font-style: italic;">hls'</span> : hlist B ls'),
        @hlist_cons a ls' (ba ::: hls' : hlist B ([:: a &amp; ls'])).

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">hlist_destructP_type</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hls</span> : hlist B ls), <span style="font-weight: bold; text-decoration: underline;">Type</span>.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; ls. <span style="text-decoration: underline;">case</span> : ls =&gt; [ | a ls'] hls.
    - <span style="text-decoration: underline;">refine</span> (@hlist_nil hls).
    - <span style="text-decoration: underline;">refine</span> (@hlist_cons a ls' hls).
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">hlist_destructP</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hls</span> : hlist B ls),
      @hlist_destructP_type ls hls.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; ls hls. <span style="text-decoration: underline;">case</span>: ls / hls.
    <span style="text-decoration: underline;">rewrite</span> /hlist_destructP_type /=.
    - <span style="text-decoration: underline;">constructor</span>.
    - <span style="text-decoration: underline;">constructor</span>.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">type indeed computes: ;;;</span>
<span style="font-weight: bold; font-style: italic;">  Definition hlist_cons_destructP (a : A) (ls' : list A)</span>
<span style="font-weight: bold; font-style: italic;">             (hls : hlist B (a :: ls')) :</span>
<span style="font-weight: bold; font-style: italic;">    (@hlist_cons a ls' hls).(**)</span>
<span style="font-weight: bold; font-style: italic;">  Proof.(**)</span>
<span style="font-weight: bold; font-style: italic;">    apply: (hlist_destructP hls ).(* *)</span>
<span style="font-weight: bold; font-style: italic;">  Defined.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">hlist_eta_type</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span>  (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hls</span> : hlist B ( ls)), <span style="font-weight: bold; text-decoration: underline;">Type</span>.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; ls hls. <span style="text-decoration: underline;">refine</span> (hls = _ ). <span style="text-decoration: underline;">move</span>: hls. <span style="text-decoration: underline;">case</span>: ls.
    - <span style="text-decoration: underline;">move</span> =&gt; _ . exact: HNil.
    - <span style="text-decoration: underline;">move</span> =&gt; a ls' hls'. <span style="text-decoration: underline;">refine</span> (_ ::: _).
      + <span style="text-decoration: underline;">case</span>: a ls' hls' / (hlist_destructP hls') =&gt; a ls' ba _.
        exact: ba. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">hhd </span><span style="font-weight: bold; font-style: italic;">*)</span>
      + <span style="text-decoration: underline;">case</span>: a ls' hls' / (hlist_destructP hls') =&gt; a ls' _ hls'.
        exact: hls'. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">htl </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Defined</span>. 

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">hlist_eta</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span>  (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hls</span> : hlist B ( ls)),
      @hlist_eta_type ls hls.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; ls hls. <span style="text-decoration: underline;">case</span>: ls / hls.
    <span style="text-decoration: underline;">rewrite</span> /hlist_eta_type. reflexivity.
    <span style="text-decoration: underline;">rewrite</span> /hlist_eta_type. reflexivity.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">memo: may ;;; </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">tl_hlist_type</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span>  (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hls</span> : hlist B ( ls)), <span style="font-weight: bold; text-decoration: underline;">Type</span>.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; ls. <span style="text-decoration: underline;">case</span>: ls.
    - <span style="text-decoration: underline;">move</span> =&gt; _ . <span style="text-decoration: underline;">refine</span> (hlist B [::]).
    - <span style="text-decoration: underline;">move</span> =&gt; a ls' hls'. <span style="text-decoration: underline;">refine</span> (hlist B ls').
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">tl_hlist</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">ls</span> : list A) (<span style="font-weight: bold; font-style: italic;">hls</span> : hlist B ( ls)), tl_hlist_type hls.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; ls. <span style="text-decoration: underline;">case</span>: ls =&gt; /=.
    - <span style="text-decoration: underline;">move</span> =&gt; hls. exact: hls.
    - <span style="text-decoration: underline;">move</span> =&gt; a ls' hls. <span style="text-decoration: underline;">case</span>: a ls' hls / (hlist_destructP hls) =&gt; a ls' _ hls'.
      exact: hls'.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Section2</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_hlist</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-org8177098" class="outline-3">
<h3 id="org8177098"><span class="section-number-3">2.2</span> Chained lists, lemmas</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Some definitions :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Fixpoint</span> <span style="font-weight: bold;">chain</span> (<span style="font-weight: bold; font-style: italic;">T</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>) (<span style="font-weight: bold; font-style: italic;">ls</span> : list T) {<span style="font-weight: bold; text-decoration: underline;">struct</span> ls} : list (prod T T) :=
  <span style="font-weight: bold; text-decoration: underline;">match</span> ls <span style="font-weight: bold; text-decoration: underline;">with</span>
  | nil =&gt; nil
  | cons t0 ls' =&gt; <span style="font-weight: bold; text-decoration: underline;">match</span> ls' <span style="font-weight: bold; text-decoration: underline;">with</span>
                  | nil =&gt; nil
                  | cons t1 ls'' =&gt; (t0, t1) :: chain ls'
                  <span style="font-weight: bold; text-decoration: underline;">end</span> 
  <span style="font-weight: bold; text-decoration: underline;">end</span>.

<span style="font-weight: bold;">Arguments</span> chain : <span style="text-decoration: underline;">simpl</span> nomatch.
<span style="font-weight: bold;">Eval</span> <span style="text-decoration: underline;">compute</span> <span style="font-weight: bold; text-decoration: underline;">in</span> chain [:: 0; 11; 2; 3].

<span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">chain_graph</span> (<span style="font-weight: bold; font-style: italic;">T</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>) : list T -&gt; list (prod T T) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
| Chain_nil :  chain_graph [::] (chain [::])
| Chain_cons_nil :  <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">t0</span> : T, chain_graph [:: t0] (chain [:: t0])
| Chain_cons_cons : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">t0 t1</span> : T) (<span style="font-weight: bold; font-style: italic;">ls''</span> : list T),
      chain_graph (t1 :: ls'') (chain ([:: t1 &amp; ls'']))
      -&gt; chain_graph (t0 :: t1 :: ls'') ((t0 , t1) :: chain ([:: t1 &amp; ls''])) .

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">chain_graphP</span> (<span style="font-weight: bold; font-style: italic;">T</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>) :
  <span style="font-weight: bold; text-decoration: underline;">forall</span>  (<span style="font-weight: bold; font-style: italic;">ls</span> : list T), chain_graph ls (chain ls).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">induction</span> ls <span style="font-weight: bold; text-decoration: underline;">as</span> [|t0 ls']. <span style="text-decoration: underline;">constructor</span> 1.
  <span style="text-decoration: underline;">destruct</span> ls' <span style="font-weight: bold; text-decoration: underline;">as</span> [|t1 ls'']. <span style="text-decoration: underline;">constructor</span> 2.
  <span style="text-decoration: underline;">simpl</span>.  <span style="text-decoration: underline;">constructor</span> 3. exact:  IHls'.
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">toArrowV</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
           (<span style="font-weight: bold; font-style: italic;">V1V2</span> : prod (obV log) (obV log))
  := V(0 trf V1V2.1 |- trf V1V2.2 )0.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">arrowList</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log} ls
  := (hlist (@toArrowV log trf) (chain ls)).
</pre>
</div>

<p>
Lemmas for (dependent-)destruction by inner instantiations of indices :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Import</span> Destruct_arrowList.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">arrowList_nil</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
  : hlist (toArrowV (trf:=trf)) (chain [::]) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
  | ArrowList_nil : arrowList_nil (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList [::]).

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">arrowList_cons_nil</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V0</span> : (obV log), hlist (toArrowV (trf:=trf)) (chain [:: V0]) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
  | ArrowList_cons_nil : 
      <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V0</span>, @arrowList_cons_nil log trf V0 (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList [:: V0]).

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">arrowList_cons_cons</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V0 V1</span> : obV log) (<span style="font-weight: bold; font-style: italic;">Vs''</span> : list (obV log)),
      hlist (toArrowV (trf:=trf)) ((V0 , V1) :: (chain (V1 :: Vs''))) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
  | ArrowList_cons_cons :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> V0 V1 Vs'' (<span style="font-weight: bold; font-style: italic;">v01</span> : toArrowV (V0 , V1))
        (<span style="font-weight: bold; font-style: italic;">vs'</span> : hlist (toArrowV (trf:=trf)) (chain [:: V1 &amp; Vs''])),
        @arrowList_cons_cons log trf V0 V1 Vs''
   (v01 ::: vs' : hlist (toArrowV (trf:=trf)) ((V0 , V1) :: (chain [:: V1 &amp; Vs'']))).

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">arrowList_destructP_type</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : hlist (toArrowV (trf:=trf)) (chain Vs)), <span style="font-weight: bold; text-decoration: underline;">Type</span>.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; Vs. <span style="text-decoration: underline;">case</span>: Vs (chain Vs) / (chain_graphP Vs) =&gt;
               [ | V0 | V0 V1 Vs'' V1Vs''_chain_graph ] vs.
    - <span style="text-decoration: underline;">refine</span> (@arrowList_nil log trf vs).
    - <span style="text-decoration: underline;">refine</span> (@arrowList_cons_nil log trf V0 vs).
    - <span style="text-decoration: underline;">refine</span> (@arrowList_cons_cons log trf V0 V1 Vs'' vs).
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">arrowList_destructP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : hlist (toArrowV (trf:=trf)) (chain Vs)),
      @arrowList_destructP_type log trf Vs vs.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; Vs. <span style="text-decoration: underline;">rewrite</span> /arrowList_destructP_type.
    <span style="text-decoration: underline;">case</span>: Vs (chain Vs) / (chain_graphP Vs) =&gt;
    [ | V0 | V0 V1 Vs'' V1Vs''_chain_graph ] vs.
    - <span style="text-decoration: underline;">case</span> : vs / (hlist_destructP vs). <span style="text-decoration: underline;">constructor</span>.
    - <span style="text-decoration: underline;">case</span> : vs / (hlist_destructP vs). <span style="text-decoration: underline;">constructor</span>.
    - <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">/!\ </span><span style="font-weight: bold; font-style: italic;">*)</span> <span style="text-decoration: underline;">rewrite</span> (hlist_eta vs). <span style="text-decoration: underline;">constructor</span>.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">indeed computes: </span>
<span style="font-weight: bold; font-style: italic;">  Definition arrowList_cons_cons_destructP {log : logic}{trf : obV log -&gt; obV log} :</span>
<span style="font-weight: bold; font-style: italic;">    forall V0 V1 Vs'' (vs : hlist (toArrowV (trf:=trf)) (chain [:: V0, V1 &amp; Vs''])),</span>
<span style="font-weight: bold; font-style: italic;">      @arrowList_cons_cons log trf V0 V1 Vs'' vs.(**)</span>
<span style="font-weight: bold; font-style: italic;">  Proof.(**)</span>
<span style="font-weight: bold; font-style: italic;">    move =&gt; V0 V1 Vs'' vs.(**) exact: (arrowList_destructP vs).(**)</span>
<span style="font-weight: bold; font-style: italic;">  Defined.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_arrowList</span>.

<span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">arrowList_prop</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">ls</span> : list (obV log),
    hlist (toArrowV (trf:=trf)) (chain ls) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=
| ArrowList_nil : arrowList_prop (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList [::])
| ArrowList_cons_nil : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V0</span>, arrowList_prop (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList [:: V0])
| ArrowList_cons_cons :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> V0 V1 (<span style="font-weight: bold; font-style: italic;">v01</span> : toArrowV (V0, V1)) Vs'' (<span style="font-weight: bold; font-style: italic;">vs'</span> : arrowList (V1 :: Vs'')),
      arrowList_prop vs' -&gt;
      arrowList_prop (v01 ::: vs' : arrowList (V0 :: V1 :: Vs'')).

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">arrowListP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> :arrowList Vs),
    (@arrowList_prop log trf Vs vs).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; Vs. <span style="text-decoration: underline;">move</span>: (chain_graphP Vs) =&gt; Vs_chainInputP.
  <span style="text-decoration: underline;">elim</span> : Vs {-}(chain Vs) / Vs_chainInputP.
  - <span style="text-decoration: underline;">move</span> =&gt; vs. <span style="text-decoration: underline;">case</span>: (arrowList_destructP vs).
    <span style="text-decoration: underline;">apply</span>: ArrowList_nil.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 vs. <span style="text-decoration: underline;">case</span>: V0 vs / (arrowList_destructP vs) =&gt; V0.
    <span style="text-decoration: underline;">apply</span>: ArrowList_cons_nil.
  - <span style="text-decoration: underline;">intros</span> V0 V1 Vs'' <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">ch_V1Vs''_P</span><span style="font-weight: bold; font-style: italic;">*)</span> _ IHVs' vs''. <span style="text-decoration: underline;">move</span>: IHVs'.
    <span style="text-decoration: underline;">case</span>: V0 V1 Vs'' vs'' / (arrowList_destructP vs'') =&gt;
    V0 V1 Vs'' v01 vs' IHVs'.
    <span style="text-decoration: underline;">apply</span>: (ArrowList_cons_cons v01 (IHVs' vs')).
<span style="font-weight: bold;">Defined</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-org9a5722b" class="outline-3">
<h3 id="org9a5722b"><span class="section-number-3">2.3</span> Iterated constructors</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Some definitions :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">iterDeClass0</span> (<span style="font-weight: bold; font-style: italic;">n</span> : nat) : obMod -&gt; obMod
  := iter n DeClass0 .

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">iterDeClassifying</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
           (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) 
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
      (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf (last V_dft Vs) |- [0 B ~&gt; A ]0 )0),
    'D(0 trf(head V_dft Vs) |- [0 B ~&gt; iterDeClass0 (length Vs).-1 A ]0 )0.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; Vs vs. <span style="text-decoration: underline;">move</span>: (arrowListP (trf:=trf) vs) =&gt; vs_arrowListP.
  <span style="text-decoration: underline;">elim</span> : vs_arrowListP =&gt; /= .
  - <span style="text-decoration: underline;">move</span> =&gt; b; exact: b.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 b; exact: b.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs'' vs' vs'_arrowListP vs'_IH b.
    <span style="text-decoration: underline;">refine</span> (v01 o&gt;| (vs'_IH b)  o&gt;Mod 'declfy).
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"vs o&gt;|| a o&gt;Mod ''declfy"</span> :=
  (@iterDeClassifying _ _ _ _ _ _ vs a)
    (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, a <span style="font-weight: bold; text-decoration: underline;">at</span> next level, <span style="text-decoration: underline;">right</span> associativity).

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">iterDeClassifying_rewrite_type</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
           (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log))
           (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs))) : <span style="font-weight: bold; text-decoration: underline;">Prop</span>.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">case</span>: (arrowListP vs).
  - <span style="text-decoration: underline;">refine</span> ( <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf(last V_dft [::]) |- [0 B ~&gt; A ]0 )0),
               iterDeClassifying (V_dft := V_dft) (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList ([::])) b = b ).
  - <span style="text-decoration: underline;">move</span> =&gt; V0.
    <span style="text-decoration: underline;">refine</span> ( <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf(last V0 [::]) |- [0 B ~&gt; A ]0 )0),
            iterDeClassifying (V_dft := V_dft) (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList ([:: V0])) b = b ).
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs'' vs' _ .
    <span style="text-decoration: underline;">refine</span> ( <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf(last V1 Vs'') |- [0 B ~&gt; A ]0 )0),
    iterDeClassifying (V_dft := V_dft) (v01 ::: vs' : arrowList (V0 :: V1 :: Vs'')) b
          = v01 o&gt;| ( iterDeClassifying (V_dft := V_dft) vs' b ) o&gt;Mod 'declfy ).
<span style="font-weight: bold;">Defined</span>.
</pre>
</div>

<p>
Some lemmas for the rewrite tactics :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">iterDeClassifying_rewrite</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log} 
      {<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log} {<span style="font-weight: bold; font-style: italic;">B A</span> : obMod} 
      (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : arrowList Vs) :
  @iterDeClassifying_rewrite_type log trf V_dft B A Vs vs.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">rewrite</span> /iterDeClassifying_rewrite_type.
  <span style="text-decoration: underline;">case</span>: (arrowListP vs); reflexivity.
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Notation</span> RHSc := (X <span style="font-weight: bold; text-decoration: underline;">in</span> _ ~~~ X)%<span style="text-decoration: underline;">pattern</span>.
<span style="font-weight: bold;">Notation</span> LHSc := (X <span style="font-weight: bold; text-decoration: underline;">in</span> X ~~~ _)%<span style="text-decoration: underline;">pattern</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">tac_arrows</span> := (@Mod_arrowPre, @Mod_arrowPost,
                          @UnitDeClass_arrow, @DeClass_arrowPre,
                        @DeClass_arrowPost, @Classifying_arrow, @DeClassifying_arrow).
</pre>
</div>

<p>
Some deduced conversion relations over the generated morphisms :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Hint Extern</span> 4 (_ ~~?lo` _) =&gt; <span style="text-decoration: underline;">eapply</span> (@SymV lo _) : logic_hints.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">PolyV_unitPost</span> : logic_hints.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">PolyV_unitPre</span> : logic_hints.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">GenArrowsMod_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen) (<span style="font-weight: bold; font-style: italic;">aGen</span> : Mod_gen V' A1 A2)
    (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V'' |- V' )0),
    ( ( v' ) o&gt;| #1| aGen )
      ~~~ (v' o&gt;' (log.-1 o&gt;| #1| aGen) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> <span style="font-weight: bold;">logic_hints</span>.   <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">UnitMod_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V' |- log.-I )0),
    ( ( v' ) o&gt;| @uMod A )
      ~~~ (v' o&gt;' (log.-1 o&gt;| @uMod A) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> <span style="font-weight: bold;">logic_hints</span>. <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV0</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV0 |- (0 W &amp; V )0 )0),
    ( ( v0 ) o&gt;| a_ o&gt;Mod a' )
      ~~~ ( v0 o&gt;' ( log.-1 o&gt;| a_ o&gt;Mod a' ) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> logic_hints.  <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">UnitDeClass_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W''</span> : obV log)
    (<span style="font-weight: bold; font-style: italic;">w'</span> : V(0 W'' |- (0 W &amp; log.-I )0 )0)
    (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    ( ( w' ) o&gt;| 'D1| a )
      ~~~ (  w' o&gt;' ( log.-1 o&gt;| 'D1| a ) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> <span style="font-weight: bold;">logic_hints</span>.  <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span>  <span style="font-weight: bold;">DeClass_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV0</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV0 |- (0 W &amp; V )0  )0),
    ( ( v0  ) o&gt;| b o&gt;D a )
      ~~~ ( v0 o&gt;' ( log.-1 o&gt;| b o&gt;D a ) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> logic_hints.  <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Classifying_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0)
    (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V' |- [0 A1 ~&gt; A2 ]0 )0),
    ( ( v0 ) o&gt;| 'clfy o&gt;Mod a )
      ~~~ ( v0 o&gt;' ( log.-1 o&gt;| 'clfy o&gt;Mod a ) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> logic_hints.  <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">DeClassifying_arrowLog_id</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V' V''</span> : obV log)  (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V' |- [0 A1 ~&gt; A2 ]0 )0),
    ( ( v0 ) o&gt;| a o&gt;Mod 'declfy )
      ~~~ ( v0 o&gt;' ( log.-1 o&gt;| a o&gt;Mod 'declfy ) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> logic_hints.  <span style="font-weight: bold;">Qed</span>.
</pre>
</div>

<p>
Some purely-logical lemmas :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">logic_decidable0</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
    log.-1 ~~log` desIdenObLKV o&gt;`log`&gt;
       log.-(1 log.-1 &amp; V )0 o&gt;`log`&gt; desIdenObLK .
Admitted.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">logic_decidable0</span> : logic_hints.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">logic_decidable1</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
                           (<span style="font-weight: bold; font-style: italic;">V W _WV WV</span> : obV log)
                           (<span style="font-weight: bold; font-style: italic;">w</span> : log.-V(0 WV |- log.-(0 W &amp; V )0 )0)
                           (<span style="font-weight: bold; font-style: italic;">w0</span> : log.-V(0 _WV |- WV )0),
 w0 o&gt;`log`&gt; w ~~log` log.-1 o&gt;`log`&gt; (w0 o&gt;`log`&gt; w) o&gt;`log`&gt; log.-(1 log.-1 &amp; V )0.
Admitted.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">logic_decidable1</span> : logic_hints.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">logic_decidable2</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
                           (<span style="font-weight: bold; font-style: italic;">V W WV'</span> : obV log)
                           (<span style="font-weight: bold; font-style: italic;">v0</span> : log.-V(0 WV' |- log.-(0 W &amp; V )0 )0),
    v0 ~~log` (v0 o&gt;`log`&gt; log.-(1 desIdenObRKV &amp; V )0)
       o&gt;`log`&gt; log.-(1 log.-1 o&gt;`log`&gt; desIdenObRK &amp; V )0.
Admitted.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">logic_decidable2</span> : logic_hints.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">logic_decidable3</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
                           (<span style="font-weight: bold; font-style: italic;">W' W_ W'W_</span> : obV log)
                           (<span style="font-weight: bold; font-style: italic;">v</span> : log.-V(0 W'W_ |- log.-(0 W' &amp; W_ )0 )0)
                           (<span style="font-weight: bold; font-style: italic;">W'W_I</span> : obV log)
                           (<span style="font-weight: bold; font-style: italic;">v0</span> : log.-V(0 W'W_I |- log.-(0 W'W_ &amp; log.-I )0 )0),
    v0 o&gt;`log`&gt; log.-(1 v &amp; log.-I )0 ~~log`
       ((v0 o&gt;`log`&gt; log.-(1 v &amp; log.-I )0 o&gt;`log`&gt; Assoc_Rev) o&gt;`log`&gt; desIdenObRKV)
 o&gt;`log`&gt; log.-(1 log.-1 o&gt;`log`&gt; (0 W' &amp; log.-1 o&gt;`log`&gt; desIdenObRK )1 &amp; log.-I )0.
Admitted.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">logic_decidable3</span> : logic_hints.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">logic_decidable4</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
                           (<span style="font-weight: bold; font-style: italic;">V W_ W' W'W_</span> : obV log)
                           (<span style="font-weight: bold; font-style: italic;">v</span> : log.-V(0 W'W_ |- log.-(0 W' &amp; W_ )0 )0)
                           (<span style="font-weight: bold; font-style: italic;">W'W_V</span> : obV log)
                           (<span style="font-weight: bold; font-style: italic;">v0</span> : log.-V(0 W'W_V |- log.-(0 W'W_ &amp; V )0 )0),
 v0 o&gt;`log`&gt; log.-(1 v &amp; V )0 ~~log` (v0 o&gt;`log`&gt; log.-(1 v &amp; V )0 o&gt;`log`&gt; Assoc_Rev)
       o&gt;`log`&gt; (0 W' &amp; log.-1 )1 o&gt;`log`&gt; Assoc .
Admitted.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">logic_decidable4</span> : logic_hints.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">logic_decidable7</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">Vb Vb'</span> : obV log) 
    (<span style="font-weight: bold; font-style: italic;">vb</span> : log.-V(0 Vb' |- Vb )0) (<span style="font-weight: bold; font-style: italic;">V0Vb' trfV0 trfV1</span> : obV log)
    (<span style="font-weight: bold; font-style: italic;">v01</span> : log.-V(0 trfV0 |- trfV1 )0)
    (<span style="font-weight: bold; font-style: italic;">v0b</span> : log.-V(0 V0Vb' |- log.-(0 trfV0 &amp; Vb' )0 )0),

(v0b o&gt;`log`&gt; (0 trfV0 &amp; vb )1) o&gt;`log`&gt; log.-(1 v01 &amp; Vb )0 ~~log`
(((((v0b o&gt;`log`&gt; log.-(1 desIdenObRKV &amp; Vb' )0) o&gt;`log`&gt; 
log.-(1 (log.-1 o&gt;`log`&gt; log.-(1 v01 o&gt;`log`&gt; desIdenObLKV &amp; log.-I )0 
o&gt;`log`&gt; Assoc_Rev) o&gt;`log`&gt; 
log.-(1 desIdenObRKV &amp; log.-(0 trfV1 &amp; log.-I )0 )0 &amp; Vb' )0 
o&gt;`log`&gt; Assoc_Rev) o&gt;`log`&gt; (0 log.-(0 log.-I &amp; log.-I )0 &amp; 
(log.-1 o&gt;`log`&gt; log.-(1 log.-1 o&gt;`log`&gt; desIdenObRK &amp; Vb' )0) 
o&gt;`log`&gt; log.-(1 desIdenObRKV &amp; Vb' )0 )1 o&gt;`log`&gt; Assoc) 
o&gt;`log`&gt; (0 log.-(0 log.-(0 log.-I &amp; log.-I )0 &amp; 
log.-(0 trfV1 &amp; log.-I )0 )0 &amp; vb )1) o&gt;`log`&gt; 
log.-(1 (log.-1 o&gt;`log`&gt; desIdenObRKV) o&gt;`log`&gt; desIdenObRK &amp; Vb )0) 
o&gt;`log`&gt; log.-(1 (log.-1 o&gt;`log`&gt; ((log.-1 o&gt;`log`&gt; 
log.-(1 log.-1 o&gt;`log`&gt; desIdenObRK &amp; log.-(0 trfV1 &amp; log.-I )0 )0) 
o&gt;`log`&gt; log.-(1 log.-1 &amp; log.-(0 trfV1 &amp; log.-I )0 )0) 
o&gt;`log`&gt; log.-(1 log.-1 &amp; log.-(0 trfV1 &amp; log.-I )0 )0 
o&gt;`log`&gt; desIdenObLK) o&gt;`log`&gt; log.-1 o&gt;`log`&gt; desIdenObRK &amp; Vb )0 .

Admitted.
<span style="font-weight: bold;">Hint Resolve</span> <span style="font-weight: bold; font-style: italic;">logic_decidable7</span> : logic_hints.
</pre>
</div>

<p>
Some more deduced conversion relations over the morphisms, this time the
orientation-of-the-most-general is reversed
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod_inputUnitMod_rev</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'Mod(0 V |- [0 B ~&gt; A ]0 )0),
    ( b )
      ~~~  ( desIdenObLKV o&gt;| b o&gt;Mod ( log.-1 o&gt;| uMod ) ).
<span style="font-weight: bold;">Proof</span>. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> logic_hints. 
<span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">intros.(**) rewrite -Mod_inputUnitMod.(**) rewrite [LHSc]PolyV_Mod_unit.(**)</span>
<span style="font-weight: bold; font-style: italic;">             eapply PolyV_Mod_cong; [| reflexivity].(**)</span>
<span style="font-weight: bold; font-style: italic;">             clear.(**) exact: logic_decidable0.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span> <span style="font-weight: bold;">Qed</span>.  

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">DeClassifying_morphismPost_rev</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0)
    (<span style="font-weight: bold; font-style: italic;">W _WV</span> : obV log)  (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b'</span> : 'D(0 W |- [0 A2 ~&gt; A3 ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 WV |- (0 W &amp; V )0 )0) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 _WV |- WV )0),
    ( w0 o&gt;| ( w  o&gt;| b_ o&gt;Mod b' ) o&gt;Mod 'declfy )
      ~~~ ( (w0 o&gt; w) o&gt;| b_ o&gt;Mod ( log.-1 o&gt;| b' o&gt;Mod 'declfy ) ).
<span style="font-weight: bold;">Proof</span>. 
  <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClassifying_morphismPost. 
  <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]Mod_arrowLog_id. <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]DeClassifying_arrow.
  <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_arrowLog_id. <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClassifying_arrow. 
  <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> <span style="font-weight: bold;">logic_hints</span>.
<span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">DeClass_morphismPre_rev</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b'</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log)  (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V )0 )0),
    ( v0  o&gt;| b' o&gt;D ( a ) )
      ~~~ ( (v0 o&gt; ((1 desIdenObRKV &amp; _  )0))  o&gt;| b' o&gt;Mod ( log.-1 o&gt;| 'D1| a )
            : 'D(0 WV' |- [0 B ~&gt; A' ]0)0 ).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPre.
  <span style="text-decoration: underline;">rewrite</span> -DeClass_arrowPost. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> <span style="font-weight: bold;">logic_hints</span>.
<span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">DeClass_morphismPost_rev</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}:
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
    (<span style="font-weight: bold; font-style: italic;">W' W_ W'W_</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W'W_ |- (0 W' &amp; W_ )0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) 
    (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 W_ |- [0 A ~&gt; A' ]0 )0)
    (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W' |- [0 A' ~&gt; A'' ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'W_I</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'W_I |- (0 W'W_ &amp; log.-I )0 )0),
    ( v0 o&gt;| 'D1| ( v o&gt;| a_ o&gt;Mod a' ) )
      ~~~ ( (v0 o&gt; (1 v &amp; _ )0 o&gt; Assoc_Rev) o&gt;| ( (log.-1) o&gt;| 'D1| a_ ) o&gt;D a'
            : 'D(0 W'W_I |- [0 'D0| A ~&gt; A'' ]0)0 ).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPost.
  <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_arrowPre.   <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_arrowLog_id. 
  <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]UnitDeClass_arrow. <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]Mod_arrowLog_id. 
  <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]UnitDeClass_arrow.
  <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> <span style="font-weight: bold;">logic_hints</span>.
<span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod_morphism_rev</span> :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) 
        (<span style="font-weight: bold; font-style: italic;">b</span> : 'Mod(0 V |- [0 B ~&gt; A ]0 )0)
    (<span style="font-weight: bold; font-style: italic;">W_</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 W_ |- [0 A ~&gt; A' ]0 )0)
    (<span style="font-weight: bold; font-style: italic;">W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W' |- [0 A' ~&gt; A'' ]0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'W_</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W'W_ |- (0 W' &amp; W_ )0 )0),
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'W_V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'W_V |- (0 W'W_ &amp; V )0 )0),
    ( v0 o&gt;| b o&gt;Mod ( v o&gt;| a_ o&gt;Mod a' ) )
   ~~~ ( (v0 o&gt; (1 v &amp; _ )0 o&gt; Assoc_Rev) o&gt;| ( (log.-1) o&gt;| b o&gt;Mod a_ ) o&gt;Mod a' ).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">rewrite</span> -Mod_morphism.
  <span style="text-decoration: underline;">rewrite</span> [X <span style="font-weight: bold; text-decoration: underline;">in</span> _ o&gt;| _ o&gt;Mod X ~~~ _]Mod_arrowLog_id.
  <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]Mod_arrowPost. <span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> logic_hints.
<span style="font-weight: bold;">Qed</span>.
</pre>
</div>

<p>
Finally the deduced corresponding conversion relations for the iterated constructors :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Import</span> Iter_deduce.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Import</span> Ex_Notations.

  <span style="font-weight: bold;">Delimit Scope</span> short_scope <span style="font-weight: bold; text-decoration: underline;">with</span> short.
  <span style="font-weight: bold;">Open Scope</span> short_scope.

  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;' a"</span> := (_ o&gt;' a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| #1| a"</span> := (_ o&gt;| #1| a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| 'uMod'"</span> := (_ o&gt;| uMod)(<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| a_ o&gt;Mod a'"</span> := (_ o&gt;| a_ o&gt;Mod a') (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| ''D1|' a"</span> := (_ o&gt;| 'D1| a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| b o&gt;D a"</span> := (_ o&gt;| b o&gt;D a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| 'clfy o&gt;Mod a'"</span> := 
  (_ o&gt;| 'clfy o&gt;Mod a') (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"$ o&gt;| a_ o&gt;Mod 'declfy"</span> := 
  (_ o&gt;| a_ o&gt;Mod 'declfy) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : short_scope.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">iterCancelInner</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log} :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
      (<span style="font-weight: bold; font-style: italic;">Vb Vb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">vb</span> : V(0 Vb' |- Vb )0)
      (<span style="font-weight: bold; font-style: italic;">W W_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">V0Vb'</span> : obV log)
      (<span style="font-weight: bold; font-style: italic;">va</span> : V(0 trf(last W_dft Vs) |- W )0)
      (<span style="font-weight: bold; font-style: italic;">v0b</span> : V(0 V0Vb' |- (0 trf(head W_dft Vs) &amp; Vb' )0 )0)
      (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 Vb |- [0 B ~&gt; A ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)(<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 W |- [0 A ~&gt; A' ]0 )0),
  ( v0b o&gt;| ( vb o&gt;' b)  o&gt;D (iterDeClassifying (V_dft := W_dft) vs ( va o&gt;' a)) )
    ~~~ ( v0b o&gt;| (vb o&gt;| b o&gt;Mod 'declfy )
              o&gt;D (iterDeClassifying (V_dft := W_dft) vs (va o&gt;| 'clfy o&gt;Mod a) )
          : 'D(0 V0Vb' |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A') ]0)0 ).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; Vs; <span style="text-decoration: underline;">elim</span> : Vs =&gt; [ | V0 Vs' ].
  - <span style="text-decoration: underline;">move</span> =&gt; vs. <span style="text-decoration: underline;">case</span>:  vs / (arrowList_destructP vs); <span style="text-decoration: underline;">intros</span>.
    do 2 <span style="text-decoration: underline;">rewrite</span> (iterDeClassifying_rewrite (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList [::])).
      <span style="text-decoration: underline;">apply</span>: CancelInner.
  - <span style="text-decoration: underline;">case</span>: Vs' =&gt; [ | V1 Vs''] IHVs'.
    + <span style="text-decoration: underline;">move</span> =&gt; vs. <span style="text-decoration: underline;">case</span>:  V0 vs / (arrowList_destructP vs); <span style="text-decoration: underline;">intros</span>.
      do 2 <span style="text-decoration: underline;">rewrite</span> (iterDeClassifying_rewrite (<span style="font-weight: bold; font-style: italic;">HNil</span> : arrowList [:: V0])).
      <span style="text-decoration: underline;">apply</span>: CancelInner.
    + <span style="text-decoration: underline;">move</span> =&gt; vs; <span style="text-decoration: underline;">move</span> : IHVs'. <span style="text-decoration: underline;">case</span>:  V0 V1 Vs'' vs / (arrowList_destructP vs).
      <span style="text-decoration: underline;">move</span> =&gt; V0 V1 Vs'' v01 vs' IHVs' Vb Vb' vb W W_dft V0Vb' va v0b B A b A' a.
      do 2 <span style="text-decoration: underline;">rewrite</span> 
      (iterDeClassifying_rewrite (v01 ::: vs' : arrowList [:: V0 , V1 &amp; Vs''])) /=.

      <span style="text-decoration: underline;">rewrite</span> [(_ o&gt;|| _ o&gt;Mod ''declfy) <span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]
              Mod_inputUnitMod_rev.

      <span style="text-decoration: underline;">rewrite</span> [_ o&gt;| _ o&gt;Mod 'declfy <span style="font-weight: bold; text-decoration: underline;">as</span> X <span style="font-weight: bold; text-decoration: underline;">in</span> _ ~~~ (_ o&gt;| _ o&gt;D X )]
              (DeClassifying_morphismPost_rev (log:=log)).
      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPre_rev.
      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPost_rev.
      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPre_rev.
      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_morphism_rev.

      <span style="text-decoration: underline;">rewrite</span> -[X <span style="font-weight: bold; text-decoration: underline;">in</span> _ ~~~ (_ o&gt;| X o&gt;Mod _)]DeClass_morphismPre.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_arrowPost.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]IHVs'.

      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPre_rev.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_morphism.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPre.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPost.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_arrowPost.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClassifying_morphismPost.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]Mod_inputUnitMod.
      <span style="text-decoration: underline;">rewrite</span> -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_morphismPre.

      <span style="text-decoration: underline;">rewrite</span> -!tac_arrows.
      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClassifying_arrowLog_id -[<span style="font-weight: bold; text-decoration: underline;">in</span> RHSc]DeClass_arrowPost.
      <span style="text-decoration: underline;">rewrite</span> [<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]DeClassifying_arrowLog_id -[<span style="font-weight: bold; text-decoration: underline;">in</span> LHSc]DeClass_arrowPost.
      <span style="text-decoration: underline;">apply</span>: PolyDeClass_cong; [ | reflexivity | reflexivity].

      <span style="text-decoration: underline;">clear</span>. <span style="text-decoration: underline;">simpl</span> <span style="font-weight: bold; text-decoration: underline;">in</span> *. <span style="text-decoration: underline;">clear</span>. <span style="text-decoration: underline;">revert dependent</span> trf. <span style="text-decoration: underline;">rewrite</span> /toArrowV. <span style="text-decoration: underline;">simpl</span>.
      <span style="text-decoration: underline;">move</span> =&gt; trf. <span style="text-decoration: underline;">move</span>: (trf V0) (trf V1) =&gt; trfV0 trfV1. <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">clear</span>.
      exact: logic_decidable7.
<span style="font-weight: bold;">Qed</span>.
<span style="font-weight: bold;">Hint Resolve</span> iterCancelInner.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">iterPermOuterInner_DeClass</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
      (<span style="font-weight: bold; font-style: italic;">Wb Wa</span> : obV log) (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">W_dft</span>: obV log) (<span style="font-weight: bold; font-style: italic;">Wba</span> : obV log)
      (<span style="font-weight: bold; font-style: italic;">Wb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wb</span> : V(0 Wb' |- Wb )0)
      (trf':=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; (0 (trf z) &amp; Wb' )0)
      (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
      (<span style="font-weight: bold; font-style: italic;">wa</span> : V(0 trf(last W_dft Vs) |- (0 Wa &amp; log.-I )0 )0)
      (<span style="font-weight: bold; font-style: italic;">wba</span> : V(0 Wba |- (0 trf(head W_dft Vs) &amp; Wb' )0 )0)
      (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 Wb |- [0 B ~&gt; A ]0 )0)
      (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 Wa |- [0 A ~&gt; A' ]0 )0) :
  ( wba o&gt;| (iterDeClassifying (V_dft:=W_dft)
                  (hmap (B2:=toArrowV (trf:=trf')) (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U1U2 u</span> =&gt; ((1 u &amp; Wb')0)) vs)
                  ( ( (1 wa o&gt; desIdenObRK &amp; _ )0 o&gt; (0 _ &amp; wb)1 ) o&gt;| b o&gt;D a ))
        o&gt;Mod 'declfy )
    ~~~ ( wba o&gt;| ( wb o&gt;| b o&gt;Mod 'declfy )
              o&gt;D (iterDeClassifying (V_dft:=W_dft) vs ( wa o&gt;| 'D1| a ))
          : 'D(0 Wba |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A') ]0)0 ) .
Admitted. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">same deduction form </span><span style="font-weight: bold; font-style: italic;">*)</span>
<span style="font-weight: bold;">Hint Resolve</span> iterPermOuterInner_DeClass.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">iterPermOuterInner</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}{<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
      (<span style="font-weight: bold; font-style: italic;">Wb</span> : obV log) (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">W_dft</span>: obV log) (<span style="font-weight: bold; font-style: italic;">Wba</span> : obV log)
      (<span style="font-weight: bold; font-style: italic;">Wb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wb</span> : V(0 Wb' |- Wb )0)
      (trf':=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; (0 (trf z) &amp; Wb' )0)
      (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
      (<span style="font-weight: bold; font-style: italic;">wa</span> : V(0 trf(last W_dft Vs) |- log.-I )0)
      (<span style="font-weight: bold; font-style: italic;">wba</span> : V(0 Wba |- (0 trf(head W_dft Vs) &amp; Wb' )0 )0)
      (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 Wb |- [0 B ~&gt; A ]0 )0) :
  ( wba o&gt;| (iterDeClassifying (V_dft:=W_dft)
                (hmap (B2:=toArrowV (trf:=trf')) (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U1U2 u</span> =&gt; ((1 u &amp; Wb')0)) vs)
                ( ( (1 wa  &amp; _ )0 o&gt; (0 _ &amp; wb)1 o&gt; desIdenObLK ) o&gt;' b ))
        o&gt;Mod 'declfy )
    ~~~ ( wba o&gt;| ( wb o&gt;| b o&gt;Mod 'declfy )
              o&gt;D (iterDeClassifying (V_dft:=W_dft) vs ( wa o&gt;| uMod ))
          : 'D(0 Wba |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A) ]0)0 ) .
Admitted. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">same deduction form </span><span style="font-weight: bold; font-style: italic;">*)</span>
<span style="font-weight: bold;">Hint Resolve</span> iterPermOuterInner.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Iter_deduce</span>.
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8391fb0" class="outline-2">
<h2 id="org8391fb0"><span class="section-number-2">3</span> Grade</h2>
<div class="outline-text-2" id="text-3">
<p>
Definitions &#x2026;
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">grade</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod), 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; nat.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a; <span style="text-decoration: underline;">elim</span> : V A1 A2 / a.
  - <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">refine</span> (S _); assumption <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">intros; assumption </span><span style="font-weight: bold; font-style: italic;">*)</span> . <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyV_Mod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; exact (S O). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">GenArrowsMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; exact (S (S O)). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">UnitMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; ? ? ? a_ grade_a_ ? ? ? ? a' grade_a';
             <span style="text-decoration: underline;">refine</span> (S  (S (grade_a_ + grade_a')%coq_nat)). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">refine</span> (S  (S (S (S _)))); assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">UnitDeClass </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; ? ? ? b grade_b ? ? ? ? a grade_a;
             <span style="text-decoration: underline;">refine</span> (S  (S (S (grade_b + grade_a)%coq_nat))). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyDeClass </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">refine</span> ( (S  (S _))); assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">Classifying </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">refine</span> ( (S  (S _))); assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">DeClassifying </span><span style="font-weight: bold; font-style: italic;">*)</span>
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">gradeCom</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod), 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; nat.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a; <span style="text-decoration: underline;">elim</span> : V A1 A2 / a.
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyV_Mod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; exact (O). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">GenArrowsMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; exact (O). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">UnitMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; ? ? ? a_ gradeCom_a_ ? ? ? v a' gradeCom_a';
  <span style="text-decoration: underline;">refine</span> (gradeCom_a_ + (gradeCom_a' + (grade ( v o&gt;| a_ o&gt;Mod a')))%coq_nat)%coq_nat.
  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">UnitDeClass </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; ? ? ? b gradeCom_b ? ? ? v a gradeCom_a;
             <span style="text-decoration: underline;">refine</span> (gradeCom_b + (gradeCom_a )%coq_nat)%coq_nat.
  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyDeClass </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">Classifying </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">DeClassifying </span><span style="font-weight: bold; font-style: italic;">*)</span>
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">gradeDeClass</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod), 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; nat.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a; <span style="text-decoration: underline;">elim</span> : V A1 A2 / a.
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyV_Mod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; exact (O). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">GenArrowsMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; exact (O). <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">UnitMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; ? ? ? a_ gradeDeClass_a_ ? ? ? v a' gradeDeClass_a';
             <span style="text-decoration: underline;">refine</span> (gradeDeClass_a_ + (gradeDeClass_a')%coq_nat)%coq_nat.
  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">UnitDeClass </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; ? ? ? b gradeDeClass_b ? ? ? v a gradeDeClass_a;
 <span style="text-decoration: underline;">refine</span> (gradeDeClass_b + (gradeDeClass_a + (grade (v o&gt;| b o&gt;D a)))%coq_nat)%coq_nat.
  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">PolyDeClass </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">Classifying </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">intros</span>; assumption. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">DeClassifying </span><span style="font-weight: bold; font-style: italic;">*)</span>
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">gradeTotal</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) :
  'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; nat.
<span style="font-weight: bold;">Proof</span>.
<span style="text-decoration: underline;">move</span> =&gt; a; <span style="text-decoration: underline;">refine</span> ( (grade a) + ( (gradeCom a) + (gradeDeClass a) )%coq_nat )%coq_nat.
<span style="font-weight: bold;">Defined</span>.
</pre>
</div>

<p>
Some lemmas :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">grade_iterDeClassifying</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
      (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs))) :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf (last V_dft Vs) |- [0 B ~&gt; A ]0 )0),
  grade (iterDeClassifying vs b) =
  ((2 * (length (chain Vs)))%coq_nat + grade b)%coq_nat.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span>: (arrowListP (trf:=trf) vs) =&gt; vs_arrowListP.
  <span style="text-decoration: underline;">elim</span> : vs_arrowListP.
  - reflexivity.
  - reflexivity.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs'' vs' vs'_arrowListP IHvs' b.
    <span style="text-decoration: underline;">rewrite</span> (iterDeClassifying_rewrite 
    (v01 ::: vs' : arrowList [:: V0, V1 &amp; Vs''])) /= ||
    <span style="text-decoration: underline;">rewrite</span> /= -/(iterDeClassifying vs' b) .
    <span style="text-decoration: underline;">rewrite</span> IHvs' /=; Omega.omega.
<span style="font-weight: bold;">Qed</span>.
<span style="font-weight: bold;">Hint Rewrite</span> (@grade_iterDeClassifying).

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">gradeCom_iterDeClassifying</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
      (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs))) :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf (last V_dft Vs) |- [0 B ~&gt; A ]0 )0),
  gradeCom (iterDeClassifying vs b) = (gradeCom b).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span>: (arrowListP (trf:=trf) vs) =&gt; vs_arrowListP.
  <span style="text-decoration: underline;">elim</span> : vs_arrowListP.
  - reflexivity.
  - reflexivity.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs'' vs' vs'_arrowListP IHvs' b.
    <span style="text-decoration: underline;">rewrite</span> (iterDeClassifying_rewrite 
    (v01 ::: vs' : arrowList [:: V0, V1 &amp; Vs''])) /= ||
    <span style="text-decoration: underline;">rewrite</span> /= -/(iterDeClassifying vs' b) .
    <span style="text-decoration: underline;">rewrite</span> IHvs' /=; reflexivity.
<span style="font-weight: bold;">Qed</span>.
<span style="font-weight: bold;">Hint Rewrite</span> (@gradeCom_iterDeClassifying).

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">gradeDeClass_iterDeClassifying</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
      (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs))) :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf (last V_dft Vs) |- [0 B ~&gt; A ]0 )0),
  gradeDeClass (iterDeClassifying vs b) = (gradeDeClass b).
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span>: (arrowListP (trf:=trf) vs) =&gt; vs_arrowListP.
  <span style="text-decoration: underline;">elim</span> : vs_arrowListP.
  - reflexivity.
  - reflexivity.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs'' vs' vs'_arrowListP IHvs' b.
    <span style="text-decoration: underline;">rewrite</span> (iterDeClassifying_rewrite 
    (v01 ::: vs' : arrowList [:: V0, V1 &amp; Vs''])) /= ||
    <span style="text-decoration: underline;">rewrite</span> /= -/(iterDeClassifying vs' b) .
    <span style="text-decoration: underline;">rewrite</span> IHvs' /=; reflexivity.
<span style="font-weight: bold;">Qed</span>.
<span style="font-weight: bold;">Hint Rewrite</span> (@gradeDeClass_iterDeClassifying).
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd57311" class="outline-2">
<h2 id="orgdd57311"><span class="section-number-2">4</span> Reduction</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-org72c51cd" class="outline-3">
<h3 id="org72c51cd"><span class="section-number-3">4.1</span> Grammatical generation of the reduction relation</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Generating the reduction relations, memo that the conversion relation <code>Mod_morphism</code>
for associativity, is not contained in the reduction relations :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Red</span>.

  <span style="font-weight: bold;">Reserved Notation</span> <span style="font-style: italic;">"f2 &lt;~~ f1"</span> (<span style="font-weight: bold; text-decoration: underline;">at</span> level 70).

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">convMod</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
      'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">Prop</span> :=

  | Mod_TransV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                   (<span style="font-weight: bold; font-style: italic;">uTrans a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      uTrans &lt;~~ a -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
        a0 &lt;~~ uTrans -&gt; a0 &lt;~~ a

  | PolyV_Mod_cong : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0)
                       (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      v0 ~~ v -&gt; a0 &lt;~~ a -&gt; ( v0 o&gt;' a0 ) &lt;~~ ( v o&gt;' a )

  | Mod_cong_Pre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a_ a_0</span> : 'Mod(0 V |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A' ~&gt; A'' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        v0 ~~ v -&gt; a_0 &lt;~~ a_ -&gt; ( v0 o&gt;| a_0 o&gt;Mod a' ) &lt;~~ ( v o&gt;| a_ o&gt;Mod a' )

  | Mod_cong_Post :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a' a'0</span> : 'Mod(0 W |- [0 A' ~&gt; A'' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        v0 ~~ v -&gt; a'0 &lt;~~ a' -&gt; ( v0 o&gt;| a_ o&gt;Mod a'0 ) &lt;~~ ( v o&gt;| a_ o&gt;Mod a' )

  | UnitDeClass_cong :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
      (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 W' |- (0 W &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
        v0 ~~ v -&gt; a0 &lt;~~ a -&gt; ( v0 o&gt;| 'D1| a0 ) &lt;~~ ( v o&gt;| 'D1| a )

  | PolyDeClass_cong_Pre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b b0</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        v0 ~~ v -&gt; b0 &lt;~~ b -&gt; ( v0 o&gt;| b0 o&gt;D a ) &lt;~~ ( v o&gt;| b o&gt;D a )

  | PolyDeClass_cong_Post :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        v0 ~~ v -&gt; a0 &lt;~~ a -&gt; ( v0 o&gt;| b o&gt;D a0 ) &lt;~~ ( v o&gt;| b o&gt;D a )

  | Classifying_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
    (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      v0 ~~ v -&gt; a0 &lt;~~ a -&gt; (v0 o&gt;| 'clfy o&gt;Mod a0 ) &lt;~~ (v o&gt;| 'clfy o&gt;Mod a )

  | DeClassifying_cong :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v0</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
    (<span style="font-weight: bold; font-style: italic;">a a0</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      v0 ~~ v -&gt; a0 &lt;~~ a -&gt; (v0 o&gt;| a0 o&gt;Mod 'declfy ) &lt;~~ (v o&gt;| a o&gt;Mod 'declfy )

  | GenArrowsMod_arrowLog : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen)
                              (<span style="font-weight: bold; font-style: italic;">aGen</span> : Mod_gen V A1 A2) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
                              (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V'' |- V' )0) ,
      ( ( v' o&gt; v) o&gt;| #1| aGen )
        &lt;~~ (v' o&gt;' (v o&gt;| #1| aGen)
             : 'Mod(0 V'' |- [0 #0| A1 ~&gt; #0| A2 ]0)0 )

  | UnitMod_arrowLog : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0)
                      (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V' |- V )0),
      ( ( v' o&gt; v ) o&gt;| @uMod A )
        &lt;~~ (v' o&gt;' (v o&gt;| @uMod A)
             : 'Mod(0 V' |- [0 A ~&gt; A ]0)0 )

  | Mod_arrowLog :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 WV |- (0 W &amp; V )0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV0</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV0 |- WV )0),
        ( ( v0 o&gt; v ) o&gt;| a_ o&gt;Mod a' )
          &lt;~~ ( v0 o&gt;' ( v o&gt;| a_ o&gt;Mod a' )
                : 'Mod(0 WV0 |- [0 A0 ~&gt; A' ]0)0 )

  | Mod_arrowPre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
        ( ( v0 o&gt; log.-(0 _ &amp; v )1 ) o&gt;| a_ o&gt;Mod a' )
          &lt;~~ ( v0 o&gt;| ( v o&gt;' a_ ) o&gt;Mod a'
                : 'Mod(0 WV' |- [0 A0 ~&gt; A' ]0)0 )

  | Mod_arrowPost :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A0</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A0 ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 W'V |- (0 W' &amp; V )0 )0),
        ( ( w0 o&gt; log.-(1 w &amp; _ )0 ) o&gt;| a_ o&gt;Mod a' )
          &lt;~~ ( w0 o&gt;| a_ o&gt;Mod ( w o&gt;' a' )
                : 'Mod(0 W'V |- [0 A0 ~&gt; A' ]0)0 )

  | UnitDeClass_arrowLog :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W' W''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- (0 W &amp; log.-I )0 )0)
        (<span style="font-weight: bold; font-style: italic;">w'</span> : V(0 W'' |- W' )0)
        (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
        ( ( w' o&gt; w ) o&gt;| 'D1| a )
          &lt;~~ (  w' o&gt;' ( w o&gt;| 'D1| a )
                 : 'D(0 W'' |- [0 'D0| A ~&gt; A' ]0)0 )

  | UnitDeClass_arrow :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W' W''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0)
        (<span style="font-weight: bold; font-style: italic;">w'</span> : V(0 W'' |- (0 W' &amp; log.-I )0 )0)
        (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
        ( ( w' o&gt; log.-(1 w &amp; log.-I )0 ) o&gt;| 'D1| a )
          &lt;~~ (  w' o&gt;| 'D1| ( w o&gt;' a)
                             : 'D(0 W'' |- [0 'D0| A ~&gt; A' ]0)0 )

  | DeClass_arrowLog :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 WV |- (0 W &amp; V )0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV0</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV0 |- WV )0),
        ( ( v0 o&gt; v ) o&gt;| b o&gt;D a )
          &lt;~~ ( v0 o&gt;' ( v o&gt;| b o&gt;D a )
              : 'D(0 WV0 |- [0 B ~&gt; A' ]0)0 )

  | DeClass_arrowPre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
        ( ( v0 o&gt; log.-(0 _ &amp; v )1 ) o&gt;| b o&gt;D a )
          &lt;~~ ( v0 o&gt;| ( v o&gt;' b ) o&gt;D a
              : 'D(0 WV' |- [0 B ~&gt; A' ]0)0 )

  | DeClass_arrowPost :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 W'V |- (0 W' &amp; V )0 )0),
        ( ( w0 o&gt; log.-(1 w &amp; _ )0 ) o&gt;| b o&gt;D a )
          &lt;~~ ( w0 o&gt;| b o&gt;D ( w o&gt;' a )
                : 'D(0 W'V |- [0 B ~&gt; A' ]0)0 )

  | Classifying_arrowLog : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
                             (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                             (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ( ( v0 o&gt; v ) o&gt;| 'clfy o&gt;Mod a )
        &lt;~~ ( v0 o&gt;' ( v o&gt;| 'clfy o&gt;Mod a ) 
              : 'Mod(0 V'' |- [0 'D0| A1 ~&gt; A2 ]0)0 )

  | Classifying_arrow : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
                          (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                          (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ( ( v0 o&gt; v ) o&gt;| 'clfy o&gt;Mod a )
        &lt;~~ ( v0 o&gt;| 'clfy o&gt;Mod ( v o&gt;' a )
              : 'Mod(0 V'' |- [0 'D0| A1 ~&gt; A2 ]0)0 )

  | DeClassifying_arrowLog :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0)
      (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0),
        ( ( v0 o&gt; v ) o&gt;| a o&gt;Mod 'declfy )
          &lt;~~ ( v0 o&gt;' ( v o&gt;| a o&gt;Mod 'declfy )
                : 'D(0 V'' |- [0 A1 ~&gt; 'D0| A2 ]0)0 )

  | DeClassifying_arrow :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V' V''</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 V'' |- V' )0) 
      (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0),
        ( ( v0 o&gt; v ) o&gt;| a o&gt;Mod 'declfy )
          &lt;~~ ( v0 o&gt;| ( v o&gt;' a ) o&gt;Mod 'declfy
                : 'D(0 V'' |- [0 A1 ~&gt; 'D0| A2 ]0)0 )

  | PolyV_Mod_arrowLog :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V'' V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V'' |- V' )0) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log)
        (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
        ( ( v' o&gt; v ) o&gt;' a )
          &lt;~~ ( v' o&gt;' ( v o&gt;' a )
                : 'Mod(0 V'' |- [0 A1 ~&gt; A2 ]0)0 )

  | DeClass_morphismPost :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
        (<span style="font-weight: bold; font-style: italic;">W_ W_'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W_' |- (0 W_ &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) 
        (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 W_ |- [0 A ~&gt; A' ]0 )0)
        (<span style="font-weight: bold; font-style: italic;">W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A''</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W' |- [0 A' ~&gt; A'' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'W_'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'W_' |- (0 W' &amp; W_' )0 )0),
        ( ( v0 o&gt; desIdenObRKV ) o&gt;| 
                   'D1| ( (log.-1) o&gt;| ( ( v o&gt; desIdenObRK ) o&gt;' a_ ) o&gt;Mod a' )  )
          &lt;~~ ( v0 o&gt;| ( v o&gt;| 'D1| a_ ) o&gt;D a'
                : 'D(0 W'W_' |- [0 'D0| A ~&gt; A'' ]0)0 )

  | DeClass_morphismPre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B'</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">b'</span> : 'D(0 V' |- [0 B' ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I )0 )0) 
      (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
        ( v0  o&gt;| b' o&gt;D ( ( v o&gt; desIdenObRK )  o&gt;' a ) )
          &lt;~~ ( v0 o&gt;| b' o&gt;Mod ( v o&gt;| 'D1| a )
                : 'D(0 W'V' |- [0 B' ~&gt; A' ]0)0 )

  | PolyV_Mod_unit :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
        ( a ) &lt;~~ ( log.-1 o&gt;' a
                    : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0)0 )

  | Mod_unit :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0)
        (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        ( ( v0 o&gt; log.-(0 W &amp; v )1 o&gt; desIdenObRK ) o&gt;' a )
          &lt;~~ ( v0 o&gt;| ( v o&gt;| uMod ) o&gt;Mod a
                : 'Mod(0 WV |- [0 A ~&gt; A' ]0)0 )

  | Mod_inputUnitMod :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'Mod(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- log.-I )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        ( ( w0 o&gt; log.-(1 w &amp; V )0 o&gt; desIdenObLK ) o&gt;' b )
          &lt;~~  ( w0 o&gt;| b o&gt;Mod ( w o&gt;| uMod )
                 : 'Mod(0 WV |- [0 B ~&gt; A ]0)0 )

  | DeClass_unit :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        ( ( v0 o&gt; log.-(0 W &amp; v )1 ) o&gt;| 'D1| a )
          &lt;~~ ( v0 o&gt;| ( v o&gt;| uMod ) o&gt;D a
                : 'D(0 WV |- [0 'D0| A ~&gt; A' ]0 )0 )

  | DeClass_inputUnitMod :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- log.-I )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 WV |- (0 W &amp; V )0 )0),
        ( ( w0 o&gt; ( log.-(1 w &amp; _ )0 ) o&gt; desIdenObLK ) o&gt;' b )
          &lt;~~ ( w0 o&gt;| b o&gt;D ( w o&gt;| uMod )
                : 'D(0 WV |- [0 B ~&gt; A ]0)0 )

  | Classifying_morphismPre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0 ) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0)
        (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A2 ~&gt; A3 ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
        ( ( log.-1 ) o&gt;| 'clfy o&gt;Mod ( ( v0 o&gt; (0 _ &amp; v )1 ) o&gt;| a_ o&gt;Mod a' ) )
          &lt;~~ ( v0 o&gt;| (v o&gt;| 'clfy o&gt;Mod a_ ) o&gt;Mod a'
                : 'Mod(0 WV' |- [0 'D0| A1 ~&gt; A3 ]0)0 )

  | Classifying_morphismPre_DeClass :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0 ) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0)
        (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A2 ~&gt; A3 ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">WV'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 WV' |- (0 W &amp; V' )0 )0),
        ( ( log.-1 ) o&gt;| 'clfy o&gt;Mod ( ( v0 o&gt; (0 _ &amp; v )1 ) o&gt;| b o&gt;D a' ) )
          &lt;~~ ( v0 o&gt;| (v o&gt;| 'clfy o&gt;Mod b ) o&gt;D a'
                : 'D(0 WV' |- [0 'D0| A1 ~&gt; A3 ]0)0 )

  | Classifying_morphismPost :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- (0 V &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">a_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) 
      (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a'</span> : 'Mod(0 W |- [0 A2 ~&gt; A3 ]0 )0),
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v0</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
      ( ( log.-1 )
          o&gt;| 'clfy o&gt;Mod ( v0 o&gt;| ( ( v o&gt; desIdenObRK ) o&gt;' a_ ) o&gt;Mod (w o&gt;' a') ) )
        &lt;~~ ( v0 o&gt;| ( v o&gt;| 'D1| a_ ) o&gt;Mod ( w o&gt;| 'clfy o&gt;Mod a' )
              : 'Mod(0 W'V' |- [0 'D0| A1 ~&gt; A3 ]0)0 ) 

  | DeClassifying_morphismPost :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b_</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0)
        (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">A3</span> : obMod) 
        (<span style="font-weight: bold; font-style: italic;">b'</span> : 'D(0 W |- [0 A2 ~&gt; A3 ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w0</span> : V(0 W'V |- (0 W' &amp; V )0 )0),
        ( ( log.-1 ) o&gt;| ( ( w0 o&gt; (1 w &amp; _ )0 ) o&gt;| b_ o&gt;Mod b' ) o&gt;Mod 'declfy )
          &lt;~~ ( w0 o&gt;| b_ o&gt;Mod ( w o&gt;| b' o&gt;Mod 'declfy )
                : 'D(0 W'V |- [0 A1 ~&gt; 'D0| A3 ]0)0 )

  | DeClassifying_morphismPre :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">b_</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
      (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- (0 W &amp; log.-I )0 )0) (<span style="font-weight: bold; font-style: italic;">A4</span> : obMod) 
      (<span style="font-weight: bold; font-style: italic;">b'</span> : 'Mod(0 W |- [0 A2 ~&gt; A4 ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
        ( log.-1 o&gt;|
           ( wv o&gt;| ( v o&gt;' b_ ) o&gt;D ( ( w o&gt; desIdenObRK ) o&gt;' b') ) o&gt;Mod 'declfy )
          &lt;~~ ( wv o&gt;| ( v o&gt;| b_ o&gt;Mod 'declfy ) o&gt;D ( w o&gt;| 'D1| b' )
                : 'D(0 W'V' |- [0 A1 ~&gt; 'D0| A4 ]0)0 )

  | CancelOuter : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
                    (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
                    (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) 
                    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 'D0| A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
        ( wv o&gt;| ( v o&gt;' b ) o&gt;Mod ( w o&gt;' a ) )
          &lt;~~ ( wv o&gt;| ( v o&gt;| b o&gt;Mod 'declfy ) o&gt;Mod ( w o&gt;| 'clfy o&gt;Mod a )
                : 'Mod(0 W'V' |- [0 B ~&gt; A' ]0)0 )

  | CancelInner : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod)
                    (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)
                    (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) 
                    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
        ( wv o&gt;| (v o&gt;' b) o&gt;D (w o&gt;' a) )
          &lt;~~ ( wv o&gt;| (v o&gt;| b o&gt;Mod 'declfy ) o&gt;D (w o&gt;| 'clfy o&gt;Mod a )
                : 'D(0 W'V' |- [0 B ~&gt; A' ]0)0 )

  | PermOuterInner : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) 
                          (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) 
                          (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W' |- W )0) (<span style="font-weight: bold; font-style: italic;">u</span> : V(0 W |- log.-I )0),
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W'V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wv</span> : V(0 W'V' |- (0 W' &amp; V' )0 )0),
        ( wv o&gt;| ( ( log.-(1 w &amp; _ )0 o&gt; log.-(1 u &amp; _ )0 o&gt; desIdenObLK ) o&gt;| 
                                   ( v o&gt;' b ) o&gt;Mod 'declfy ) o&gt;Mod 'declfy )
       &lt;~~ ( wv o&gt;| ( v o&gt;| b o&gt;Mod 'declfy ) o&gt;D ( w o&gt;| (u o&gt;| uMod) o&gt;Mod 'declfy )
                : 'D(0 W'V' |- [0 B ~&gt; 'D0| 'D0| A ]0)0 )

  | IterPermOuterInner :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
        (<span style="font-weight: bold; font-style: italic;">Wb</span> : obV log) (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">W_dft</span>: obV log) (<span style="font-weight: bold; font-style: italic;">Wba</span> : obV log)
        (<span style="font-weight: bold; font-style: italic;">Wb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wb</span> : V(0 Wb' |- Wb )0)
        (trf':=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; (0 (trf z) &amp; Wb' )0)
        (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
        (<span style="font-weight: bold; font-style: italic;">wa</span> : V(0 trf(last W_dft Vs) |- log.-I )0)
        (<span style="font-weight: bold; font-style: italic;">wba</span> : V(0 Wba |- (0 trf(head W_dft Vs) &amp; Wb' )0 )0)
        (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 Wb |- [0 B ~&gt; A ]0 )0),
        ( wba o&gt;| (iterDeClassifying (V_dft:=W_dft)
          (hmap (B2:=toArrowV (trf:=trf')) (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U1U2 u</span> =&gt; ((1 u &amp; Wb')0)) vs)
          ( ( (1 wa  &amp; _ )0 o&gt; (0 _ &amp; wb)1 o&gt; desIdenObLK ) o&gt;' b ))
              o&gt;Mod 'declfy )
          &lt;~~ ( wba o&gt;| ( wb o&gt;| b o&gt;Mod 'declfy )
                  o&gt;D (iterDeClassifying (V_dft:=W_dft) vs ( wa o&gt;| uMod ))
              : 'D(0 Wba |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A) ]0)0 )

  | IterPermOuterInner_DeClass :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
        (<span style="font-weight: bold; font-style: italic;">Wb Wa</span> : obV log) (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">W_dft</span>: obV log) (<span style="font-weight: bold; font-style: italic;">Wba</span> : obV log)
        (<span style="font-weight: bold; font-style: italic;">Wb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">wb</span> : V(0 Wb' |- Wb )0)
        (trf':=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; (0 (trf z) &amp; Wb' )0)
        (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
        (<span style="font-weight: bold; font-style: italic;">wa</span> : V(0 trf(last W_dft Vs) |- (0 Wa &amp; log.-I )0 )0)
        (<span style="font-weight: bold; font-style: italic;">wba</span> : V(0 Wba |- (0 trf(head W_dft Vs) &amp; Wb' )0 )0)
        (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 Wb |- [0 B ~&gt; A ]0 )0)
        (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 Wa |- [0 A ~&gt; A' ]0 )0),
          ( wba o&gt;| (iterDeClassifying (V_dft:=W_dft)
            (hmap (B2:=toArrowV (trf:=trf')) (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U1U2 u</span> =&gt; ((1 u &amp; Wb')0)) vs)
            ( ( (1 wa o&gt; desIdenObRK &amp; _ )0 o&gt; (0 _ &amp; wb)1 ) o&gt;| b o&gt;D a ))
                o&gt;Mod 'declfy )
            &lt;~~ ( wba o&gt;| ( wb o&gt;| b o&gt;Mod 'declfy )
                    o&gt;D (iterDeClassifying (V_dft:=W_dft) vs ( wa o&gt;| 'D1| a ))
                : 'D(0 Wba |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A') ]0)0 )

  | IterCancelInner :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
        (<span style="font-weight: bold; font-style: italic;">Vb Vb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">vb</span> : V(0 Vb' |- Vb )0)
        (<span style="font-weight: bold; font-style: italic;">W W_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">V0Vb'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log))
        (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
        (<span style="font-weight: bold; font-style: italic;">va</span> : V(0 trf(last W_dft Vs) |- W )0)
        (<span style="font-weight: bold; font-style: italic;">v0b</span> : V(0 V0Vb' |- (0 trf(head W_dft Vs) &amp; Vb' )0 )0)
        (<span style="font-weight: bold; font-style: italic;">B</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 Vb |- [0 B ~&gt; A ]0 )0)
        (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod)(<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 W |- [0 A ~&gt; A' ]0 )0),
     ( v0b o&gt;| ( vb o&gt;' b)  o&gt;D (iterDeClassifying (V_dft := W_dft) vs ( va o&gt;' a)) )
          &lt;~~ ( v0b o&gt;| (vb o&gt;| b o&gt;Mod 'declfy )
                  o&gt;D (iterDeClassifying (V_dft := W_dft) vs (va o&gt;| 'clfy o&gt;Mod a) )
              : 'D(0 V0Vb' |- [0 B ~&gt; 'D0| (iterDeClass0 (length Vs).-1 A') ]0)0 )

  <span style="font-weight: bold; text-decoration: underline;">where</span> <span style="font-style: italic;">"f2 &lt;~~ f1"</span> := (@convMod _ _ _ _ f2 f1).

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Export</span> Ex_Notations.

    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"f2 &lt;~~ f1"</span> := (@convMod _ _ _ _ f2 f1).
    <span style="font-weight: bold;">Hint Constructors</span> convMod.
    <span style="font-weight: bold;">Hint Extern</span> 0 (_ &lt;~~ _) =&gt;
    ( <span style="font-weight: bold; font-style: italic;">exact</span>: (@Red.IterPermOuterInner _ id) ) : iter_hints.
    <span style="font-weight: bold;">Hint Extern</span> 0 (_ &lt;~~ _) =&gt;
    ( <span style="font-weight: bold; font-style: italic;">exact</span>: (@Red.IterPermOuterInner_DeClass _ id) ) : iter_hints.
    <span style="font-weight: bold;">Hint Extern</span> 0 (_ &lt;~~ _) =&gt;
    ( <span style="font-weight: bold; font-style: italic;">exact</span>: (@Red.IterCancelInner _ id) ) : iter_hints.

    <span style="font-weight: bold;">Add Parametric Relation</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) :
      ('Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0) (@convMod log V A1 A2)
        <span style="text-decoration: underline;">transitivity</span> proved by
        (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">x y z r1 r2</span> =&gt;  ((@Mod_TransV log V A1 A2) y z r2 x r1))
          <span style="font-weight: bold; text-decoration: underline;">as</span> convMod_rewrite.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6b578b" class="outline-3">
<h3 id="orgd6b578b"><span class="section-number-3">4.2</span> Degradation lemmas</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-coq">  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Red_convMod_convMod</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a aDeg</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      aDeg &lt;~~ a -&gt; aDeg ~~~ a.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a aDeg. <span style="text-decoration: underline;">elim</span>; <span style="text-decoration: underline;">eauto</span>. <span style="font-weight: bold;">Show</span>.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">degrade</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">aDeg a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      aDeg &lt;~~ a -&gt;
      ((grade aDeg) &lt;= (grade a))%coq_nat
      /\ ( ( (gradeTotal aDeg) &lt; (gradeTotal a) )%coq_nat ).
  <span style="font-weight: bold;">Proof</span>.
    (<span style="text-decoration: underline;">move</span> =&gt; V A1 A2 aDeg a red_a); <span style="text-decoration: underline;">elim</span> : V A1 A2 aDeg a / red_a;
      try solve [ ( <span style="text-decoration: underline;">rewrite</span> /gradeTotal /= =&gt; * );
                  repeat <span style="text-decoration: underline;">rewrite</span> !(grade_iterDeClassifying,
                                   gradeCom_iterDeClassifying,
                                   gradeDeClass_iterDeClassifying) /= ;
                  abstract <span style="text-decoration: underline;">intuition</span> Omega.omega ].
  <span style="font-weight: bold;">Qed</span>.
  <span style="font-weight: bold;">Hint Resolve</span> degrade.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">degradeTotal</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">aDeg a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      aDeg &lt;~~ a -&gt; ( (gradeTotal aDeg) &lt; (gradeTotal a) )%coq_nat.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">eapply</span> degrade.
  <span style="font-weight: bold;">Qed</span>.
  <span style="font-weight: bold;">Hint Resolve</span> degradeTotal.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">degrade_gt0</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ((S O) &lt;= grade a )%coq_nat.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span>=&gt; V A1 A2 a; <span style="text-decoration: underline;">apply</span>/leP; <span style="text-decoration: underline;">elim</span> : a; <span style="text-decoration: underline;">simpl</span>; <span style="text-decoration: underline;">auto</span>. <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">alt: Omega.omega.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Qed</span>.
  <span style="font-weight: bold;">Hint Resolve</span> degrade_gt0.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">degradeTotal_gt0</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} :
    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0),
      ((S O) &lt;= gradeTotal a )%coq_nat.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">move</span>=&gt; V A1 A2 a; <span style="text-decoration: underline;">move</span>: (degrade_gt0 a);
            <span style="text-decoration: underline;">rewrite</span> /gradeTotal; <span style="text-decoration: underline;">move</span> =&gt; * ; Omega.omega.
  <span style="font-weight: bold;">Qed</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Red</span>.
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd94353e" class="outline-2">
<h2 id="orgd94353e"><span class="section-number-2">5</span> Solution</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-org8317458" class="outline-3">
<h3 id="org8317458"><span class="section-number-3">5.1</span> Grammatical generation of the solution morphisms</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Sol</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Section1</span>.

  <span style="font-weight: bold;">Delimit Scope</span> gen_scope <span style="font-weight: bold; text-decoration: underline;">with</span> gen.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod_genAtomic</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : obV log -&gt; obMod_gen -&gt; obMod_gen -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | GenArrowsMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen
      , Mod_gen V A1 A2 -&gt; 
        V(0 V' |- V )0 -&gt; 'Mod(0 V' |- [0 A1 ~&gt; A2 ]0 )0

  | PolyMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod_gen) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod_gen)
   , 'Mod(0 V |- [0 A2 ~&gt; A1 ]0 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1'</span> : obMod_gen, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W WV</span> : obV log),
          V(0 WV |- (0 W &amp; V )0 )0 -&gt;
          'Mod(0 W |- [0 A1 ~&gt; A1' ]0 )0 -&gt; 'Mod(0 WV |- [0 A2 ~&gt; A1' ]0 )0
  <span style="font-weight: bold; text-decoration: underline;">where</span>
  <span style="font-style: italic;">"''Mod' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
    := (@Mod_genAtomic _ V A1 A2) : gen_scope.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : obV log -&gt; obMod -&gt; obMod -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | GenAtomicArrowsMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen
      , ( 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 ) %gen -&gt; 
      'Mod(0 V |- [0 (#0| A1) ~&gt; (#0| A2) ]0 )0

  | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obMod}
      ,  V(0 V |- log.-I )0 -&gt; 'Mod(0 V |- [0 A ~&gt; A ]0 )0

  | UnitDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
    , V(0 W' |- (0 W &amp; log.-I)0 )0 -&gt;
      'Mod(0 W |- [0 A ~&gt; A' ]0 )0 -&gt; 'D(0 W' |- [0 'D0| A ~&gt; A' ]0 )0

  | Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
        V(0 V' |- V )0 -&gt;
        'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; 'Mod(0 V' |- [0 ('D0| A1) ~&gt; A2 ]0 )0

  | DeClassifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
        V(0 V' |- V )0 -&gt; 
        'D(0 V |- [0 A1 ~&gt; A2 ]0 )0 -&gt; 'D(0 V' |- [0 A1 ~&gt; ('D0| A2) ]0 )0

  <span style="font-weight: bold; text-decoration: underline;">where</span>
  <span style="font-style: italic;">"''Mod' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
    := (@Mod00 _ V A1 A2) and <span style="font-style: italic;">"''D' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
         := (@Mod00 _ V A1 ('D0| A2)).

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Section1</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Import</span> Ex_Notations0.
    <span style="font-weight: bold;">Delimit Scope</span> sol_scope <span style="font-weight: bold; text-decoration: underline;">with</span> sol.
    <span style="font-weight: bold;">Coercion</span> <span style="font-weight: bold; font-style: italic;">GenAtomicArrowsMod</span> : Mod_genAtomic &gt;-&gt; Mod00.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"''Mod' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
      := (@Mod00 _ V A1 A2) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"''D' (0 V |- [0 A1 ~&gt; A2 ]0 )0"</span>
      := (@Mod00 _ V A1 ('D0| A2)) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| #1| a"</span> :=
      (@GenArrowsMod _ _ _ _ _ a v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| a_ o&gt;Mod a'"</span> :=
      (@PolyMod _ _ _ _ a_ _ _ _ v a')
        (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity, a_ <span style="font-weight: bold; text-decoration: underline;">at</span> next level, 
        format <span style="font-style: italic;">"v  o&gt;|  a_  o&gt;Mod  a'"</span>) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| 'uMod'"</span> := (@UnitMod _ _ _ v)(<span style="font-weight: bold; text-decoration: underline;">at</span> level 25) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| @ 'uMod' A"</span> :=
      (@UnitMod _ _ A v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, only parsing) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| ''D1|' a"</span> := (@UnitDeClass _ _ _ _ _ v a)
                                   (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| 'clfy o&gt;Mod a'"</span> :=
      (@Classifying _ _ _ _ _ v a') (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, <span style="text-decoration: underline;">right</span> associativity) : sol_scope.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v o&gt;| a_ o&gt;Mod 'declfy"</span> :=
      (@DeClassifying _ _ _ _ _ v a_) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, a_ <span style="font-weight: bold; text-decoration: underline;">at</span> next level, 
      <span style="text-decoration: underline;">right</span> associativity) : sol_scope.
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations0</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-org49c7fff" class="outline-3">
<h3 id="org49c7fff"><span class="section-number-3">5.2</span> Containment of the solution morphisms into all the morphisms</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">iterDeClassifyingSol</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
           (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) 
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
      (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf (last V_dft Vs) |- [0 B ~&gt; A ]0 )0 % sol),
    'D(0 trf(head V_dft Vs) |- [0 B ~&gt; iterDeClass0 (length Vs).-1 A ]0 )0 %sol .
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; Vs vs. <span style="text-decoration: underline;">move</span>: (arrowListP (trf:=trf) vs). <span style="text-decoration: underline;">elim</span> =&gt; /= .
  - <span style="text-decoration: underline;">move</span> =&gt; b; exact: b.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 b; exact: b.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs'' vs' vs'_arrowListP vs'_IH b.
    <span style="text-decoration: underline;">refine</span> (v01 o&gt;| (vs'_IH b)  o&gt;Mod 'declfy)%sol.
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Import</span> Ex_Notations.
  <span style="font-weight: bold;">Export</span> Ex_Notations0.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"vs o&gt;|| a o&gt;Mod ''declfy"</span> :=
    (@iterDeClassifyingSol _ _ _ _ _ _ vs a)
      (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, a <span style="font-weight: bold; text-decoration: underline;">at</span> next level, <span style="text-decoration: underline;">right</span> associativity) : sol_scope.
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">toMod_gen</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen),
    Mod_genAtomic V A1 A2 -&gt; 'Mod(0 V |- [0 #0| A1 ~&gt; #0| A2 ]0 )0.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a; <span style="text-decoration: underline;">elim</span> : V A1 A2 / a =&gt;
  [ V V' A1 A2 aGen v <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| #1| aGen)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
  | V A2 A1 a_GenAtom a_GenAtom_toMod A1' W WV wv a'GenAtom a'GenAtom_toMod
      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(a_GenAtom o&gt;Mod a'GenAtom)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
      ] ;
    [ <span style="text-decoration: underline;">apply</span>: (v o&gt;| #1| aGen)
    | <span style="text-decoration: underline;">apply</span>: (wv o&gt;| a_GenAtom_toMod o&gt;Mod a'GenAtom_toMod) ].
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">toMod</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
    'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 % sol -&gt; 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0.
<span style="font-weight: bold;">Proof</span>.
    (<span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a); <span style="text-decoration: underline;">elim</span> : V A1 A2 / a =&gt;
    [ V A1 A2 a <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">GenAtomicArrowsMod </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V A v <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| @uMod A)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | A A' W W' v aSol aSol_toMod  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| 'D1| aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V V' A1 A2 v aSol aSol_toMod  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| 'clfy o&gt;Mod aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V V' A1 A2 v aSol aSol_toMod  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| aSol o&gt;Mod 'declfy)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
    ] ;
      [ <span style="text-decoration: underline;">apply</span>: toMod_gen a
      | <span style="text-decoration: underline;">apply</span>: (v o&gt;| @uMod A)
      | <span style="text-decoration: underline;">apply</span>: (v o&gt;| 'D1| aSol_toMod)
      | <span style="text-decoration: underline;">apply</span>: (v o&gt;| 'clfy o&gt;Mod aSol_toMod)
      | <span style="text-decoration: underline;">apply</span>: (v o&gt;| aSol_toMod o&gt;Mod 'declfy) ].
<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">toMod_iterDeClassifyingSol</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">trf</span> : obV log -&gt; obV log}
           (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B A</span> : obMod) 
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=trf)) (chain Vs)))
      (<span style="font-weight: bold; font-style: italic;">b</span> : 'D(0 trf (last V_dft Vs) |- [0 B ~&gt; A ]0 )0 % sol),
    toMod (vs o&gt;|| b o&gt;Mod ''declfy)%sol = vs o&gt;|| toMod b o&gt;Mod ''declfy.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">move</span> =&gt; Vs vs; <span style="text-decoration: underline;">elim</span>: Vs vs / (arrowListP vs).
  - reflexivity.
  - reflexivity.
  - <span style="text-decoration: underline;">move</span> =&gt; V0 V1 v01 Vs' vs' vs'_arrowListP IH_vs'_arrowListP b.
    <span style="text-decoration: underline;">rewrite</span> (iterDeClassifying_rewrite (v01 ::: vs' : arrowList (V0 :: V1 :: Vs'))).
    <span style="text-decoration: underline;">rewrite</span> -IH_vs'_arrowListP. reflexivity.      
<span style="font-weight: bold;">Defined</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-org0232603" class="outline-3">
<h3 id="org0232603"><span class="section-number-3">5.3</span> Destruction of morphisms with inner-instantiation of object-indices</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Lemmas for (dependent-)destruction by inner instantiations of indices (objects).
</p>

<p>
Where the domain of the morphism is some object of the generator graph :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Destruct_domGen</span>.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00_domGen</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod_gen) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod),
    ( 'Mod(0 V |- [0 #0| A1 ~&gt; A2 ]0 )0 %sol ) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | GenAtomicArrowsMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod_gen)
                           (<span style="font-weight: bold; font-style: italic;">aGen</span> : Mod_genAtomic V A1 A2),
      Mod00_domGen (GenAtomicArrowsMod aGen)

  | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) {<span style="font-weight: bold; font-style: italic;">A</span> : obMod_gen} (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0),
      Mod00_domGen (v o&gt;| @uMod (#0| A) )%sol

  | DeClassifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod_gen) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod)
                      (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
                      (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 #0| A1 ~&gt; A2 ]0 )0 %sol ),
      Mod00_domGen (v o&gt;| a o&gt;Mod 'declfy)%sol.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod00_domGenP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod)
        ( <span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
      <span style="font-weight: bold; text-decoration: underline;">match</span> A1 <span style="font-weight: bold; text-decoration: underline;">as</span> A1 <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
      | 'D0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
      | #0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt; @Mod00_domGen log V A1 A2 a
      <span style="font-weight: bold; text-decoration: underline;">end</span> a.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">case</span>: V A1 A2 / a.
    - <span style="text-decoration: underline;">constructor</span> 1.
    - <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">destruct</span> A. <span style="text-decoration: underline;">constructor</span> 2. exact: tt.
    - <span style="text-decoration: underline;">intros</span>. exact: tt.
    - <span style="text-decoration: underline;">intros</span>. exact: tt.
    - <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">destruct</span> A1. <span style="text-decoration: underline;">constructor</span> 3. exact: tt.
  <span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_domGen</span>.
</pre>
</div>

<p>
Where the domain of the morphism is some functor-onto-object construction :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Destruct_domDeClass</span>.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00_domDeClass</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod),
    ( 'Mod(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 %sol ) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) {<span style="font-weight: bold; font-style: italic;">A</span> : obMod} (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0),
      Mod00_domDeClass (v o&gt;| @uMod ('D0| A))%sol

  | UnitDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
                    ( <span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I)0 )0) 
                    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0 %sol),
      Mod00_domDeClass (v o&gt;| 'D1| a)%sol

  | Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                    (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol),
      Mod00_domDeClass (v o&gt;| 'clfy o&gt;Mod a)%sol

  | DeClassifying :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
        (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 %sol ),
        Mod00_domDeClass (v o&gt;| a o&gt;Mod 'declfy)%sol.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod00_domDeClassP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod)
        ( <span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
      <span style="font-weight: bold; text-decoration: underline;">match</span> A1 <span style="font-weight: bold; text-decoration: underline;">as</span> A1 <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
      | 'D0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt; @Mod00_domDeClass log V A1 A2 a
      | #0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
      <span style="font-weight: bold; text-decoration: underline;">end</span> a.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">case</span>: V A1 A2 / a.
    - <span style="text-decoration: underline;">intros</span>. exact: tt.
    - <span style="text-decoration: underline;">move</span> =&gt; V A v. <span style="text-decoration: underline;">destruct</span> A. exact: tt. <span style="text-decoration: underline;">constructor</span> 1.
    - <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">constructor</span> 2.
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">constructor</span> 3.
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">destruct</span> A1. exact: tt. <span style="text-decoration: underline;">constructor</span> 4. 
  <span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_domDeClass</span>.
</pre>
</div>

<p>
Where the domain of the morphism is deeper two functor-onto-object constructions :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Destruct_dom2DeClass</span>.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00_dom2DeClass</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod),
    ( 'Mod(0 V |- [0 'D0| ('D0| A1) ~&gt; A2 ]0 )0 %sol ) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) {<span style="font-weight: bold; font-style: italic;">A</span> : obMod} (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0),
      Mod00_dom2DeClass (v o&gt;| @uMod ('D0| ('D0| A)))%sol

  | UnitDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
                    ( <span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I)0 )0) 
                    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 'D0| A ~&gt; A' ]0 )0 %sol),
      Mod00_dom2DeClass (v o&gt;| 'D1| a)%sol

  | Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) 
                         (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 %sol),
      Mod00_dom2DeClass (v o&gt;| 'clfy o&gt;Mod a)%sol

  | DeClassifying :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
        (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 'D0| ('D0| A1) ~&gt; A2 ]0 )0 %sol ),
        Mod00_dom2DeClass (v o&gt;| a o&gt;Mod 'declfy)%sol.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod00_dom2DeClassP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod)
        ( <span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
      <span style="font-weight: bold; text-decoration: underline;">match</span> A1 <span style="font-weight: bold; text-decoration: underline;">as</span> A1 <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
      | 'D0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt;
                    <span style="font-weight: bold; text-decoration: underline;">match</span> A1 <span style="font-weight: bold; text-decoration: underline;">as</span> A1 
                    <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
                    | 'D0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt; @Mod00_dom2DeClass log V A1 A2 a
                    | #0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
                    <span style="font-weight: bold; text-decoration: underline;">end</span> a
      | #0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
      <span style="font-weight: bold; text-decoration: underline;">end</span> a.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">case</span>: V A1 A2 / a.
    - <span style="text-decoration: underline;">intros</span>. exact: tt.
    - <span style="text-decoration: underline;">move</span> =&gt; V A v. <span style="text-decoration: underline;">destruct</span> A <span style="font-weight: bold; text-decoration: underline;">as</span> [|A]; 
      [exact: tt | <span style="text-decoration: underline;">destruct</span> A; [exact: tt | <span style="text-decoration: underline;">constructor</span> 1]].
    - <span style="text-decoration: underline;">move</span> =&gt; A A' W W' v a. <span style="text-decoration: underline;">destruct</span> A; [exact: tt | <span style="text-decoration: underline;">constructor</span> 2].
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">destruct</span> A1; [exact: tt | <span style="text-decoration: underline;">constructor</span> 3].
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">destruct</span> A1 <span style="font-weight: bold; text-decoration: underline;">as</span> [|A1]; 
      [exact: tt | <span style="text-decoration: underline;">destruct</span> A1; [exact: tt | <span style="text-decoration: underline;">constructor</span> 4]].
  <span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_dom2DeClass</span>.
</pre>
</div>

<p>
Where the codomain of the morphism is some functor-onto-object construction :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Destruct_codomDeClass</span>.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00_codomDeClass</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod),
    ( 'Mod(0 V |- [0 A1 ~&gt; 'D0| A2 ]0 )0 %sol ) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) {<span style="font-weight: bold; font-style: italic;">A</span> : obMod} (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0),
      Mod00_codomDeClass (v o&gt;| @uMod ('D0| A))%sol

  | UnitDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
                    ( <span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I)0 )0) 
                    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0 %sol),
      Mod00_codomDeClass (v o&gt;| 'D1| a)%sol

  | Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
                 (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; 'D0| A2 ]0 )0 %sol),
      Mod00_codomDeClass (v o&gt;| 'clfy o&gt;Mod a)%sol

  | DeClassifying :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
        (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
        Mod00_codomDeClass (v o&gt;| a o&gt;Mod 'declfy)%sol.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod00_codomDeClassP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod)
        ( <span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
      <span style="font-weight: bold; text-decoration: underline;">match</span> A2 <span style="font-weight: bold; text-decoration: underline;">as</span> A2 <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
      | 'D0| A2 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt; @Mod00_codomDeClass log V A1 A2 a
      | #0| A2 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
      <span style="font-weight: bold; text-decoration: underline;">end</span> a.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">case</span>: V A1 A2 / a.
    - <span style="text-decoration: underline;">intros</span>. exact: tt.
    - <span style="text-decoration: underline;">move</span> =&gt; V A v. <span style="text-decoration: underline;">destruct</span> A. exact: tt. <span style="text-decoration: underline;">constructor</span> 1.
    - <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">constructor</span> 2.
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">destruct</span> A2. <span style="text-decoration: underline;">intros</span>; exact: tt. <span style="text-decoration: underline;">constructor</span> 3.
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">constructor</span> 4. 
  <span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_codomDeClass</span>.
</pre>
</div>

<p>
Where both domain and codomain of the morphism are some functor-onto-object
constructions :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Destruct_domCodomDeClass</span>.

  <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">Mod00_domCodomDeClass</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod),
    ( 'Mod(0 V |- [0 'D0| A1 ~&gt; 'D0| A2 ]0 )0 %sol ) -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

  | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) {<span style="font-weight: bold; font-style: italic;">A</span> : obMod} (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0),
      Mod00_domCodomDeClass (v o&gt;| @uMod ('D0| A))%sol

  | UnitDeClass : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
                    ( <span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I)0 )0) 
                    (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0 %sol),
      Mod00_domCodomDeClass (v o&gt;| 'D1| a)%sol

  | Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) 
                         (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; 'D0| A2 ]0 )0 %sol),
      Mod00_domCodomDeClass (v o&gt;| 'clfy o&gt;Mod a)%sol

  | DeClassifying :
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
        (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 %sol ),
        Mod00_domCodomDeClass a -&gt;
        Mod00_domCodomDeClass (v o&gt;| a o&gt;Mod 'declfy)%sol.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Mod00_domCodomDeClassP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic}
    : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A2</span> : obMod)
        ( <span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
      <span style="font-weight: bold; text-decoration: underline;">match</span> A1 <span style="font-weight: bold; text-decoration: underline;">as</span> A1 <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
      | 'D0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt;
                    <span style="font-weight: bold; text-decoration: underline;">match</span> A2 <span style="font-weight: bold; text-decoration: underline;">as</span> A2 
                    <span style="font-weight: bold; text-decoration: underline;">return</span> 'Mod(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 %sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> <span style="font-weight: bold; text-decoration: underline;">with</span>
                    | 'D0| A2 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt; @Mod00_domCodomDeClass log V A1 A2 a
                    | #0| A2 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
                    <span style="font-weight: bold; text-decoration: underline;">end</span> a
      | #0| A1 =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> =&gt; unit
      <span style="font-weight: bold; text-decoration: underline;">end</span> a.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">elim</span>: V A1 A2 / a.
    - <span style="text-decoration: underline;">intros</span>. exact: tt.
    - <span style="text-decoration: underline;">move</span> =&gt; V A v. <span style="text-decoration: underline;">destruct</span> A. exact: tt. <span style="text-decoration: underline;">constructor</span> 1.
    - <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">constructor</span> 2.
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a _ . <span style="text-decoration: underline;">destruct</span> A2. exact: tt. <span style="text-decoration: underline;">constructor</span> 3.
    - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a IHa. <span style="text-decoration: underline;">destruct</span> A1. exact: tt. <span style="text-decoration: underline;">constructor</span> 4.
      exact: IHa.
  <span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_domCodomDeClass</span>.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf36d000" class="outline-3">
<h3 id="orgf36d000"><span class="section-number-3">5.4</span> Iterated <code>DeClassifying</code> prefix</h3>
<div class="outline-text-3" id="text-5-4">
<p>
Any solution morphism may be written as some decomposition with maximal prefix of
iterated <code>DeClassifying</code> constructors :
</p>

<div class="org-src-container">
<pre class="src src-coq">  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Destruct_iterDeClassifying</span>.

    <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">codomDeClass_prefixDeClassifying_Sol</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : 
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
      'Mod(0 V |- [0 'D0| A1 ~&gt; 'D0| A2 ]0 )0 % sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

    | IterDeClassifying_UnitMod : 
        <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) 
         (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z)) (chain Vs)))
         (<span style="font-weight: bold; font-style: italic;">va</span> : V(0 last V_dft Vs |- log.-I )0),
         codomDeClass_prefixDeClassifying_Sol (iterDeClassifyingSol (V_dft:=V_dft) vs
         ( va o&gt;| @uMod ('D0| A) )%sol)

    | IterDeClassifying_UnitDeClass : 
       <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A A'</span> : obMod) 
         (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z)) (chain Vs)))
         (<span style="font-weight: bold; font-style: italic;">Va</span> : obV log) (<span style="font-weight: bold; font-style: italic;">va</span> : V(0 last V_dft Vs |- (0 Va &amp; log.-I)0 )0)
         (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 Va |- [0 A ~&gt; A' ]0 )0 %sol ),
         codomDeClass_prefixDeClassifying_Sol (iterDeClassifyingSol (V_dft:=V_dft) vs
         ( va o&gt;| 'D1| a )%sol)

    | IterDeClassifying_Classifying : 
       <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V_dft</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
         (<span style="font-weight: bold; font-style: italic;">Vs</span> : list (obV log)) (<span style="font-weight: bold; font-style: italic;">vs</span> : (hlist (toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z)) (chain Vs)))
         (<span style="font-weight: bold; font-style: italic;">Va</span> : obV log) (<span style="font-weight: bold; font-style: italic;">va</span> : V(0 last V_dft Vs |- Va )0)
         (<span style="font-weight: bold; font-style: italic;">a</span> : 'D(0 Va |- [0 A1 ~&gt; A2 ]0 )0 %sol ),
         codomDeClass_prefixDeClassifying_Sol (iterDeClassifyingSol (V_dft:=V_dft) vs
         ( va o&gt;| 'clfy o&gt;Mod a )%sol) .

    <span style="font-weight: bold;">Inductive</span> <span style="font-weight: bold;">prefixDeClassifying_Sol</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} : 
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod),
      'Mod(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 % sol -&gt; <span style="font-weight: bold; text-decoration: underline;">Type</span> :=

    | UnitMod : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) {<span style="font-weight: bold; font-style: italic;">A</span> : obMod} (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V |- log.-I )0),
        prefixDeClassifying_Sol (v o&gt;| @uMod ('D0| A) )%sol

    | UnitDeClass :
        <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obMod) (<span style="font-weight: bold; font-style: italic;">A'</span> : obMod) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log)
          (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W' |- (0 W &amp; log.-I)0 )0) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 W |- [0 A ~&gt; A' ]0 )0 %sol),
          prefixDeClassifying_Sol (v o&gt;| 'D1| a)%sol

    | Classifying : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0)
                      (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol),
        prefixDeClassifying_Sol (v o&gt;| 'clfy o&gt;Mod a)%sol 

    | CodomDeClass_prefixDeClassifying_Sol :
        <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) 
        (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 'D0| A1 ~&gt; 'D0| A2 ]0 )0 % sol),
          @codomDeClass_prefixDeClassifying_Sol log V A1 A2 a
          -&gt; prefixDeClassifying_Sol a .

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">prefixP0</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
          (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 'D0| A1 ~&gt; 'D0| A2 ]0 )0 % sol) :
      codomDeClass_prefixDeClassifying_Sol a.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">elim</span> : V A1 A2 a / (Destruct_domCodomDeClass.Mod00_domCodomDeClassP a). 
      - <span style="text-decoration: underline;">move</span> =&gt; V A v. <span style="font-weight: bold;">About</span> IterDeClassifying_UnitMod.
        <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_UnitMod (V_dft:=V) (Vs:=[::]) A HNil v).
      - <span style="text-decoration: underline;">move</span> =&gt; A A' W W' v a.
        <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_UnitDeClass (V_dft:=W') (Vs:=[::]) HNil v a).
      - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a.
        <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_Classifying (V_dft:=V') (Vs:=[::]) HNil v a).
      - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">a_domCodom</span><span style="font-weight: bold; font-style: italic;">*)</span> _ IH_a_domCodom.
        <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">Set Printing Implicit.(**) Show.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>
        <span style="text-decoration: underline;">move</span>: V' v. <span style="text-decoration: underline;">case</span>: V A1 A2 a / IH_a_domCodom.
        + <span style="text-decoration: underline;">move</span> =&gt; V_dft A [ | V0 Vs'] vs;
                   [ <span style="text-decoration: underline;">rewrite</span> (hlist_eta vs) /= | ];
                   <span style="text-decoration: underline;">move</span> =&gt; va V' v.
          <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_UnitMod (V_dft:=V_dft)
                 (Vs:=[:: V' ; (head V_dft [::])]) A
         ((<span style="font-weight: bold; font-style: italic;">v</span> : toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z) (V', (head V_dft [::])) ) ::: HNil) va).
          <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_UnitMod (V_dft:=V_dft)
                 (Vs:=[:: V', V0 &amp; Vs']) A
         ((<span style="font-weight: bold; font-style: italic;">v</span> : toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z) 
                        (V', (head V_dft [:: V0 &amp; Vs'])) ) ::: vs) va).
        + <span style="text-decoration: underline;">move</span> =&gt; V_dft A A' [ | V0 Vs'] vs;
                   [ <span style="text-decoration: underline;">rewrite</span> (hlist_eta vs) /= | ];
                   <span style="text-decoration: underline;">move</span> =&gt; Va va a V' v.
          <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_UnitDeClass (V_dft:=V_dft)
                 (Vs:=[:: V' ; (head V_dft [::])])
         ((<span style="font-weight: bold; font-style: italic;">v</span> : toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z) (V', (head V_dft [::])) ) ::: HNil) va a).
          <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_UnitDeClass (V_dft:=V_dft)
                 (Vs:=[:: V', V0 &amp; Vs'])
                 ((<span style="font-weight: bold; font-style: italic;">v</span> : toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z) 
                                (V', (head V_dft [:: V0 &amp; Vs'])) ) ::: vs) va a).
        + <span style="text-decoration: underline;">move</span> =&gt; V_dft A1 A2 [ | V0 Vs'] vs;
                   [ <span style="text-decoration: underline;">rewrite</span> (hlist_eta vs) /= | ];
                   <span style="text-decoration: underline;">move</span> =&gt; Va va a V' v.
          <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_Classifying (V_dft:=V_dft)
                 (Vs:=[:: V' ; (head V_dft [::])])
         ((<span style="font-weight: bold; font-style: italic;">v</span> : toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z) (V', (head V_dft [::])) ) ::: HNil) va a).
          <span style="text-decoration: underline;">eapply</span> (IterDeClassifying_Classifying (V_dft:=V_dft)
                 (Vs:=[:: V', V0 &amp; Vs'])
                 ((<span style="font-weight: bold; font-style: italic;">v</span> : toArrowV (trf:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">z</span> =&gt; z) 
                                (V', (head V_dft [:: V0 &amp; Vs'])) ) ::: vs) va a).
    <span style="font-weight: bold;">Defined</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">prefixP</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod)
          (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 'D0| A1 ~&gt; A2 ]0 )0 % sol) :
      prefixDeClassifying_Sol a.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">elim</span> : V A1 A2 a / (Destruct_domDeClass.Mod00_domDeClassP a). 
      - <span style="text-decoration: underline;">constructor</span> 1.
      - <span style="text-decoration: underline;">constructor</span> 2.
      - <span style="text-decoration: underline;">constructor</span> 3.
      - <span style="text-decoration: underline;">move</span> =&gt; V V' A1 A2 v a. <span style="text-decoration: underline;">constructor</span> 4. 
        <span style="text-decoration: underline;">apply</span>: Destruct_iterDeClassifying.prefixP0.
    <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Destruct_iterDeClassifying</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Sol</span>.
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org197d6a2" class="outline-2">
<h2 id="org197d6a2"><span class="section-number-2">6</span> Resolution</h2>
<div class="outline-text-2" id="text-6">
<p>
Any morphism is or may be reduced to some solution morphism. Memo that this resolution
is non-congruent which is that it is total / global cut elimination /
desintegration. Oneself may later attempt to program the congruent-resolution
technique such to get specifications for computational reflection and confluence and
decidability &#x2026;
</p>

<p>
This deduction is mostly-automated via these tactics which are inquired many times :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Ltac</span> <span style="font-weight: bold;">tac_degrade</span> H_gradeTotal a_Sol_prop a'Sol_prop :=
  <span style="text-decoration: underline;">destruct</span> a_Sol_prop <span style="font-weight: bold; text-decoration: underline;">as</span> [a_Sol_prop |a_Sol_prop];
  [ <span style="text-decoration: underline;">move</span> : (Red.degrade a_Sol_prop);
    <span style="text-decoration: underline;">destruct</span> a'Sol_prop <span style="font-weight: bold; text-decoration: underline;">as</span> [a'Sol_prop |a'Sol_prop];
    [ <span style="text-decoration: underline;">move</span> : (Red.degrade a'Sol_prop)
    | <span style="text-decoration: underline;">subst</span> ]
  | <span style="text-decoration: underline;">subst</span>;
    <span style="text-decoration: underline;">destruct</span> a'Sol_prop <span style="font-weight: bold; text-decoration: underline;">as</span> [a'Sol_prop |a'Sol_prop];
    [ <span style="text-decoration: underline;">move</span> : (Red.degrade a'Sol_prop)
    | <span style="text-decoration: underline;">subst</span> ]
  ];
  <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>; <span style="text-decoration: underline;">rewrite</span> /gradeTotal /= ;
  repeat <span style="text-decoration: underline;">rewrite</span> Sol.toMod_iterDeClassifyingSol /= ;
  repeat <span style="text-decoration: underline;">rewrite</span> !(grade_iterDeClassifying,
                   gradeCom_iterDeClassifying,
                   gradeDeClass_iterDeClassifying) /= ;
  <span style="text-decoration: underline;">move</span> =&gt; * ; abstract <span style="text-decoration: underline;">intuition</span> Omega.omega.

<span style="font-weight: bold;">Ltac</span> <span style="font-weight: bold;">tac_reduce</span> :=
  <span style="text-decoration: underline;">simpl</span> <span style="font-weight: bold; text-decoration: underline;">in</span> *; abstract (
  <span style="text-decoration: underline;">intuition</span> (<span style="text-decoration: underline;">eauto</span> <span style="font-weight: bold; text-decoration: underline;">with</span> iter_hints; try <span style="text-decoration: underline;">subst</span>; rewriterMod; try congruence;
                             <span style="text-decoration: underline;">eauto</span> 12 <span style="font-weight: bold; text-decoration: underline;">with</span> iter_hints)).

<span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Section1</span>.

<span style="font-weight: bold;">Import</span> Sol.Ex_Notations.
<span style="font-weight: bold;">Import</span> Red.Ex_Notations.
Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.
</pre>
</div>

<p>
Finally :
</p>

<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Fixpoint</span> <span style="font-weight: bold;">solveMod</span> len {<span style="font-weight: bold; text-decoration: underline;">struct</span> len} :
  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obMod) (<span style="font-weight: bold; font-style: italic;">a</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0)
    (<span style="font-weight: bold; font-style: italic;">H_gradeTotal</span> : (gradeTotal a &lt;= len)%coq_nat),
    { <span style="font-weight: bold; font-style: italic;">aSol</span> : 'Mod(0 V |- [0 A1 ~&gt; A2 ]0 )0 %sol
    | ( (Sol.toMod aSol) &lt;~~ a ) \/ ( (Sol.toMod aSol) = a ) }.
<span style="font-weight: bold;">Proof</span>.
  <span style="text-decoration: underline;">case</span> : len =&gt; [ | len ].

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">n is O </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">clear</span>; ( <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a H_gradeTotal ); <span style="text-decoration: underline;">exfalso</span>;
      <span style="text-decoration: underline;">move</span> : (Red.degradeTotal_gt0 a) =&gt; H_degradeTotal_gt0; abstract Omega.omega.

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">n is (S n) </span><span style="font-weight: bold; font-style: italic;">*)</span>
  - <span style="text-decoration: underline;">move</span> =&gt; V A1 A2 a; <span style="text-decoration: underline;">case</span> : V A1 A2 / a =&gt;
    [ V V' v A1 A2 a <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;' a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V V' A1 A2 aGen v <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| #1| aGen </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V A v <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| @uMod A </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V A2 A1 a_ A1' W WV wv a' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">wv o&gt;| a_ o&gt;Mod a' </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | A A' W W' v a <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| 'D1| a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V B A b A' W WV wv a <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">wv o&gt;| b o&gt;D a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V V' A1 A2 v a <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| 'clfy o&gt;Mod a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    | V V' A1 A2 v a <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| a o&gt;Mod 'dlclfy </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is v o&gt;' a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">rewrite</span> -/(v o&gt;' a) =&gt; H_gradeTotal.
      <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a) =&gt;
      [ | aSol aSol_prop ].
      * <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>;
          <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; abstract Omega.omega.
      * { <span style="text-decoration: underline;">destruct</span> aSol <span style="font-weight: bold; text-decoration: underline;">as</span> [ <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">V A1 A2 aGenAtom</span><span style="font-weight: bold; font-style: italic;">*)</span>
                      _ _ _ [ V _V' A1 A2 aGen _v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| #1| aGen)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                               | V A2 A1 a_GenAtom A1' W WV wv a'GenAtom
                                   <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(wv o&gt;| a_GenAtom o&gt;Mod a'GenAtom)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                               ]
                       | V A _v <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| @uMod A)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                       | A A' W W' _v aSol   <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| 'D1| aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                       | V _V' A1 A2 _v aSol  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| 'clfy o&gt;Mod aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                       | V _V' A1 A2 _v aSol  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| aSol o&gt;Mod 'declfy)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a to v o&gt;' (_v o&gt;| #1| aGen)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> ( (v o&gt; _v) o&gt;| #1| aGen )%sol.
            <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a to v o&gt;' (wv o&gt;| a_GenAtom o&gt;Mod a'GenAtom)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> ( (v o&gt; wv) o&gt;| a_GenAtom o&gt;Mod a'GenAtom )%sol .
            <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.
           <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">clear -aSol_prop.(**)</span>
<span style="font-weight: bold; font-style: italic;">           simpl in *; abstract (</span>
<span style="font-weight: bold; font-style: italic;">           intuition (eauto; try subst; rewriterMod; try congruence; try (transitivity</span>
<span style="font-weight: bold; font-style: italic;">           ((v o&gt;' wv) o&gt;| (Sol.toMod_gen a_GenAtom) o&gt;Mod (Sol.toMod_gen a'GenAtom));</span>
<span style="font-weight: bold; font-style: italic;">           eauto); eauto 12)).(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a to v o&gt;' (_v o&gt;| @uMod A)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> ( (v o&gt; _v) o&gt;| uMod )%sol.
            <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a to v o&gt;' (_v o&gt;| 'D1| aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> ( (v o&gt; _v) o&gt;| 'D1| aSol )%sol.
            <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a to v o&gt;' (_v o&gt;| 'clfy o&gt;Mod aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> ( (v o&gt; _v) o&gt;| 'clfy o&gt;Mod aSol )%sol.
            <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a to v o&gt;' (_v o&gt;| aSol o&gt;Mod 'declfy)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> ( (v o&gt; _v) o&gt;| aSol o&gt;Mod 'declfy )%sol.
            <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.
            <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">move : aSol_prop; clear;</span>
<span style="font-weight: bold; font-style: italic;">              case =&gt; aSol_prop;</span>
<span style="font-weight: bold; font-style: italic;">              first by left; </span>
<span style="font-weight: bold; font-style: italic;">              transitivity (v o&gt;' (Sol.toMod ( _v o&gt;| aSol o&gt;Mod 'declfy )%sol));</span>
<span style="font-weight: bold; font-style: italic;">                         [ apply: Red.DeClassifying_arrowLog |</span>
<span style="font-weight: bold; font-style: italic;">                           apply: Red.PolyV_Mod_cong; [apply: ReflV | ] ].(**)</span>
<span style="font-weight: bold; font-style: italic;">              by left; rewrite -aSol_prop; apply: Red.DeClassifying_arrowLog.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>
        }

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is v o&gt;| #1| aGen </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">move</span> =&gt; H_gradeTotal. <span style="text-decoration: underline;">exists</span> (v o&gt;| #1| aGen)%sol. <span style="text-decoration: underline;">right</span>. reflexivity.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is v o&gt;| @uMod A </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">move</span> =&gt; H_gradeTotal. <span style="text-decoration: underline;">exists</span> (v o&gt;| uMod)%sol. <span style="text-decoration: underline;">right</span>. reflexivity.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is wv o&gt;| a_ o&gt;Mod a' </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">rewrite</span> -/(wv o&gt;| a_ o&gt;Mod a') =&gt; H_gradeTotal. all: cycle 1. 

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is v o&gt;| 'D1| a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">move</span> =&gt; H_gradeTotal.
      <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a) =&gt;
      [ | aSol aSol_prop ].
      * <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>;
          <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; abstract Omega.omega.
      * <span style="text-decoration: underline;">exists</span> (v o&gt;| 'D1| aSol)%sol.
        <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is wv o&gt;| b o&gt;D a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">rewrite</span> -/(wv o&gt;| b o&gt;D a) =&gt; H_gradeTotal. all: cycle 1. 

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is v o&gt;| 'clfy o&gt;Mod a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">move</span> =&gt; H_gradeTotal.
      <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a) =&gt;
      [ | aSol aSol_prop ].
      * <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>;
          <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; abstract Omega.omega.
      * <span style="text-decoration: underline;">exists</span> (v o&gt;| 'clfy o&gt;Mod aSol)%sol.
        <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is v o&gt;| a o&gt;Mod 'declfy </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">move</span> =&gt; H_gradeTotal.
      <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a) =&gt;
      [ | aSol aSol_prop ].
      * <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>; <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; abstract Omega.omega.
      * <span style="text-decoration: underline;">exists</span> (v o&gt;| aSol o&gt;Mod 'declfy)%sol.
        <span style="text-decoration: underline;">clear</span> -aSol_prop. tac_reduce.
        <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">move : aSol_prop; clear;</span>
<span style="font-weight: bold; font-style: italic;">          case =&gt; aSol_prop;</span>
<span style="font-weight: bold; font-style: italic;">                   first by left; apply: Red.DeClassifying_cong; [apply: ReflV |].(**)</span>
<span style="font-weight: bold; font-style: italic;">          by right; rewrite -aSol_prop.(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a_) =&gt;
      [ | a_Sol a_Sol_prop ];
        [ <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>;
          <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; abstract Omega.omega | ].
      <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a') =&gt;
      [ | a'Sol a'Sol_prop ];
        [ <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>;
          <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; abstract Omega.omega | ].

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">destruct</span> a_Sol <span style="font-weight: bold; text-decoration: underline;">as</span>
          [ V A1 A2 a_GenAtom  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a_GenAtom : ('Mod(0 _ |- [0 _ ~&gt; _ ]0 )0 %sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | V A v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| @uMod A)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | A A' _W W' v a_Sol'   <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| 'D1| aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | V V' A1 A2 v a_Sol'  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| 'clfy o&gt;Mod aSol)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | V V' A1 A2 v a_Sol'  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| aSol o&gt;Mod 'declfy)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (a_GenAtom) o&gt;Mod a'Sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="text-decoration: underline;">clear</span> - solveMod H_gradeTotal a_Sol_prop a'Sol_prop.
          <span style="text-decoration: underline;">move</span>: (Sol.Destruct_domGen.Mod00_domGenP a'Sol) =&gt; a'Sol_domGenP.
          <span style="text-decoration: underline;">destruct</span> a'Sol_domGenP <span style="font-weight: bold; text-decoration: underline;">as</span>
           [ _V _A1 A2 a'GenAtom  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a'GenAtom : ('Mod(0 _ |- [0 _ ~&gt; _ ]0 )0 %sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
           | _V A v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| @uMod A)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
           | _V V' _A1 A2 v a'Sol'  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(v o&gt;| a'Sol o&gt;Mod 'declfy)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (a_GenAtom) o&gt;Mod a'Sol) , </span>
<span style="font-weight: bold; font-style: italic;">          is  (wv o&gt;| (a_GenAtom) o&gt;Mod a'GenAtom)  </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">exists</span> (wv o&gt;| a_GenAtom o&gt;Mod a'GenAtom)%sol.
            <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop. tac_reduce.
              <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">intuition (simpl; eauto; try subst; try congruence;</span>
<span style="font-weight: bold; font-style: italic;">                  try transitivity (wv o&gt;| (Sol.toMod a_GenAtom) o&gt;Mod a');</span>
<span style="font-weight: bold; font-style: italic;">                  simpl; eauto 12).</span><span style="font-weight: bold; font-style: italic;">*)</span>

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (a_GenAtom) o&gt;Mod a'Sol) , </span>
<span style="font-weight: bold; font-style: italic;">          is  (wv o&gt;| (a_GenAtom) o&gt;Mod (v o&gt;| uMod))  </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">destruct</span> a_GenAtom <span style="font-weight: bold; text-decoration: underline;">as</span>
                [ V V' A1 A2 a_Gen _v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| #1| a_Gen)%sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                | V A2 A1 a_GenAtom_ A1' W _WV _v a_GenAtom'  
                                <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(_v o&gt;| a_GenAtom_ o&gt;Mod a'GenAtom')%sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

            <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">            is (wv o&gt;| (a_GenAtom) o&gt;Mod a'Sol) , </span>
<span style="font-weight: bold; font-style: italic;">            is  (wv o&gt;| (_v o&gt;| #1| a_Gen) o&gt;Mod (v o&gt;| uMod))  </span><span style="font-weight: bold; font-style: italic;">*)</span>
            + <span style="text-decoration: underline;">exists</span> ( ( ( (wv o&gt; log.-(1 v &amp; _ )0 o&gt; desIdenObLK) o&gt; _v )
                      o&gt;| #1| a_Gen)%sol ) .
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop. tac_reduce.
              <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">intuition (simpl; eauto; try subst; try congruence;</span>
<span style="font-weight: bold; font-style: italic;">                    try transitivity (wv o&gt;| (Sol.toMod (p o&gt;| #1| m)%sol) o&gt;Mod a');</span>
<span style="font-weight: bold; font-style: italic;">                    try intuition (simpl; eauto; transitivity </span>
<span style="font-weight: bold; font-style: italic;">                                   (wv o&gt;| (Sol.toMod (p o&gt;| #1| m)%sol) </span>
<span style="font-weight: bold; font-style: italic;">                                   o&gt;Mod Sol.toMod (_v o&gt;| uMod)%sol); simpl; eauto );</span>
<span style="font-weight: bold; font-style: italic;">                         simpl; eauto 12).</span><span style="font-weight: bold; font-style: italic;">*)</span>

            <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">            is (wv o&gt;| (a_GenAtom) o&gt;Mod a'Sol) , </span>
<span style="font-weight: bold; font-style: italic;">            is  (wv o&gt;| (_v o&gt;| a_GenAtom_ o&gt;Mod a_GenAtom') o&gt;Mod (v o&gt;| uMod))  </span><span style="font-weight: bold; font-style: italic;">*)</span>
            + <span style="text-decoration: underline;">exists</span> ( ( ( (wv o&gt; log.-(1 v &amp; _ )0 o&gt; desIdenObLK) o&gt; _v )
                      o&gt;| a_GenAtom_ o&gt;Mod a_GenAtom')%sol ) .
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop. tac_reduce.
              <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">intuition (simpl; eauto; try subst; try congruence;</span>
<span style="font-weight: bold; font-style: italic;">                     try transitivity (wv o&gt;| (Sol.toMod (p o&gt;| #1| m)%sol) o&gt;Mod a');</span>
<span style="font-weight: bold; font-style: italic;">                     try intuition (simpl; eauto; transitivity (wv o&gt;| </span>
<span style="font-weight: bold; font-style: italic;">                                   (Sol.toMod (p o&gt;| a_GenAtom1 o&gt;Mod a_GenAtom2)%sol) </span>
<span style="font-weight: bold; font-style: italic;">                                   o&gt;Mod Sol.toMod (_v o&gt;| uMod)%sol); simpl; eauto );</span>
<span style="font-weight: bold; font-style: italic;">                                   simpl; eauto 12).(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (a_GenAtom) o&gt;Mod a'Sol) , </span>
<span style="font-weight: bold; font-style: italic;">          is  (wv o&gt;| (a_GenAtom) o&gt;Mod ((v o&gt;| a'Sol' o&gt;Mod 'declfy))  </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ ((wv o&gt; log.-(1 v &amp; _ )0)
                      o&gt;| (Sol.toMod a_GenAtom) o&gt;Mod (Sol.toMod a'Sol'))) =&gt;
            [ | a_o_a'Sol a_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> ( (log.-1) o&gt;| a_o_a'Sol o&gt;Mod 'declfy )%sol .
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_o_a'Sol_prop. tac_reduce.
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| uMod ) o&gt;Mod a'Sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">case</span> : (solveMod len _ _ _ ((wv o&gt; log.-(0 _ &amp; v)1 o&gt; desIdenObRK)
                                        o&gt;' (Sol.toMod a'Sol))) =&gt;
          [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
          - tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
          - <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
            <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.
            <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">clear -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop;</span>
<span style="font-weight: bold; font-style: italic;">            simpl in *;</span>
<span style="font-weight: bold; font-style: italic;">              intuition (eauto; try subst; rewriter; try congruence; try (transitivity</span>
<span style="font-weight: bold; font-style: italic;">              ((wv o&gt; log.-(0 _ &amp; v)1 o&gt; desIdenObRK) o&gt;' (Sol.toMod a'Sol));</span>
<span style="font-weight: bold; font-style: italic;">              eauto); eauto 12).(**) </span><span style="font-weight: bold; font-style: italic;">*)</span>
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod a'Sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">move</span>: (Sol.Destruct_domDeClass.Mod00_domDeClassP a'Sol) =&gt; a'Sol_domDeClassP.
          <span style="text-decoration: underline;">destruct</span> a'Sol_domDeClassP <span style="font-weight: bold; text-decoration: underline;">as</span>
              [ V _A _v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| @uMod _A %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | _A A' W _W' _v a'Sol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| 'D1| a'Sol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | V V' A1 A2 _v a'Sol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| 'clfy o&gt;Mod a'Sol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | V V' A1 A2 _v a'Sol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| a'Sol' o&gt;Mod 'declfy %sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod (_v o&gt;| @uMod _A)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ ((wv o&gt; log.-(1 _v &amp; _ )0 o&gt; desIdenObLK)
                                        o&gt;' (Sol.toMod (v o&gt;| 'D1| a_Sol')%sol))) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod (_v o&gt;| 'D1| a'Sol')) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ (wv o&gt;| (Sol.toMod (v o&gt;| 'D1| a_Sol')%sol)
                                o&gt;D ((_v o&gt;desIdenObRK) o&gt;' (Sol.toMod a'Sol')))) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod (_v o&gt;| 'clfy o&gt;Mod a'Sol')) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
            ((log.-1) o&gt;| 
                       'clfy o&gt;Mod (wv o&gt;| ((v o&gt; desIdenObRK) o&gt;' (Sol.toMod a_Sol'))
                                          o&gt;Mod (_v o&gt;' (Sol.toMod a'Sol'))))) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| 'D1| a_Sol') o&gt;Mod (_v o&gt;| a'Sol' o&gt;Mod 'declfy)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
            ((log.-1) o&gt;| ((wv o&gt; (1 _v &amp; _ )0) o&gt;| 
                                          (Sol.toMod (v o&gt;| 'D1| a_Sol')%sol)
                                          o&gt;Mod (Sol.toMod a'Sol')) o&gt;Mod 'declfy)) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| 'clfy o&gt;Mod a_Sol') o&gt;Mod a'Sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">case</span> : (solveMod len _ _ _
               ((log.-1) o&gt;| 'clfy o&gt;Mod ((wv o&gt; (0 _ &amp; v )1) o&gt;| (Sol.toMod a_Sol')
                                                    o&gt;Mod (Sol.toMod a'Sol)))) =&gt;
          [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
          - tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
          - <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
            <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| a_Sol' o&gt;Mod 'declfy) o&gt;Mod a'Sol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">move</span>: (Sol.Destruct_dom2DeClass.Mod00_dom2DeClassP a'Sol) 
                                                                =&gt; a'Sol_dom2DeClassP.
          <span style="text-decoration: underline;">destruct</span> a'Sol_dom2DeClassP <span style="font-weight: bold; text-decoration: underline;">as</span>
              [ _V A _v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| @uMod A %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | A A' W W' _v a'Sol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| 'D1| a'Sol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | _V _V' _A1 A2 _v a'Sol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| 'clfy o&gt;Mod a'Sol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | _V _V' _A1 A2 _v a'Sol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| a'Sol' o&gt;Mod 'declfy %sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| a_Sol' o&gt;Mod 'declfy) o&gt;Mod (_v o&gt;| @uMod A)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                             ((wv o&gt; log.-(1 _v &amp; _ )0 o&gt; desIdenObLK)
                                o&gt;' (v o&gt;| (Sol.toMod a_Sol') o&gt;Mod 'declfy))) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| a_Sol' o&gt;Mod 'declfy) o&gt;Mod (_v o&gt;| 'D1| a'Sol')) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                            (wv o&gt;| (Sol.toMod (v o&gt;| a_Sol' o&gt;Mod 'declfy)%sol)
                                o&gt;D ((_v o&gt; desIdenObRK) o&gt;' (Sol.toMod a'Sol')))) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| a_Sol' o&gt;Mod 'declfy) o&gt;Mod </span>
<span style="font-weight: bold; font-style: italic;">                                                     (_v o&gt;| 'clfy o&gt;Mod a'Sol')) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                             (wv o&gt;| (v o&gt;' (Sol.toMod a_Sol'))
                                 o&gt;Mod (_v o&gt;' (Sol.toMod a'Sol')))) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.

            <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| a_ o&gt;Mod a') , to (wv o&gt;| a_Sol o&gt;Mod a'Sol)  , </span>
<span style="font-weight: bold; font-style: italic;">            is (wv o&gt;| (v o&gt;| a_Sol' o&gt;Mod 'declfy) o&gt;Mod </span>
<span style="font-weight: bold; font-style: italic;">                                                     (_v o&gt;| a'Sol' o&gt;Mod 'declfy)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                   ((log.-1) o&gt;| ((wv o&gt; (1 _v &amp; _ )0)
                                    o&gt;| (Sol.toMod (v o&gt;| a_Sol' o&gt;Mod 'declfy)%sol)
                                    o&gt;Mod (Sol.toMod a'Sol')) o&gt;Mod 'declfy)) =&gt;
            [ | a_Sol_o_a'Sol a_Sol_o_a'Sol_prop ].
            + tac_degrade H_gradeTotal a_Sol_prop a'Sol_prop.
            + <span style="text-decoration: underline;">exists</span> (a_Sol_o_a'Sol).
              <span style="text-decoration: underline;">clear</span> -a_Sol_prop a'Sol_prop a_Sol_o_a'Sol_prop. tac_reduce.
        }

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) </span><span style="font-weight: bold; font-style: italic;">*)</span>
    + <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ b) =&gt;
      [ | bSol bSol_prop ];
        [ <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>; <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; Omega.omega 
        | ].
      <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _ a) =&gt;
      [ | aSol aSol_prop ];
        [ <span style="text-decoration: underline;">move</span> : H_gradeTotal; <span style="text-decoration: underline;">clear</span>; <span style="text-decoration: underline;">rewrite</span> /gradeTotal /=; <span style="text-decoration: underline;">move</span> =&gt; *; Omega.omega 
        | ].
      <span style="text-decoration: underline;">move</span>: (Sol.Destruct_codomDeClass.Mod00_codomDeClassP bSol) 
                                                                =&gt; bSol_codomDeClassP.
      <span style="text-decoration: underline;">destruct</span> bSol_codomDeClassP <span style="font-weight: bold; text-decoration: underline;">as</span>
          [ V A v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| @uMod A %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | A _A' _W W' v bSol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| 'D1| bSol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | V V' A1 A2 v bSol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| 'clfy o&gt;Mod bSol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
          | V V' A1 A2 v bSol' <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">v o&gt;| bSol' o&gt;Mod 'declfy %sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ].

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| @uMod A) o&gt;D aSol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">case</span> : (solveMod len _ _ _
                   ((wv o&gt; log.-(0 _ &amp; v )1) o&gt;| 'D1| (Sol.toMod aSol))) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            - tac_degrade H_gradeTotal bSol_prop aSol_prop.
            - <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">clear</span> -bSol_prop aSol_prop bSol_oD_aSol_prop. tac_reduce.
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| 'D1| bSol') o&gt;D aSol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">case</span> : (solveMod len _ _ _
                 ((wv o&gt; desIdenObRKV) o&gt;| 'D1| ((log.-1) o&gt;|
                                   ((v o&gt; desIdenObRK) o&gt;' (Sol.toMod bSol'))
                                   o&gt;Mod (Sol.toMod aSol)))) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            - tac_degrade H_gradeTotal bSol_prop aSol_prop.
            - <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">clear</span> -bSol_prop aSol_prop bSol_oD_aSol_prop. tac_reduce.
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| 'clfy o&gt;Mod bSol') o&gt;D aSol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">case</span> : (solveMod len _ _ _
            ((log.-1) o&gt;| 'clfy o&gt;Mod ((wv o&gt; (0 _ &amp; v )1) o&gt;| (Sol.toMod bSol')
                                                           o&gt;D (Sol.toMod aSol)))) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            - tac_degrade H_gradeTotal bSol_prop aSol_prop.
            - <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">clear</span> -bSol_prop aSol_prop bSol_oD_aSol_prop. tac_reduce.
        }

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">      is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D aSol) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      * { <span style="font-weight: bold; font-style: italic;">move</span>: (Sol.Destruct_iterDeClassifying.prefixP aSol) =&gt; aSol_prefixP.
          <span style="text-decoration: underline;">destruct</span> aSol_prefixP <span style="font-weight: bold; text-decoration: underline;">as</span>
              [ _V A _v  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| @uMod A %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | A A' W W' _v aSol'  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| 'D1| aSol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | _V _V' _A1 A2 _v aSol'  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">_v o&gt;| 'clfy o&gt;Mod aSol' %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
              | _ _ _ _
                  [ V_dft A Vs vs vaSol'  
                  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">vs o&gt;|| (vaSol' o&gt;| @uMod A) ''declfy %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                  | V_dft A A' Vs vs Va vaSol' aSol'  
                  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">vs o&gt;|| (vaSol' o&gt;| 'D1| aSol') ''declfy %sol </span><span style="font-weight: bold; font-style: italic;">*)</span>
                  | V_dft _A1 A2 Vs vs Va vaSol' aSol' 
                  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">vs o&gt;|| (vaSol' o&gt;| 'clfy o&gt;Mod aSol') ''declfy %sol </span><span style="font-weight: bold; font-style: italic;">*)</span> ] ].

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D (_v o&gt;| @uMod A)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                             ((wv o&gt; log.-(1 _v &amp; _ )0 o&gt; desIdenObLK)
                                o&gt;' (v o&gt;| (Sol.toMod bSol') o&gt;Mod 'declfy))) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            + tac_degrade H_gradeTotal bSol_prop aSol_prop.
            + <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">clear</span> -bSol_prop aSol_prop bSol_oD_aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D (_v o&gt;| 'D1| aSol')) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                    ((log.-1) o&gt;| (wv o&gt;| (v o&gt;' (Sol.toMod bSol'))
                                    o&gt;D ((_v o&gt; desIdenObRK) o&gt;' (Sol.toMod aSol')))
                              o&gt;Mod 'declfy)) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            + tac_degrade H_gradeTotal bSol_prop aSol_prop.
            + <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">clear</span> -bSol_prop aSol_prop bSol_oD_aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D (_v o&gt;| 'clfy o&gt;Mod aSol')) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                (wv o&gt;| (v o&gt;' (Sol.toMod bSol')) o&gt;D (_v o&gt;' (Sol.toMod aSol')))) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            + tac_degrade H_gradeTotal bSol_prop aSol_prop.
            + <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">clear</span> -bSol_prop aSol_prop bSol_oD_aSol_prop. tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) </span>
<span style="font-weight: bold; font-style: italic;">                                o&gt;D (vs o&gt;|| (vaSol' o&gt;| uMod) o&gt;Mod ''declfy)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                    (wv o&gt;| (hmap (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U1U2 u</span> =&gt; ((1 u &amp; _ )0)) vs o&gt;|| 
                        ((log.-(1 vaSol' &amp; _ )0 o&gt; (0 log.-I &amp; v )1 o&gt; desIdenObLK) 
                        o&gt;' (Sol.toMod bSol'))
                                                  o&gt;Mod ''declfy) o&gt;Mod 'declfy)) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            + tac_degrade H_gradeTotal bSol_prop aSol_prop.

            + <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">move</span>: bSol_prop aSol_prop bSol_oD_aSol_prop ; <span style="text-decoration: underline;">clear</span>.
              <span style="text-decoration: underline;">simpl</span>; repeat <span style="text-decoration: underline;">rewrite</span> Sol.toMod_iterDeClassifyingSol /= . tac_reduce.

          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                    (wv o&gt;| (hmap (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U1U2 u</span> =&gt; ((1 u &amp; _)0)) vs o&gt;|| 
                                ((log.-(1 vaSol' o&gt; desIdenObRK &amp; _ )0 o&gt; (0 _ &amp; v )1)
                                 o&gt;| (Sol.toMod bSol') o&gt;D (Sol.toMod aSol'))
                                                  o&gt;Mod ''declfy) o&gt;Mod 'declfy)) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            + tac_degrade H_gradeTotal bSol_prop aSol_prop.
            + <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">move</span>: bSol_prop aSol_prop bSol_oD_aSol_prop ; <span style="text-decoration: underline;">clear</span>.
              <span style="text-decoration: underline;">simpl</span>; repeat <span style="text-decoration: underline;">rewrite</span> Sol.toMod_iterDeClassifyingSol /= . tac_reduce.

          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a is (wv o&gt;| b o&gt;D a) , to (wv o&gt;| bSol o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D aSol)  , </span>
<span style="font-weight: bold; font-style: italic;">          is (wv o&gt;| (v o&gt;| bSol' o&gt;Mod 'declfy) o&gt;D </span>
<span style="font-weight: bold; font-style: italic;">                        (vs o&gt;|| (vaSol' o&gt;| 'clfy o&gt;Mod aSol') o&gt;Mod ''declfy)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
          - <span style="text-decoration: underline;">case</span> : (solveMod len _ _ _
                (wv o&gt;| (v o&gt;' (Sol.toMod bSol'))
                    o&gt;D (vs o&gt;|| ( vaSol' o&gt;' (Sol.toMod aSol')) o&gt;Mod ''declfy))) =&gt;
            [ | bSol_oD_aSol bSol_oD_aSol_prop ].
            + tac_degrade H_gradeTotal bSol_prop aSol_prop.
            + <span style="text-decoration: underline;">exists</span> (bSol_oD_aSol).
              <span style="text-decoration: underline;">move</span>: bSol_prop aSol_prop bSol_oD_aSol_prop ; <span style="text-decoration: underline;">clear</span>.
              <span style="text-decoration: underline;">simpl</span>; repeat <span style="text-decoration: underline;">rewrite</span> Sol.toMod_iterDeClassifyingSol /= . tac_reduce.
        }

<span style="font-weight: bold;">Defined</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Section1</span>.

<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">COPARAM</span>.
</pre>
</div>

<p>
Voila.
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
<code>1337777.OOO</code>
<a href="https://github.com/1337777/laozi/blob/master/ocic03-what-is-normal.djvu">https://github.com/1337777/laozi/blob/master/ocic03-what-is-normal.djvu</a>
</p></div></div>


</div>
</div></div>
</body>
</html>
