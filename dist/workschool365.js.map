{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/taskpane/workschool365.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","tryCatch","callback","console","error","el","Word","run","context","document","getSelection","insertParagraph","textContent","replace","trim","select","sync","keyRot","text","reverse","String","fromCharCode","apply","split","map","v","rot","length","charCodeAt","signedGrade","test","Office","url","self","location","tokenizeSolution","str","toLowerCase","anonGrade","foundRanges","contentControls","getByTag","load","solutionCC","pp","DOMParser","xmlDoc","parseFromString","items","title","id","toString","xmlDocResultsEl","evaluate","XPathResult","ANY_TYPE","iterateNext","childNodes","forEach","parent","valueID","nodeValue","valueContent","questionCC","filter","it","okko","cc","InsertLocation","after","insertContentControl","cannotEdit","cannotDelete","appearance","ContentControlAppearance","tags","color","font","highlightColor","tag","err","formatCC","pccc","codelang","docEl","createElement","platform","PlatformType","PC","valRtext","op","join","innerHTML","hljs","highlight","substr","body","getElementsByClassName","appendChild","computedStyleToInlineStyle","recursive","properties","insertHtml","styleBuiltIn","jk","clear","j","removeChild","reFormatSelected","documentgetSelection","searchResults","isEmpty","match","clearTags","tagName","processTags","search","matchWildcards","ccweight","cctitle","fetchResponse","fetchBodys","patt","RegExp","getElementsByTagName","getByTitle","paragraphs","getLast","hidden","parentNode","fetch","pattj","array1","exec","end","undefined","insertText","hasChildNodes","log","getElementById","onclick","querySelectorAll","addEventListener","docTags","onReady","info","host","HostType"],"mappings":"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","file":"workschool365.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 309);\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n\n/* global console, document, Excel, Office */\n\n\n\ndocument.getElementById('process-tags').onclick = (() => tryCatch(processTags));\ndocument.getElementById('reformat-code').onclick = (() => tryCatch(reFormatSelected));\ndocument.getElementById('clear-output').onclick = (() => tryCatch(() => clearTags('ws365_code_output')));\ndocument.getElementById('clear-quiz').onclick = (() => tryCatch(() => clearTags('ws365_quiz')));\ndocument.getElementById('coq-taskpane').onclick = (() => { self.location = \"./taskpane.html?et=\"; });\ndocument.getElementById(\"anon-user\").onclick = (() => tryCatch(anonGrade));\ndocument.getElementById(\"signed-in-user\").onclick = (() => tryCatch(signedGrade));\ndocument.querySelectorAll(\".doc-tags\").forEach(function (el) {\n  el.addEventListener('click', (() => tryCatch(() => docTags(el))))\n});\n\nOffice.onReady(info => {\n\n  if (info.host === Office.HostType.Word) {\n\n    Word.run(async context => {\n\n\n    });\n  }\n\n});\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n  try {\n    await callback();\n  } catch (error) {\n    // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\n    console.error(error);\n  }\n}\n\nasync function docTags(el) {\n  Word.run(async context => {\n    var par = context.document.getSelection().insertParagraph(el.textContent.replace(/\\s+/g, ' ').replace('/> </', '><').trim(), \"After\");\n    par.select();\n    await context.sync();\n  })\n}\n\nfunction keyRot(text, key, reverse) {\n  var bound = 0x10000;\n  return String.fromCharCode.apply(null,\n    text.split('').map(function (v, i) {\n      var rot = key[i % key.length].charCodeAt();\n      if (reverse) rot = -rot;\n      return (v.charCodeAt() + rot + bound) % bound;\n    })\n  );\n};\n\nasync function signedGrade() {\n  if (/[/][/].*[.]sharepoint[.]com.*/i.test(Office.context.document.url)) {\n    self.location = Office.context.document.url.replace(/(.*)[/][^/]*$/i, '$1');\n  }\n  else {\n    self.location = \"https://anthroplogic.com\";\n  }\n}\n\nfunction tokenizeSolution(str) {\n\n  return str.replace(/[`~!@#$%^&*()-=+[{\\]}\\\\|;:'\"‘’“”,.<>/?]/g, ' ').replace(/[\\n\\s]+/g, ' ').trim().toLowerCase();\n}\n\nasync function anonGrade() {\n\n  Word.run(async context => {\n\n    var foundRanges = context.document.contentControls.getByTag('ws365_quiz');\n    foundRanges.load(['length', 'items', 'text', 'title']);\n    var solutionCC = context.document.contentControls.getByTag('ws365_solutions');\n    solutionCC.load(['length', 'items', 'text', 'title']);\n    await context.sync();\n\n    var cc, okko;\n    var pp = new DOMParser();\n    var xmlDoc = pp.parseFromString(keyRot(solutionCC.items[0].title, solutionCC.items[0].id.toString(), true), \"text/xml\");\n\n    var xmlDocResultsEl = xmlDoc.evaluate('/solutions[1]', xmlDoc, null, XPathResult.ANY_TYPE, null).iterateNext();\n    if (xmlDocResultsEl != null) {\n\n      xmlDocResultsEl.childNodes.forEach((value, key, parent) => {\n        try {\n          var valueID = xmlDoc.evaluate('id', value, null, XPathResult.ANY_TYPE, null).iterateNext().childNodes[0].nodeValue.trim();\n\n          var valueContent = xmlDoc.evaluate('content', value, null, XPathResult.ANY_TYPE, null).iterateNext().childNodes[0].nodeValue;\n          var questionCC = foundRanges.items.filter(it =>\n            it.title.split('/')[0].split(';')[0].trim() == valueID);\n\n          if (questionCC.length == 0) {\n            okko = false;\n            cc = solutionCC.items[0].insertParagraph(okko ? \"OK\" : \"KO\", Word.InsertLocation.after).insertContentControl();\n          } else {\n            okko = (tokenizeSolution(questionCC[0].text) == tokenizeSolution(valueContent));\n            cc = questionCC[0].insertParagraph(okko ? \"OK\" : \"KO\", Word.InsertLocation.after).insertContentControl();\n          }\n          cc.cannotEdit = true;\n          cc.cannotDelete = true;\n          cc.appearance = Word.ContentControlAppearance.tags;\n          cc.color = okko ? \"green\" : \"red\";\n          cc.font.highlightColor = okko ? \"green\" : \"red\";\n          cc.font.color = \"white\";\n          cc.tag = \"ws365_grade\";\n          cc.title = \" \" + valueID + \" / grade \";\n        } catch (err) { console.error(err) };\n      });\n      await context.sync();\n    }\n  });\n}\n\n\n\nasync function formatCC(context, pccc, codelang) {\n  let docEl = document.createElement(\"PRE\");\n\n  if (Office.context.platform == Office.PlatformType.PC) {\n    /* pccc.load('text');\n    await context.sync(); */\n    var valRtext = pccc.split([\"\\n\"], false, false); //.getTextRanges([\"\\n\", \"\\u000B\"], false) //.split([\"\\n\"], false, false); // getTextRanges([], false);          \n    valRtext.load(['items', 'text']);\n    await context.sync();\n    // coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    let op = valRtext.items.map(i => i.text).join('');\n\n    docEl.innerHTML = hljs.highlight(codelang, op.substr(0, op.length)).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    //docEl.style = \"font-family: consolas; color: yellow\";\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    //pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p> </p>').replace( /<[/]p>\\n/g , '</p><p> </p>').replace(/\\n/g, '<p/>').replace(/  /g, '  ') + '</pre>', \"Replace\");\n    pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '\\r\\n') + '\\r\\n</pre>', \"Replace\");\n    //pccc.insertHtml('<pre>' + docEl.innerHTML/* .replace(/\\u000B/g, '\\n') */.replace(/\\n\\n/g, '\\n<br/>').replace( /<br[/]>\\n/g , '<br/><br/>').replace(/\\n/g, '<p/>').replace(/  /g, '  ') + '</pre>', \"Replace\");\n    pccc.styleBuiltIn = \"NoSpacing\";\n  }\n  else {\n    /* pccc.load('text');\n    await context.sync(); */\n    var valRtext = pccc.split([\"\\n\"], false, false); // getTextRanges([], false);          \n    valRtext.load(['items', 'text']);\n    await context.sync();\n    //var arr = valRtext.items.map(i => i.text.split([\"\\u000B\"]) ).flat(1) ;\n    // coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    let op = valRtext.items.map(i => i.text).join('');\n    docEl.innerHTML = hljs.highlight(codelang, op.substr(0, op.length - 1)).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    //docEl.style = \"font-family: consolas; color: yellow\";\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    var jk = docEl.innerHTML.split(/\\r\\n|\\n|\\r|\\u000B/g);\n    pccc.clear();\n\n    for (let j = 0; j < jk.length; j++) {\n      //      pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '<p></p>') + '</pre>', \"Replace\");\n      if (j != jk.length - 1) {\n        pccc.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;') + '<br/>', \"End\");\n\n      } else if (jk[j].length != 0) {\n        pccc.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;'), \"End\");\n      }\n\n      //                pccc.insertHtml('' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p>&nbsp;</p>').replace( /<[/]p>\\n/g , '</p><p>&nbsp;</p>').replace(/\\n/g, '<p/>').replace(/  /g, '&nbsp;&nbsp;') + '', \"Replace\");\n    }\n    /* /!\\ pccc.styleBuiltIn = \"NoSpacing\"; */\n  }\n\n  pccc.font.name = \"Consolas\";\n  await context.sync();\n  document.body.getElementsByClassName('ws365_canvas')[0].removeChild(docEl);\n  docEl.innerHTML = '';\n}\n\nasync function reFormatSelected() {\n  await Word.run(async function (context) {\n    var searchResults;\n    let documentgetSelection = context.document.getSelection();\n    documentgetSelection.load(['isEmpty']);\n    await context.sync();\n\n    if (documentgetSelection.isEmpty) {\n      searchResults = context.document.body.contentControls;\n    } else {\n      searchResults = documentgetSelection.contentControls;\n    }\n    searchResults.load(['items', 'tag']);\n    await context.sync();\n\n    for (var i = 0; i < searchResults.items.length; i++) {\n      if (/ws365_code_.*/i.test(searchResults.items[i].tag)) {\n        let codelang = searchResults.items[i].tag.match(/ws365_code_(.*)/i)[1];\n        codelang = (codelang == 'output') ? 'text' : codelang;\n        await formatCC(context, searchResults.items[i], codelang);\n      }\n    }\n\n  });\n}\n\n\nasync function clearTags(tagName /* 'ws365_code_output' or 'ws365_quiz' */) {\n  await Word.run(async function (context) {\n    var searchResults;\n    let documentgetSelection = context.document.getSelection();\n    documentgetSelection.load(['isEmpty']);\n    await context.sync();\n\n    if (documentgetSelection.isEmpty) {\n      searchResults = context.document.body.contentControls.getByTag(tagName);\n    } else {\n      searchResults = documentgetSelection.contentControls.getByTag(tagName);\n    }\n    searchResults.load(['items', 'tag']);\n    await context.sync();\n\n    for (var i = 0; i < searchResults.items.length; i++) {\n      searchResults.items[i].clear();\n      if (tagName == 'ws365_quiz') {\n        searchResults.items[i].color = \"yellow\";\n        searchResults.items[i].font.highlightColor = \"yellow\";\n      }\n    }\n    await context.sync();\n  });\n}\n\nasync function processTags() {\n  await Word.run(async function (context) {\n\n    var searchResults;\n    let documentgetSelection = context.document.getSelection();\n    documentgetSelection.load(['isEmpty']);\n    await context.sync();\n\n    if (documentgetSelection.isEmpty) {\n      searchResults = context.document.body.search('[<]ws365[>]*[<]/ws365[>]', { matchWildcards: true });\n    } else {\n      searchResults = documentgetSelection.search('[<]ws365[>]*[<]/ws365[>]', { matchWildcards: true });\n    }\n    searchResults.load(['text']);\n    await context.sync();\n    var pp = new DOMParser();\n   \n    for (var i = 0; i < searchResults.items.length; i++) {\n\n      try {\n        let xmlDoc, xmlDocResultsEl;\n        let codelang, ccweight, cctitle;\n        let fetchResponse, fetchBodys;\n        let cc, pccc;\n        let patt = new RegExp('^[^]*$', 'g');\n        xmlDoc = pp.parseFromString(searchResults.items[i].text, \"text/xml\");\n\n        xmlDocResultsEl = xmlDoc.evaluate('/ws365/content[child::title and child::tag][1]', xmlDoc, null, XPathResult.ANY_TYPE, null).iterateNext();\n        if (xmlDocResultsEl != null) {\n          cctitle = xmlDocResultsEl.getElementsByTagName(\"title\")[0].childNodes[0].nodeValue;\n          pccc = context.document.contentControls.getByTitle(cctitle);\n          pccc.load('length');\n          await context.sync();\n\n          if (pccc.items.length == 0) {\n            cc = searchResults.items[i].insertParagraph('', Word.InsertLocation.after).insertContentControl();\n            cc.appearance = Word.ContentControlAppearance.tags;\n            cc.color = \"blue\";\n            cc.tag = xmlDocResultsEl.getElementsByTagName(\"tag\")[0].childNodes[0].nodeValue;\n            cc.title = cctitle;\n          }\n\n          if (xmlDocResultsEl.getElementsByTagName(\"clean\").length != 0) {\n            searchResults.items[i].delete();\n            searchResults.items[i].paragraphs.getLast().delete();\n          }\n        }\n\n        xmlDocResultsEl = xmlDoc.evaluate('/ws365/quiz[child::id][1]', xmlDoc, null, XPathResult.ANY_TYPE, null).iterateNext();\n        if (xmlDocResultsEl != null) {\n          if (xmlDocResultsEl.getElementsByTagName(\"weight\").length != 0) {\n            ccweight = xmlDocResultsEl.getElementsByTagName(\"weight\")[0].childNodes[0].nodeValue.trim();\n          } else {\n            ccweight = \"10\";\n          }\n          cctitle = \" \" + xmlDocResultsEl.getElementsByTagName(\"id\")[0].childNodes[0].nodeValue.trim() + \" ; \" + ccweight + \" / quiz \";\n          pccc = context.document.contentControls.getByTitle(cctitle);\n          pccc.load('length');\n          await context.sync();\n\n          if (pccc.items.length == 0) {\n            cc = searchResults.items[i].insertParagraph('', Word.InsertLocation.after).insertContentControl();\n            cc.appearance = Word.ContentControlAppearance.tags;\n            cc.color = \"yellow\";\n            cc.font.highlightColor = \"yellow\";\n            cc.tag = \"ws365_quiz\";\n            cc.title = cctitle;\n          }\n\n          if (xmlDocResultsEl.getElementsByTagName(\"clean\").length != 0) {\n            searchResults.items[i].delete();\n            searchResults.items[i].paragraphs.getLast().delete();\n          }\n        }\n\n        xmlDocResultsEl = xmlDoc.evaluate('/ws365/solutions[1]', xmlDoc, null, XPathResult.ANY_TYPE, null).iterateNext();\n        if (xmlDocResultsEl != null) {\n\n          pccc = context.document.contentControls.getByTag('ws365_solutions');\n          pccc.load(['length', 'title']);\n          await context.sync();\n\n          // var cxml = context.document.customXmlParts.add(xmlDocResultsEl.parentNode.textContent);\n          if (pccc.items.length == 0) {\n            cc = searchResults.items[i].insertParagraph('ws365_solutions', Word.InsertLocation.after).insertContentControl();\n            cc.appearance = Word.ContentControlAppearance.hidden;\n            cc.color = \"cyan\";\n            cc.font.highlightColor = \"cyan\";\n            cc.tag = \"ws365_solutions\";\n            cc.cannotEdit = true;\n            await context.sync();\n            cc.title = keyRot(xmlDocResultsEl.parentNode.innerHTML, cc.id.toString(), false) /* cxml.id */;\n          } else {\n            //context.document.customXmlParts.getItem(pccc.items[0].title.split('/')[0].trim()).delete();\n            pccc.items[0].title = keyRot(xmlDocResultsEl.parentNode.innerHTML, pccc.items[0].id.toString(), false) /* cxml.id */;\n          }\n\n          if (xmlDocResultsEl.getElementsByTagName(\"clean\").length != 0) {\n            searchResults.items[i].delete();\n            searchResults.items[i].paragraphs.getLast().delete();\n          }\n        }\n\n        xmlDocResultsEl = xmlDoc.evaluate('/ws365/code[child::id and child::lang][1]', xmlDoc, null, XPathResult.ANY_TYPE, null).iterateNext();\n        if (xmlDocResultsEl != null) {\n          codelang = xmlDocResultsEl.getElementsByTagName(\"lang\")[0].childNodes[0].nodeValue.trim();\n          cctitle = \" \" + xmlDocResultsEl.getElementsByTagName(\"id\")[0].childNodes[0].nodeValue.trim() + \" / \" + codelang + \" \";\n          pccc = context.document.contentControls.getByTitle(cctitle);\n          pccc.load('length');\n          await context.sync();\n\n          if (pccc.items.length == 0) {\n            cc = searchResults.items[i].insertParagraph('', Word.InsertLocation.after).insertContentControl();\n            cc.appearance = Word.ContentControlAppearance.tags;\n            cc.color = \"purple\";\n            cc.tag = \"ws365_code_\" + codelang;\n            cc.title = cctitle;\n\n            if (xmlDocResultsEl.getElementsByTagName(\"url\").length != 0) {\n\n              if (xmlDocResultsEl.getElementsByTagName(\"regex\").length != 0) {\n                patt = new RegExp(xmlDocResultsEl.getElementsByTagName(\"regex\")[0].childNodes[0].nodeValue, 'g');\n              }\n\n              fetchResponse = await fetch(xmlDocResultsEl.getElementsByTagName(\"url\")[0].childNodes[0].nodeValue.trim());\n              fetchBodys = await fetchResponse.text();\n              /* fetchBodys.match(patt).forEach((fetchBody, j, jA) => {\n                if (j != 0) { cc.insertParagraph('', Word.InsertLocation.end) }\n                cc.insertText(fetchBody, \"End\");\n              }); */\n              let pattj = 0;\n              let array1;\n              while ((array1 = patt.exec(fetchBodys)) !== null) {\n                if (pattj != 0) { cc.insertParagraph('', Word.InsertLocation.end) }\n                (array1[1] == undefined) ? cc.insertText(array1[0], \"End\") : cc.insertText(array1[1], \"End\");\n                pattj++;\n              }\n            }\n\n            if (xmlDocResultsEl.getElementsByTagName(\"content\").length != 0) {\n              if (xmlDocResultsEl.getElementsByTagName(\"content\")[0].hasChildNodes()) {\n                cc.insertText((xmlDocResultsEl.getElementsByTagName(\"content\")[0].childNodes[0].nodeValue), Word.InsertLocation.end);\n              }\n            }\n\n            await context.sync();\n          } else {\n            cc = pccc.items[0];\n          }\n\n          if (xmlDocResultsEl.getElementsByTagName(\"format\").length != 0) {\n            console.log(\"AAAAAAAAAAAAAAAAAAAAAAAAAA\");\n            await formatCC(context, cc, codelang);\n            console.log(\"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBB\");\n          }\n\n          if (xmlDocResultsEl.getElementsByTagName(\"clean\").length != 0) {\n            searchResults.items[i].delete();\n            searchResults.items[i].paragraphs.getLast().delete();\n          }\n        }\n      } catch (error) {\n        console.error('ERROR TO PROCESS: ', searchResults.items[i].text);\n      }\n      await context.sync();\n    }\n    return context.sync();\n  });\n}\n\n"],"sourceRoot":""}