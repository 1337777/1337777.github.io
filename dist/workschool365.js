!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=309)}({309:function(e,t){function n(e,t,n,r,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var i=e.apply(t,r);function s(e){n(i,o,a,s,c,"next",e)}function c(e){n(i,o,a,s,c,"throw",e)}s(void 0)}))}}function o(e){return a.apply(this,arguments)}function a(){return(a=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function i(){return(i=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Word.run(function(){var e=r(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.document.getSelection().insertParagraph(t.textContent.replace(/\s+/g," ").replace("/> </","><").trim(),"After").select(),e.next=4,n.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s(e,t,n){return String.fromCharCode.apply(null,e.split("").map((function(e,r){var o=t[r%t.length].charCodeAt();return n&&(o=-o),(e.charCodeAt()+o+65536)%65536})))}function c(){return l.apply(this,arguments)}function l(){return(l=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:/[/][/].*[.]sharepoint[.]com.*/i.test(Office.context.document.url)?self.location=Office.context.document.url.replace(/(.*)[/][^/]*$/i,"$1"):self.location="https://anthroplogic.com";case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){return e.replace(/[`~!@#$%^&*()-=+[{\]}\\|;:'"‘’“”,.<>/?]/g," ").replace(/[\n\s]+/g," ").trim().toLowerCase()}function d(){return m.apply(this,arguments)}function m(){return(m=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a,i,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.document.contentControls.getByTag("ws365_quiz")).load(["length","items","text","title"]),(r=t.document.contentControls.getByTag("ws365_solutions")).load(["length","items","text","title"]),e.next=6,t.sync();case 6:if(i=new DOMParser,c=i.parseFromString(s(r.items[0].title,r.items[0].id.toString(),!0),"text/xml"),null==(l=c.evaluate("/solutions[1]",c,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=13;break}return l.childNodes.forEach((function(e,t,i){try{var s=c.evaluate("id",e,null,XPathResult.ANY_TYPE,null).iterateNext().childNodes[0].nodeValue.trim(),l=c.evaluate("content",e,null,XPathResult.ANY_TYPE,null).iterateNext().childNodes[0].nodeValue,d=n.items.filter((function(e){return e.title.split("/")[0].split(";")[0].trim()==s}));0==d.length?(a=!1,o=r.items[0].insertParagraph(a?"OK":"KO",Word.InsertLocation.after).insertContentControl()):(a=u(d[0].text)==u(l),o=d[0].insertParagraph(a?"OK":"KO",Word.InsertLocation.after).insertContentControl()),o.cannotEdit=!0,o.cannotDelete=!0,o.appearance=Word.ContentControlAppearance.tags,o.color=a?"green":"red",o.font.highlightColor=a?"green":"red",o.font.color="white",o.tag="ws365_grade",o.title=" "+s+" / grade "}catch(e){console.error(e)}})),e.next=13,t.sync();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t,n){return g.apply(this,arguments)}function g(){return(g=r(regeneratorRuntime.mark((function e(t,n,r){var o,a,i,s,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=document.createElement("PRE"),Office.context.platform!=Office.PlatformType.PC){e.next=14;break}return(a=n.split(["\n"],!1,!1)).load(["items","text"]),e.next=6,t.sync();case 6:i=a.items.map((function(e){return e.text})).join(""),o.innerHTML=hljs.highlight(r,i.substr(0,i.length)).value,document.body.getElementsByClassName("ws365_canvas")[0].appendChild(o),computedStyleToInlineStyle(o,{recursive:!0,properties:["color","font-style","font-weight"]}),n.insertHtml("<pre>"+o.innerHTML.replace(/\u000B/g,"<br/>").replace(/\n/g,"\r\n")+"\r\n</pre>","Replace"),n.styleBuiltIn="NoSpacing",e.next=25;break;case 14:return(a=n.split(["\n"],!1,!1)).load(["items","text"]),e.next=18,t.sync();case 18:for(s=a.items.map((function(e){return e.text})).join(""),o.innerHTML=hljs.highlight(r,s.substr(0,s.length-1)).value,document.body.getElementsByClassName("ws365_canvas")[0].appendChild(o),computedStyleToInlineStyle(o,{recursive:!0,properties:["color","font-style","font-weight"]}),c=o.innerHTML.split(/\r\n|\n|\r|\u000B/g),n.clear(),l=0;l<c.length;l++)l!=c.length-1?n.insertHtml(c[l].replace(/  /g,"&nbsp;&nbsp;")+"<br/>","End"):0!=c[l].length&&n.insertHtml(c[l].replace(/  /g,"&nbsp;&nbsp;"),"End");case 25:return n.font.name="Consolas",e.next=28,t.sync();case 28:document.body.getElementsByClassName("ws365_canvas")[0].removeChild(o),o.innerHTML="";case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return h.apply(this,arguments)}function h(){return(h=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).load(["isEmpty"]),e.next=4,t.sync();case 4:return(n=r.isEmpty?t.document.body.contentControls:r.contentControls).load(["items","tag"]),e.next=8,t.sync();case 8:o=0;case 9:if(!(o<n.items.length)){e.next=18;break}if(!/ws365_code_.*/i.test(n.items[o].tag)){e.next=15;break}return a="output"==(a=n.items[o].tag.match(/ws365_code_(.*)/i)[1])?"text":a,e.next=15,p(t,n.items[o],a);case 15:o++,e.next=9;break;case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return x.apply(this,arguments)}function x(){return(x=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(n){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n.document.getSelection()).load(["isEmpty"]),e.next=4,n.sync();case 4:return(r=o.isEmpty?n.document.body.contentControls.getByTag(t):o.contentControls.getByTag(t)).load(["items","tag"]),e.next=8,n.sync();case 8:for(a=0;a<r.items.length;a++)r.items[a].clear(),"ws365_quiz"==t&&(r.items[a].color="yellow",r.items[a].font.highlightColor="yellow");return e.next=11,n.sync();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return B.apply(this,arguments)}function B(){return(B=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,a,i,c,l,u,d,m,g,f,h,y,x,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.document.getSelection()).load(["isEmpty"]),e.next=4,t.sync();case 4:return(n=r.isEmpty?t.document.body.search("[<]ws365[>]*[<]/ws365[>]",{matchWildcards:!0}):r.search("[<]ws365[>]*[<]/ws365[>]",{matchWildcards:!0})).load(["text"]),e.next=8,t.sync();case 8:o=new DOMParser,a=0;case 10:if(!(a<n.items.length)){e.next=104;break}if(e.prev=11,i=void 0,c=void 0,l=void 0,u=void 0,d=void 0,m=void 0,g=void 0,f=void 0,h=void 0,y=new RegExp("^[^]*$","g"),i=o.parseFromString(n.items[a].text,"text/xml"),null==(c=i.evaluate("/ws365/content[child::title and child::tag][1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=27;break}return d=c.getElementsByTagName("title")[0].childNodes[0].nodeValue,(h=t.document.contentControls.getByTitle(d)).load("length"),e.next=25,t.sync();case 25:0==h.items.length&&((f=n.items[a].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,f.color="blue",f.tag=c.getElementsByTagName("tag")[0].childNodes[0].nodeValue,f.title=d),0!=c.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete());case 27:if(null==(c=i.evaluate("/ws365/quiz[child::id][1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=37;break}return u=0!=c.getElementsByTagName("weight").length?c.getElementsByTagName("weight")[0].childNodes[0].nodeValue.trim():"10",d=" "+c.getElementsByTagName("id")[0].childNodes[0].nodeValue.trim()+" ; "+u+" / quiz ",(h=t.document.contentControls.getByTitle(d)).load("length"),e.next=35,t.sync();case 35:0==h.items.length&&((f=n.items[a].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,f.color="yellow",f.font.highlightColor="yellow",f.tag="ws365_quiz",f.title=d),0!=c.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete());case 37:if(null==(c=i.evaluate("/ws365/solutions[1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=57;break}return(h=t.document.contentControls.getByTag("ws365_solutions")).load(["length","title"]),e.next=43,t.sync();case 43:if(0!=h.items.length){e.next=55;break}return(f=n.items[a].insertParagraph("ws365_solutions",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.hidden,f.color="cyan",f.font.highlightColor="cyan",f.tag="ws365_solutions",f.cannotEdit=!0,e.next=52,t.sync();case 52:f.title=s(c.parentNode.innerHTML,f.id.toString(),!1),e.next=56;break;case 55:h.items[0].title=s(c.parentNode.innerHTML,h.items[0].id.toString(),!1);case 56:0!=c.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete());case 57:if(null==(c=i.evaluate("/ws365/code[child::id and child::lang][1]",i,null,XPathResult.ANY_TYPE,null).iterateNext())){e.next=94;break}return l=c.getElementsByTagName("lang")[0].childNodes[0].nodeValue.trim(),d=" "+c.getElementsByTagName("id")[0].childNodes[0].nodeValue.trim()+" / "+l+" ",(h=t.document.contentControls.getByTitle(d)).load("length"),e.next=65,t.sync();case 65:if(0!=h.items.length){e.next=87;break}if((f=n.items[a].insertParagraph("",Word.InsertLocation.after).insertContentControl()).appearance=Word.ContentControlAppearance.tags,f.color="purple",f.tag="ws365_code_"+l,f.title=d,0==c.getElementsByTagName("url").length){e.next=82;break}return 0!=c.getElementsByTagName("regex").length&&(y=new RegExp(c.getElementsByTagName("regex")[0].childNodes[0].nodeValue,"g")),e.next=75,fetch(c.getElementsByTagName("url")[0].childNodes[0].nodeValue.trim());case 75:return m=e.sent,e.next=78,m.text();case 78:for(g=e.sent,x=0,v=void 0;null!==(v=y.exec(g));)0!=x&&f.insertParagraph("",Word.InsertLocation.end),null==v[1]?f.insertText(v[0],"End"):f.insertText(v[1],"End"),x++;case 82:return 0!=c.getElementsByTagName("content").length&&c.getElementsByTagName("content")[0].hasChildNodes()&&f.insertText(c.getElementsByTagName("content")[0].childNodes[0].nodeValue,Word.InsertLocation.end),e.next=85,t.sync();case 85:e.next=88;break;case 87:f=h.items[0];case 88:if(0==c.getElementsByTagName("format").length){e.next=93;break}return console.log("AAAAAAAAAAAAAAAAAAAAAAAAAA"),e.next=92,p(t,f,l);case 92:console.log("BBBBBBBBBBBBBBBBBBBBBBBBBBBBBB");case 93:0!=c.getElementsByTagName("clean").length&&(n.items[a].delete(),n.items[a].paragraphs.getLast().delete());case 94:e.next=99;break;case 96:e.prev=96,e.t0=e.catch(11),console.error("ERROR TO PROCESS: ",n.items[a].text);case 99:return e.next=101,t.sync();case 101:a++,e.next=10;break;case 104:return e.abrupt("return",t.sync());case 105:case"end":return e.stop()}}),e,null,[[11,96]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}document.getElementById("process-tags").onclick=function(){return o(v)},document.getElementById("reformat-code").onclick=function(){return o(f)},document.getElementById("clear-output").onclick=function(){return o((function(){return y("ws365_code_output")}))},document.getElementById("clear-quiz").onclick=function(){return o((function(){return y("ws365_quiz")}))},document.getElementById("coq-taskpane").onclick=function(){self.location="./taskpane.html?et="},document.getElementById("anon-user").onclick=function(){return o(d)},document.getElementById("signed-in-user").onclick=function(){return o(c)},document.querySelectorAll(".doc-tags").forEach((function(e){e.addEventListener("click",(function(){return o((function(){return function(e){return i.apply(this,arguments)}(e)}))}))})),Office.onReady((function(e){e.host===Office.HostType.Word&&Word.run(function(){var e=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}});
//# sourceMappingURL=workschool365.js.map