<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>borceuxSolution.v</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Ubuntu" />
<link rel="stylesheet" type="text/css" href="./code/style.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">borceuxSolution.v</h1>
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">~COQ~ &gt; 8.5 </span><span style="font-weight: bold; font-style: italic;">*)</span>

<span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">METALOGIC</span>.
  Global <span style="font-weight: bold;">Set Implicit Arguments</span>.
  Global Unset <span style="font-weight: bold;">Strict Implicit</span>.
  Global <span style="font-weight: bold;">Unset Printing Implicit</span> Defensive.

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">ultimate meta logic (Coq type theory) T , which enrich all the subject logics instances of the interface V \;\;\; </span>

<span style="font-weight: bold; font-style: italic;">now T is on top of Type is instance of meta/logical category with interface V , </span>
<span style="font-weight: bold; font-style: italic;">++    any instance of interface V is enriched in T , </span>
<span style="font-weight: bold; font-style: italic;">++   T is both ordinary (in T) and enriched in itself T where ordinary (0 _ |- _ )0 coincide with enriched [0 _  ~&gt; _ ]0  ,</span>
<span style="font-weight: bold; font-style: italic;">++    TODO NEXT: show polymorphicity (polyF_morphism or polyF_arrow) of category or functor  is naturality (meta&#945;_morphism or meta&#965;_morphism) of meta transformation polyF (in index A or index V) where the logic is the T instance of interface V; Also is it necessary, for efficient semi-automatic semi-programmed canonical resolution/synthesis of the polymorphicity class,  that one shall express polymorphicity as naturality in the ultimate Coq meta logic T ? Or is polymorphicity-as-is workable ?</span>

<span style="font-weight: bold; font-style: italic;">later, top interface is  polyfunctor, get category by putting F is identity : obA -&gt; obB := obA   and now polyF_morphism becomes the wanted polyA_morphism ,   get metafunctor by putting  obB := obV   and now polyF_morphism becomes the wanted metaF_morphism  *</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">obT</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span> := <span style="font-weight: bold; text-decoration: underline;">Type</span>. 
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyT_relT00</span> : obT -&gt; obT -&gt; obT := <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">T1 T2</span> =&gt; T1 -&gt; T2.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"T(0 B |- A )0"</span> := (polyT_relT00 B A) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"T(0  B  |-  A  )0"</span>).

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">TODO: how to define conversion such to avoid functional extensionality for T ?</span>
<span style="font-weight: bold; font-style: italic;">comprehended as conversion on the enriched data *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">Inductive convT : forall T1 T2, T(0 T1 |- T2)0 -&gt; T(0 T1 |- T2 )0 -&gt; Prop :=</span>
<span style="font-weight: bold; font-style: italic;">  convT_Base : forall T1 T2 f g,  (forall t1, f t1 = g t1) -&gt; @convT T1 T2 f g</span>
<span style="font-weight: bold; font-style: italic;">| convT_Step : forall T1 T21 T22 f g,  (forall t1 ,  (@convT T21 T22 (f t1) (g t1))) -&gt; @convT T1 (T21 -&gt; T22) f g\;</span>
<span style="font-weight: bold; font-style: italic;">   </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">convT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">T1 T2</span>, T(0 T1 |- T2)0 -&gt; T(0 T1 |- T2 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">Prop</span> := <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">T1 T2</span> =&gt; eq . <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">forall t1, f t1 = g t1\;</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v2 ~~T v1"</span> := (convT v2 v1)  (<span style="font-weight: bold; text-decoration: underline;">at</span> level 70).

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyT_relT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">T</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT),
                            ( T -&gt; T(0 B |- A )0 ) -&gt;
                            <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT, T(0 A |- X )0  -&gt;  ( T -&gt; T(0 B |- X )0 )
    := (<span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">T</span> : obT) (<span style="font-weight: bold; font-style: italic;">B</span> : obT)  (<span style="font-weight: bold; font-style: italic;">A</span> : obT) (<span style="font-weight: bold; font-style: italic;">f</span> : T -&gt; T(0 B |- A )0) 
          (<span style="font-weight: bold; font-style: italic;">X</span> : obT) (<span style="font-weight: bold; font-style: italic;">g</span> : T(0 A |- X )0) (<span style="font-weight: bold; font-style: italic;">t</span> : T) (<span style="font-weight: bold; font-style: italic;">b</span> : B) =&gt;   g (f t b)) .
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">Arguments polyT_relT : simpl never\;</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">cstT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">T2</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>}, T2 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">T1</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>}, T1 -&gt; T2 := <span style="font-weight: bold; text-decoration: underline;">fun</span> T2 (<span style="font-weight: bold; font-style: italic;">t2</span> : T2) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> T1 (<span style="font-weight: bold; font-style: italic;">_</span> : T1) =&gt; t2.
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">Arguments cstT : simpl never\;</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">almost same as the common constant \;\; but no unit-picking mentionned *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyT_relT_constant</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT),
                                     T(0 B |- A )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT, T(0 A |- X )0  -&gt; T(0 B |- X )0
    := (<span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">B A</span> : obT) (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 B |- A )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obT) (<span style="font-weight: bold; font-style: italic;">g</span> : T(0 A |- X )0) =&gt;
          polyT_relT (cstT f) g tt) .
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">Arguments polyT_relT_constant : simpl never\;</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">idT</span> {<span style="font-weight: bold; font-style: italic;">T</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>} : T -&gt; T := <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">x</span> : T =&gt; x .
  <span style="font-weight: bold;">Arguments</span> idT : <span style="text-decoration: underline;">simpl</span> never.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyT_relT_identitary</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT),
                                     <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT, T(0 A |- X )0  -&gt; T(0 B |- A )0 -&gt; T(0 B |- X )0
    :=  <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT) =&gt;
                        <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT =&gt;  <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">a</span> : T(0 A |- X )0) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">b</span> : T(0 B |- A )0) =&gt;
                                                              @polyT_relT (T(0 B |- A )0) B A idT X a b .
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">Arguments polyT_relT_identitary : simpl never\;</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">IdenT</span> {<span style="font-weight: bold; font-style: italic;">T</span> : obT} : T(0 T |- T )0 := @idT T .
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"'1T"</span> := (@IdenT _) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).

  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"T(1 b |- X )0"</span> := (@polyT_relT _ _ _ b X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"T(1  b  |-  X  )0"</span>).

  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"T(1I b |- X )0"</span> := (@polyT_relT_constant _ _ b X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"T(1I  b  |-  X  )0"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"b o&gt;&gt; a"</span> := (@polyT_relT_constant _ _ b _ a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).
  <span style="font-weight: bold;">Eval</span> <span style="text-decoration: underline;">compute</span> <span style="font-weight: bold; text-decoration: underline;">in</span>  <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">b a</span> =&gt; b o&gt;&gt; a .

  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"T(0 X |- - )1"</span> := (@polyT_relT_identitary _ _ X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"T(0  X  |-  -  )1"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"T(0 X |- a )1"</span> := (@polyT_relT_identitary _ _ X a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"T(0  X  |-  a  )1"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"a &lt;&lt;o b"</span> := (@polyT_relT_identitary _ _ _ a b) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).
  <span style="font-weight: bold;">Eval</span> <span style="text-decoration: underline;">compute</span> <span style="font-weight: bold; text-decoration: underline;">in</span>  <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">b a</span> =&gt; a &lt;&lt;o b .

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">consT00</span> : obT -&gt; obT -&gt; obT.
    <span style="text-decoration: underline;">intros</span> V1 V2. exact ( (V1 -&gt; V2) % type). <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">consT01</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V1</span> : obT}, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2 V2'</span>, (polyT_relT00 V2 V2') -&gt; (polyT_relT00 (consT00 V1 V2)  (consT00 V1 V2')).
    <span style="text-decoration: underline;">intros</span> ? ? ? v2 v12.  exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_v1</span> =&gt; v2 ( v12 _v1 ) ). <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(consT01In U v2) is    outgetting (consT01 v2),   ALT innerly/contextually in the contextU,  is action of (consT01 v2) </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">consT01In</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">U</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2 V2'</span>, (polyT_relT00 V2 V2') -&gt;
                                                          (polyT_relT00 U (consT00 V1 V2)) -&gt;  (polyT_relT00 U  (consT00 V1 V2'))  .
    <span style="text-decoration: underline;">intros</span> ? ? ? ? v2.
    <span style="text-decoration: underline;">intros</span> u'v1'v2. exact ( (consT01 v2) &lt;&lt;o u'v1'v2 ) || exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">__u</span> =&gt;  consT01 v2 (u'v1'v2 __u) ). <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Check</span> ( <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U</span> : obT =&gt;  <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obT =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">V2 V2'</span> =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">v2</span> : (polyT_relT00 V2 V2') =&gt;
                                                 <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">u'v1'v2</span> : (polyT_relT00 U (consT00 V1 V2)) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">__u</span> =&gt;
                                                                                                  <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_v1</span> =&gt; eq_refl :  ( (consT01In v2 u'v1'v2 __u) _v1 = (v2 &lt;&lt;o (u'v1'v2 __u)) _v1 ) ) .
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">consT10</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1' V1</span>, (polyT_relT00 V1' V1) -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V2</span> : obT}, (polyT_relT00 (consT00 V1 V2) (consT00 V1' V2)).
    <span style="text-decoration: underline;">intros</span> ? ? v1 ? v12 .  exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_v1'</span> =&gt; v12 (v1 _v1') ). <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">consT10In</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">U</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1' V1</span>, (polyT_relT00 V1' V1) -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obT, (polyT_relT00 U (consT00 V1 V2)) -&gt;  (polyT_relT00 U (consT00 V1' V2) ) .
    <span style="text-decoration: underline;">intros</span> ? ? ? v1 ? .
    <span style="text-decoration: underline;">intros</span> u'v1'v2. exact ( (consT10 v1) &lt;&lt;o u'v1'v2  ) || exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">__u</span> =&gt; consT10 v1 (u'v1'v2 __u) ) . <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Check</span> ( <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">U</span> : obT =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">V1' V1</span> =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">v1</span> : (polyT_relT00 V1' V1) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obT =&gt;
                                                                  <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">u'v1'v2</span> : (polyT_relT00 U (consT00 V1 V2)) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">__u</span> =&gt;
                                                                                                                   <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_v1'</span> =&gt; eq_refl : ( (consT10In v1 u'v1'v2 __u) _v1'  = (v1 o&gt;&gt; (u'v1'v2 __u)) _v1' ) ) .
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">desT00</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obT, obT.
    <span style="text-decoration: underline;">intros</span> ? ? . exact (prod V1 V2). <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">desT10</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1 V1'</span>, (polyT_relT00 V1 V1') -&gt; (polyT_relT00 (desT00 V2 V1) (desT00 V2 V1')).
    <span style="text-decoration: underline;">intros</span> ? ? ? v (_v1, _v2). exact (v _v1, _v2). <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">ConsT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT), (polyT_relT00 (desT00 V U) W) -&gt; (polyT_relT00 U (consT00 V W)).
    <span style="text-decoration: underline;">intros</span> ? ? ? uv'w. exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_u</span> =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_v</span> =&gt; uv'w (_u, _v) ). <span style="font-weight: bold;">Defined</span>. 
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">DesT</span>: <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT), (polyT_relT00 U (consT00 V W)) -&gt; (polyT_relT00 (desT00 V U) W) .
    <span style="text-decoration: underline;">intros</span> ? ? ? u'v'w. exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_u_v</span> =&gt; <span style="font-weight: bold; text-decoration: underline;">let</span> (_u, _v) := _u_v <span style="font-weight: bold; text-decoration: underline;">in</span> u'v'w _u _v ). <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">IdenObT</span> : obT.
    exact unit. <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">unitT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obT}, (polyT_relT00 IdenObT (consT00 A A) ).
    <span style="text-decoration: underline;">intros</span> ? ?. exact (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a</span> =&gt; a). <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">AssocT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V W</span> :obT }, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U</span>: obT }, T(0 (desT00 (desT00 W V )  U ) |- (desT00 W ( (desT00 V  U))  ) )0.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">intro</span>. <span style="text-decoration: underline;">destruct</span> X. <span style="text-decoration: underline;">destruct</span> d. exact ((u,v ),w).
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">unitT_relT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obT}, (polyT_relT00 IdenObT (polyT_relT00 A A) ) .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">intro</span>. <span style="text-decoration: underline;">eapply</span> IdenT.
  <span style="font-weight: bold;">Defined</span>.
  <span style="font-weight: bold;">Print</span> Grammar <span style="text-decoration: underline;">pattern</span>.
  <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"(0T V1 &amp; V2 )0"</span> := (desT00 V2 V1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"(0T  V1  &amp;  V2  )0"</span>).
  <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"(1T v &amp; V2 )0"</span> := (@desT10 V2 _ _ v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"(1T  v  &amp;  V2  )0"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"[0T V1 ~&gt; V2 ]0"</span> := (consT00 V1 V2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"[0T  V1  ~&gt;  V2  ]0"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"[0T V1 ~&gt; v ]1"</span> := (@consT01 V1 _ _ v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"[0T  V1  ~&gt;  v  ]1"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"[1T v ~&gt; V2 ]0"</span> := (@consT10 _ _ v V2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"[1T  v  ~&gt;  V2  ]0"</span>).
  <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"'IT'"</span> := (IdenObT) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"'uT'"</span> := (@unitT _) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).

  <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">for T, class properties of data *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Axiom</span>  <span style="font-weight: bold; font-style: italic;">functional_extensionality_T</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A B</span> : obT}, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f g</span> : T(0 A |- B )0),  (<span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">x</span>, f x = g x) -&gt; f = g.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">ReflT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> A1 A2 (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 A1 |- A2 )0), f ~~T f.
  <span style="font-weight: bold;">Proof</span>.
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">SymT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1 A2</span>,  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f' f</span> : T(0 A1 |- A2)0), f ~~T f' -&gt; f' ~~T f.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">symmetry</span>. assumption.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">TransT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1 A2</span>, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">uTrans f</span> : T(0 A1 |- A2)0), uTrans ~~T f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f'</span> : T(0 A1 |- A2)0), f' ~~T uTrans -&gt; f' ~~T f.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">eapply</span> eq_trans; eassumption.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cong_polyT_relT</span> :   <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT) (<span style="font-weight: bold; font-style: italic;">B A</span> : obT) (<span style="font-weight: bold; font-style: italic;">f f'</span> : T(0 V |- T(0 B |- A )0 )0),
                              (<span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">_v</span> : V, f' _v ~~T f _v) -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT,  <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~T a2 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">_v</span>, T(1 f' |- X )0 a1 _v ~~T T(1 f |- X )0 a2 _v .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">compute</span>. <span style="text-decoration: underline;">rewrite</span> H, H0. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongDesT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : T(0 U |- [0T V ~&gt; W ]0 )0),
                     f' ~~T f -&gt; DesT f' ~~T DesT f .
    <span style="text-decoration: underline;">intros</span> ? ? ? ? ? H .
    <span style="text-decoration: underline;">simpl</span>. <span style="text-decoration: underline;">rewrite</span> H. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Des_ConsT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 (0T U &amp; V )0 |-  W )0),
                      DesT (ConsT f) ~~T f .
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> functional_extensionality_T. <span style="text-decoration: underline;">intros</span> [ ]. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Des_OutputT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT ), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : T(0 U |- T(0 V |- W )0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> W' (<span style="font-weight: bold; font-style: italic;">w</span> : T(0 W |- W' )0),
                        DesT( [0T V ~&gt; w ]1 &lt;&lt;o v ) ~~T w &lt;&lt;o DesT( v ) .
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> functional_extensionality_T. <span style="text-decoration: underline;">intros</span> [ ]. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">this is some form of functional extensionality </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongConsT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : T(0 (0T U &amp; V )0 |- W )0 ),
                      v' ~~T v -&gt; ConsT v' ~~T ConsT v .
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">compute</span>. <span style="text-decoration: underline;">rewrite</span> H. reflexivity.
  <span style="font-weight: bold;">Qed</span>.
  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cons_DesT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 U |-  [0T V ~&gt; W ]0 )0),
                      ConsT (DesT f) ~~T f .
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cons_InputT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U U'</span> : obT) (<span style="font-weight: bold; font-style: italic;">w</span> : T(0 U' |- U )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obT) (<span style="font-weight: bold; font-style: italic;">v</span> : T(0 (0T U &amp; V )0 |- W )0),
                        ConsT(v &lt;&lt;o (1T w &amp; V )0 )  ~~T ConsT( v ) &lt;&lt;o w .
    <span style="text-decoration: underline;">intros</span>.  reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Assoc_RevT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span>{<span style="font-weight: bold; font-style: italic;">V W U</span> : obT},
                       T(0 (0T (0T U &amp; V )0 &amp; W )0 |- (0T U &amp; (0T V &amp; W )0 )0 )0 .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">intros</span> [[u' v'] w']. exact (u', (v', w')).
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Assoc_Assoc_RevT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span>(<span style="font-weight: bold; font-style: italic;">V W U</span> : obT),
                             '1T ~~T (Assoc_RevT &lt;&lt;o (@AssocT V W U)) .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> functional_extensionality_T. <span style="text-decoration: underline;">intros</span> [? []]. reflexivity.
  <span style="font-weight: bold;">Qed</span>.
  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Assoc_Rev_AssocT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span>(<span style="font-weight: bold; font-style: italic;">V W U</span> : obT),
                             '1T ~~T ((@AssocT V W U) &lt;&lt;o Assoc_RevT) .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> functional_extensionality_T. <span style="text-decoration: underline;">intros</span> [[] ?]. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">DesInT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obT), T(0 U0 |- [0T U1 ~&gt; [0T V ~&gt; W ]0 ]0 )0 -&gt; T(0 U0 |- [0T (0T U1 &amp; V )0 ~&gt; W ]0 )0.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> ConsT. <span style="text-decoration: underline;">eapply</span> polyT_relT_identitary. <span style="font-weight: bold;">Check</span> @AssocT. 2: <span style="text-decoration: underline;">eapply</span> (@AssocT _ _ _).  <span style="text-decoration: underline;">eapply</span> DesT.
    <span style="text-decoration: underline;">eapply</span> DesT. exact X.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">DesIdenObRT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U W</span> : obT}, T(0 U |- [0T IT ~&gt; W ]0 )0 -&gt; T(0 U  |- W )0 .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">intro</span>. <span style="text-decoration: underline;">apply</span> X. assumption. exact tt.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">DesIdenObLT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V W</span> : obT}, T(0 IT |- [0T V ~&gt; W ]0 )0 -&gt; T(0 V  |- W )0 .
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">intro</span>. <span style="text-decoration: underline;">apply</span> X. exact tt. assumption.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_constant_rel_identitary</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT) , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT) ,
                                              <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a</span> : T(0 A |- X )0),  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : T(0 B |- A )0),
                                                @polyT_relT_constant B A b X a ~~T  a &lt;&lt;o b  . 
  <span style="font-weight: bold;">Proof</span>.
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_arrow</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B A</span> : obT) (<span style="font-weight: bold; font-style: italic;">V V'</span> : obT) (<span style="font-weight: bold; font-style: italic;">v</span> : T(0 V' |- V )0)
                             (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 V |- T(0 B |- A )0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obT),
                           <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a1</span> : T(0 A |- X )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a2</span>, a1 ~~T a2 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">_v'</span> : V'),
                                                                      (T(1 f &lt;&lt;o v |- X )0) a1 _v' ~~T
                                                                                           ([1T v ~&gt; T(0 B |- X )0 ]0 &lt;&lt;o (T(1 f |- X )0)) a2 _v'.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span> * H * . <span style="text-decoration: underline;">rewrite</span> H. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_arrow_simpl</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT),
                                  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">T T'</span> : obT) (<span style="font-weight: bold; font-style: italic;">b</span> : T' -&gt; T),
                                  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : T -&gt; T(0 B |- A )0 ) (<span style="font-weight: bold; font-style: italic;">X</span> : obT),
                                  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a</span> : T(0 A |- X )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">ttt</span>: T'),
                                    T(1 (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">v'</span> =&gt; f (b v')) |- X )0 a ttt
                                     ~~T T(1 f |- X )0 a (b ttt) .
  <span style="font-weight: bold;">Proof</span>.
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span>  <span style="font-weight: bold;">polyT_relT_morphism</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT) (<span style="font-weight: bold; font-style: italic;">B A</span> : obT) (<span style="font-weight: bold; font-style: italic;">W</span> : obT) (<span style="font-weight: bold; font-style: italic;">A'</span> : obT)
                                 (<span style="font-weight: bold; font-style: italic;">g</span> : T(0 W |- T(0 A |- A' )0 )0)
                                 (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 V |- T(0 B |- idT A )0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a'</span> : T(0 idT A' |- X )0) (<span style="font-weight: bold; font-style: italic;">_w_v</span> : (0T W &amp; V )0),
                                 T(1 DesT([1T f ~&gt; T(0 B |- idT A' )0 ]0 &lt;&lt;o (T(1 '1T |- A' )0) &lt;&lt;o g) |- X )0 a' _w_v
                                  ~~T DesInT ([0T W ~&gt; T(1 f |- X )0 ]1 &lt;&lt;o (T(1 g |- X )0)) a' _w_v.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">destruct</span> _w_v. reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">written here :   (outer modification) ~~ (inner modification) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_morphism_simpl</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT), 
                                     <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT) (<span style="font-weight: bold; font-style: italic;">A'</span> : obT) (<span style="font-weight: bold; font-style: italic;">g</span> : T(0 A |- A')0),
                                     <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">X</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">pull</span> : T(0 B |- A)0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">push</span> : T(0 A'  |- X )0 ),
                                       T(1I T(0 A' |- g )1 pull |- X )0 push
                                        ~~T  T(0 X |- T(1I g |- X )0 push )1 pull .
  <span style="font-weight: bold;">Proof</span>.
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">related to non-variance when unit pull the input, commonly  ( 1 o&gt; h ) ~~ h  *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_unitT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A X</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~T a2 -&gt;
                                                 @IdenT _ a1 ~~T DesIdenObRT (T(1 @unitT_relT A |- X )0) a2.
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>. assumption.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_unitT_simpl</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obT, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~T a2 -&gt; ( @idT (T(0 A |- X )0)  ) a1 ~~T ( T(1I (@IdenT A) |- X )0 ) a2 .
  <span style="font-weight: bold;">Proof</span>.
    <span style="text-decoration: underline;">intros</span>.  <span style="text-decoration: underline;">intros</span>. assumption.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">related to non-variance when unit push the output, commonly  ( (f _i) o&gt; 1 ) ~~ (f _i)  , </span>
<span style="font-weight: bold; font-style: italic;">       therefore polyT is injective *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_inputUnitT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT) (<span style="font-weight: bold; font-style: italic;">B A</span> : obT) (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 V |- T(0 B |- A )0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">_v</span>,
                                  f _v ~~T DesIdenObLT( T(1 f |- A )0 &lt;&lt;o  unitT_relT) _v.
  <span style="font-weight: bold;">Proof</span>.
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyT_relT_inputUnitT_simpl</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obT),
                                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : T(0 B |- A )0),
                                        b  ~~T ( (T(1I b |- A )0)  (@IdenT A) ) .
  <span style="font-weight: bold;">Proof</span>.
    reflexivity.
  <span style="font-weight: bold;">Qed</span>.
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">METALOGIC</span>.
</pre>
</div>
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Import</span> METALOGIC.
<span style="font-weight: bold;">Set Universe Polymorphism</span>.

<span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">LOGIC</span>.
  <span style="font-weight: bold;">Set Implicit Arguments</span>.
  Unset  <span style="font-weight: bold;">Strict Implicit</span>.

  <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">put any `arrows :^) logic'  V   \;\;\;  this says that rewrite polyV_relT more generally as if enriched in T  then get old instance\;\;\; therefore must rewrite polyV_relT_polymorphism more generally then get old instance  *</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">Record</span> <span style="font-weight: bold;">data</span> :=
    Data {
        <span style="font-weight: bold; font-style: italic;">obV</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>;
        polyV_relT00 : obV -&gt; obV -&gt; obT;
        convV : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1 V2</span>, polyV_relT00 V1 V2 -&gt; polyV_relT00 V1 V2 -&gt; <span style="font-weight: bold; text-decoration: underline;">Prop</span>;
        polyV_relT : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">T</span> : obT), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">B</span> : obV,  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV),
                       T(0 T |- (polyV_relT00 B A) )0 -&gt;
                       <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">X</span> : obV), T(0 (polyV_relT00 A X) |-  T(0 T |- (polyV_relT00 B X) )0 )0;
        IdenV : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV}, (polyV_relT00 V V);

        consV00 : obV -&gt; obV -&gt; obV;
        consV01 : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obV, <span style="font-weight: bold; text-decoration: underline;">forall</span> {V2 V2'}, (polyV_relT00 V2 V2') -&gt; (polyV_relT00 (consV00 V1 V2)  (consV00 V1 V2'));
        consV10 : <span style="font-weight: bold; text-decoration: underline;">forall</span> {V1' V1}, (polyV_relT00 V1' V1) -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obV, (polyV_relT00 (consV00 V1 V2) (consV00 V1' V2));
        desV00 : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obV, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obV, obV;
        desV10 : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obV, <span style="font-weight: bold; text-decoration: underline;">forall</span> {V1 V1'}, (polyV_relT00 V1 V1') -&gt; (polyV_relT00 (desV00 V2 V1) (desV00 V2 V1'));
        Cons : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U W</span> : obV}, (polyV_relT00 (desV00 V U) W) -&gt; (polyV_relT00 U (consV00 V W));
        Des : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U W</span> : obV}, (polyV_relT00 U (consV00 V W)) -&gt; (polyV_relT00 (desV00 V U) W);

        IdenObV : obV;
        unitV : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obV}, (polyV_relT00 IdenObV (consV00 A A) );
        Assoc : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V W</span> :obV}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U</span>: obV}, (polyV_relT00 (desV00 (desV00 W V) U )  ((desV00 W (desV00  V U ))  ) );
        DesIdenObR : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U W</span> : obV}, (polyV_relT00 U (consV00 IdenObV W) ) -&gt; (polyV_relT00 U W);
        DesIdenObL : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">W</span> : obV}, (polyV_relT00 IdenObV (consV00 V W)) -&gt; (polyV_relT00 V W);
      }.

  <span style="font-weight: bold;">Arguments</span> Des {_} {_ _ _} _ .
  <span style="font-weight: bold;">Arguments</span> Cons {_} {_ _ _} _ .
  <span style="font-weight: bold;">Arguments</span> Assoc {_} {_ _ _}.
  <span style="font-weight: bold;">Arguments</span> DesIdenObR {_} {_ _} _ .
  <span style="font-weight: bold;">Arguments</span> DesIdenObL {_} {_ _} _ .

  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyV_relV00</span> := (@consV00) .

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations</span>.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V(0 B |- A )0"</span> := (@polyV_relT00 dat B A) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"dat .-V(0  B  |-  A  )0"</span>).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V(0 B |- A )0"</span> := (_ .-V(0 B |- A )0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35).

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">remember these polyV_relT_constant and polyV_relT_identitary forms are non-general and are particular for _relT, because no unit-picking mentionned *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyV_relT_constant</span> {<span style="font-weight: bold; font-style: italic;">log</span>: data} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log),
                                                 V(0 B |- A )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log, T(0 V(0 A |- X )0  |- V(0 B |- X )0 )0
    := (<span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">B A</span> : obV log) (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 B |- A )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obV log) (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 A |- X )0) =&gt;
          polyV_relT (cstT f) g tt) .
  <span style="font-weight: bold; font-style: italic;">(*    </span><span style="font-weight: bold; font-style: italic;">Arguments polyV_relT_constant : simpl never\;</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">remember these polyV_relT_constant and polyV_relT_identitary forms are non-general and are particular for _relT, because no unit-picking mentionned *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyV_relT_identitary</span> {<span style="font-weight: bold; font-style: italic;">log</span> : data} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log),
                                                  <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log, T(0 V(0 A |- X )0  |- T(0 V(0 B |- A )0 |- V(0 B |- X )0 )0 )0
    :=  <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log) =&gt;
                            <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log =&gt;  <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">a</span> : V(0 A |- X )0) =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">b</span> : V(0 B |- A )0) =&gt;
                                                                      @polyV_relT log (V(0 B |- A )0) B A (idT) X a b .
  <span style="font-weight: bold; font-style: italic;">(*    </span><span style="font-weight: bold; font-style: italic;">Arguments polyV_relT_identitary : simpl never\;</span><span style="font-weight: bold; font-style: italic;">*)</span>


  <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">unitV_relT</span> {<span style="font-weight: bold; font-style: italic;">log</span> : data} : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obV log}, T(0 IT |- V(0 A |- A )0 )0.
    <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">intro</span>. <span style="text-decoration: underline;">eapply</span> IdenV.
  <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations2</span>.
    <span style="font-weight: bold;">Export</span> Ex_Notations.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V(1 b |- X )0"</span> := (@polyV_relT dat _ _ _ b X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"dat .-V(1  b  |-  X  )0"</span>).
    <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">more precisely ( ( b 0 ) o&gt; _ )   *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V(1I b |- X )0"</span> := (@polyV_relT_constant dat _ _ b X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"dat .-V(1I  b  |-  X  )0"</span>).
    <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">more precisely ( ( b 0 ) o&gt; a )  *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">TODO: write this as coming from application ( b o&gt;dat&gt; ) a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"b o&gt;` dat `&gt; a"</span> := (@polyV_relT_constant dat _ _ b _ a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity, dat <span style="font-weight: bold; text-decoration: underline;">at</span> level 0, format <span style="font-style: italic;">"b  o&gt;` dat `&gt;  a"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V(0 X |- - )1"</span> := (@polyV_relT_identitary dat _ _ X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"dat .-V(0  X  |-  -  )1"</span>).
    <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">more precisely ( ( id _ ) o&gt; a )  *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V(0 X |- a )1"</span> := (@polyV_relT_identitary dat _ _ X a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"dat .-V(0  X  |-  a  )1"</span>).
    <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">more precisely ( ( id b ) o&gt; a )  *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">TODO: write this as coming from application ( a &lt;&lt;o ) a </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"a &lt;` dat `&lt;o b"</span> <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">a &lt;` dat `&lt;o b </span><span style="font-weight: bold; font-style: italic;">*)</span>:= (@polyV_relT_identitary dat _ _ _ a b) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity, dat <span style="font-weight: bold; text-decoration: underline;">at</span> level 0, format <span style="font-style: italic;">"a  &lt;` dat `&lt;o  b"</span>).

    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v2 ~~ dat ` v1"</span> := (@convV dat _ _ v2 v1)  (<span style="font-weight: bold; text-decoration: underline;">at</span> level 70, dat <span style="font-weight: bold; text-decoration: underline;">at</span> next level, format <span style="font-style: italic;">"v2  ~~ dat `  v1"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-1"</span> := (@IdenV dat _) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 2, <span style="text-decoration: underline;">left</span> associativity, format <span style="font-style: italic;">"dat .-1"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-[0 V1 ~&gt; V2 ]0"</span> := (@consV00 dat V1 V2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"dat .-[0  V1  ~&gt;  V2  ]0"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-[0 V1 ~&gt; v ]1"</span> := (@consV01 dat V1 _ _ v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"dat .-[0  V1  ~&gt;  v  ]1"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-[1 v ~&gt; V2 ]0"</span> := (@consV10 dat _ _ v V2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"dat .-[1  v  ~&gt;  V2  ]0"</span>).
    <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"dat .-(0 V1 &amp; V2 )0"</span> := (@desV00 dat V2 V1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"dat .-(0  V1  &amp;  V2  )0"</span>).
    <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"dat .-(1 v &amp; V2 )0"</span> := (@desV10 dat V2 _ _ v) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"dat .-(1  v  &amp;  V2  )0"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V[0 V1 ~&gt; V2 ]0"</span> := (@polyV_relV00 dat V1 V2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, only parsing).
    <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"dat .-I"</span> := (@IdenObV dat ) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 2, format <span style="font-style: italic;">"dat .-I"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-uV"</span> := (@unitV dat _) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 2, format <span style="font-style: italic;">"dat .-uV"</span>).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations2</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations2.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V(1 b |- X )0"</span> := (_ .-V(1 b |- X )0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"V(1  b  |-  X  )0"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V(1I b |- X )0"</span> := (_ .-V(1I b |- X )0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"V(1I  b  |-  X  )0"</span>).
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">TODO: write this as coming from application ( b o&gt; ) a </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"b o&gt; a"</span> := (b o&gt;` _ `&gt; a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).

  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V(0 X |- - )1"</span> := (_ .-V(0 X |- - )1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"V(0  X  |-  -  )1"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V(0 X |- a )1"</span> := (_ .-V(0 X |- a )1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 35, format <span style="font-style: italic;">"V(0  X  |-  a  )1"</span>).
  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">TODO: write this as coming from application ( a &lt;o ) b </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"a &lt;o b"</span> := (a &lt;` _ `&lt;o b) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).

  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"v2 ~~ v1"</span> := (@convV _ _ _ v2 v1)  (<span style="font-weight: bold; text-decoration: underline;">at</span> level 70).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"1"</span> := (_ .-1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"[0 V1 ~&gt; V2 ]0"</span> := (_ .-[0 V1 ~&gt; V2 ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"[0  V1  ~&gt;  V2  ]0"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"[0 V1 ~&gt; v ]1"</span> := (_ .-[0 V1 ~&gt; v ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"[0  V1  ~&gt;  v  ]1"</span> ).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"[1 v ~&gt; V2 ]0"</span> := (_ .-[1 v ~&gt; V2 ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"[1  v  ~&gt;  V2  ]0"</span>).
  <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"(0 V1 &amp; V2 )0"</span> := (_ .-(0 V1 &amp; V2 )0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"(0  V1  &amp;  V2  )0"</span>).
  <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"(1 v &amp; V2 )0"</span> := (_ .-(1 v &amp; V2 )0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 30, format <span style="font-style: italic;">"(1  v  &amp;  V2  )0"</span>).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V[0 V1 ~&gt; V2 ]0"</span> := (_ .-V[0 V1 ~&gt; V2 ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, only parsing).
  <span style="font-weight: bold;">Notation</span>  <span style="font-style: italic;">"'I'"</span> := (_ .-I) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"'uV'"</span> := (_ .-uV) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">Class not critical, only for easy proofs without doing (class_of _) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">class</span> {<span style="font-weight: bold; font-style: italic;">dat</span> : data} :=
    <span style="font-weight: bold;">Class</span> {
        <span style="font-weight: bold; font-style: italic;">ReflV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 A1 |- A2 )0), f ~~ f;
        TransV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obV dat) , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">uTrans f</span> : V(0 A1 |- A2)0), uTrans ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f'</span> : V(0 A1 |- A2)0), f' ~~ uTrans -&gt; f' ~~ f;
        SymV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obV dat),  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f' f</span> : V(0 A1 |- A2)0), f ~~ f' -&gt; f' ~~ f;
        Cong_polyV_relT :   <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT) (<span style="font-weight: bold; font-style: italic;">B A</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">f f'</span> : T(0 V |- V(0 B |- A )0 )0),
                              (<span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">_v</span> : V, f' _v ~~ f _v) -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV dat,  <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~ a2 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">_v</span>, V(1 f' |- X )0 a1 _v ~~ V(1 f |- X )0 a2 _v;
        <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">remember that polyV_relT_arrow , relate in particular the polyV_relT_constant to polyV_relT_identitary *</span><span style="font-weight: bold; font-style: italic;">*)</span>
        polyV_relT_arrow : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B A</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">V V'</span> : obT) (<span style="font-weight: bold; font-style: italic;">v</span> : T(0 V' |- V )0)
                             (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 V |- dat.-V(0 B |- A )0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obV dat),
                           <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a</span> : dat.-V(0 A |- X )0) a0, a ~~ a0 -&gt;  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">_v'</span>: V'),
                                                                      (dat.-V(1 f &lt;&lt;o v |- X )0) a _v' ~~
                                                                                                ([1T v ~&gt; dat.-V(0 B |- X )0 ]0 &lt;&lt;o (dat.-V(1 f |- X )0)) a0 _v';
        <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">written here :   (outer modification) ~~ (inner modification) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
        polyV_relT_morphism : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT) (<span style="font-weight: bold; font-style: italic;">B A</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">W</span> : obT) (<span style="font-weight: bold; font-style: italic;">A'</span> : obV dat)
                                (<span style="font-weight: bold; font-style: italic;">g</span> : T(0 W |- dat.-V(0 A |- A' )0 )0)
                                (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 V |- dat.-V(0 B |- idT A )0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obV dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a'</span> : V(0 idT A' |- X )0) (<span style="font-weight: bold; font-style: italic;">_w_v</span> : (0T W &amp; V )0),
                                dat.-V(1 DesT ([1T f ~&gt; dat.-V(0 B |- idT A' )0 ]0 &lt;&lt;o (dat.-V(1 '1T |- A' )0) &lt;&lt;o g) |- X )0 a' _w_v
                                   ~~ DesInT ([0T W ~&gt; dat.-V(1 f |- X )0 ]1 &lt;&lt;o (dat.-V(1 g |- X )0)) a' _w_v;
        <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">related to non-variance when unit pull the input, commonly  ( 1 o&gt; h ) ~~ h  *</span><span style="font-weight: bold; font-style: italic;">*)</span>
        polyV_relT_unitV : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A X</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~ a2 -&gt;
                                                     @IdenT _ a1 ~~ DesIdenObRT (dat.-V(1 @unitV_relT _ A |- X )0) a2;
        <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">related to non-variance when unit push the output, commonly  ( (f _i) o&gt; 1 ) ~~ (f _i)  , </span>
<span style="font-weight: bold; font-style: italic;">       therefore polyV is injective *</span><span style="font-weight: bold; font-style: italic;">*)</span>
        polyV_relT_inputUnitV : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obT) (<span style="font-weight: bold; font-style: italic;">B A</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">f</span> : T(0 V |- V(0 B |- A )0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">_v</span>,
                                  f _v ~~ DesIdenObLT( V(1 f |- A )0 &lt;&lt;o  unitV_relT) _v;
        CongDes : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 U |- [0 V ~&gt; W ]0 )0),
                    f' ~~ f -&gt; Des f' ~~ Des f ;
        Des_Cons : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 (0 U &amp; V )0 |-  W )0),
                     Des (Cons f) ~~ f ;
        Des_Output : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U |- [0 V ~&gt; W ]0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> W' (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- W' )0),
                       Des( [0 V ~&gt; w ]1 &lt;o v ) ~~ w &lt;o Des( v ) ;
        CongCons : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 (0 U &amp; V )0 |- W )0 ),
                     v' ~~ v -&gt; Cons v' ~~ Cons v ;
        Cons_Des : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 U |-  [0 V ~&gt; W ]0 )0),
                     Cons (Des f) ~~ f ;
        Cons_Input : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV dat, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U U'</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 U' |- U )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV dat) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 (0 U &amp; V )0 |- W )0),
                       Cons(v &lt;o (1 w &amp; V )0 )  ~~ Cons( v ) &lt;o w ;
        Assoc_Rev : <span style="font-weight: bold; text-decoration: underline;">forall</span>{<span style="font-weight: bold; font-style: italic;">V W U</span> : obV dat},
                      V(0 (0(0U &amp; V )0 &amp; W )0 |- (0U &amp; (0V &amp; W )0 )0 )0;
        Assoc_Assoc_Rev : <span style="font-weight: bold; text-decoration: underline;">forall</span>(<span style="font-weight: bold; font-style: italic;">V W U</span> : obV dat),
                            1 ~~ (Assoc_Rev &lt;o (@Assoc dat V W U));
        Assoc_Rev_Assoc : <span style="font-weight: bold; text-decoration: underline;">forall</span>(<span style="font-weight: bold; font-style: italic;">V W U</span> : obV dat),
                            1 ~~ ((@Assoc dat V W U) &lt;o Assoc_Rev);
      }.

  <span style="font-weight: bold;">Arguments</span> ReflV {_ _} _ _ _ .
  <span style="font-weight: bold;">Arguments</span> TransV {_ _} _ _ _ _ _ _ _ .
  <span style="font-weight: bold;">Arguments</span> SymV {_ _} _ _ _ _ _ .
  <span style="font-weight: bold;">Arguments</span> Cong_polyV_relT {_ _} [_ _ _ _ _ _ _ _]  _ _ _ .
  <span style="font-weight: bold;">Arguments</span> polyV_relT_arrow {_ _} {_ _ _ _} _ _ {_ _ _} _ _ .
  <span style="font-weight: bold;">Arguments</span> polyV_relT_morphism {_ _} {_ _ _ _ _} _ _ {_} _ _ .
  <span style="font-weight: bold;">Arguments</span> polyV_relT_unitV {_ _} [_ _ _ _] _ .
  <span style="font-weight: bold;">Arguments</span> polyV_relT_inputUnitV {_ _} {_ _ _} _ _ .
  <span style="font-weight: bold;">Arguments</span> CongDes {_ _} [_ _ _ _ _] _ .
  <span style="font-weight: bold;">Arguments</span> Des_Cons {_ _} [_ _ _] _ .
  <span style="font-weight: bold;">Arguments</span> Des_Output {_ _} [_ _ _ _ _] _ .
  <span style="font-weight: bold;">Arguments</span> CongCons {_ _} [_ _ _] _ _ _.
  <span style="font-weight: bold;">Arguments</span> Cons_Des {_ _} [_ _ _ _] .
  <span style="font-weight: bold;">Arguments</span> Cons_Input {_ _} [_ _ _ _ _] _ .
  <span style="font-weight: bold;">Arguments</span> Assoc_Rev {_ _} {_ _ _} .

  <span style="font-weight: bold;">Structure</span> <span style="font-weight: bold;">logic</span> :=
    Logic {
        data_of :&gt; data;
        class_of :&gt; @class data_of
      }.

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">not critical, only for easy proofs without doing (class_of _) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">Existing Instance</span> <span style="font-weight: bold;">class_of</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relT_arrow_simpl</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obV log) (<span style="font-weight: bold; font-style: italic;">V V'</span> : obT) (<span style="font-weight: bold; font-style: italic;">v</span> : V' -&gt; V),
                                   <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V -&gt; V(0 B |- A )0 ) (<span style="font-weight: bold; font-style: italic;">X</span> : obV log),
                                   <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a</span> : V(0 A |- X )0) a0, a ~~ a0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">_v'</span> : V'),
                                                                        V(1 f &lt;&lt;o v |- X )0 a _v'
                                                                         ~~   V(1 f |- X )0 a0 (v _v').
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> polyV_relT_arrow. assumption.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relT_unitV_simpl</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A X</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~ a2 -&gt; ( @idT (V(0 A |- X )0)  ) a1 ~~ ( V(1I (@IdenV _ A) |- X )0 ) a2.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> polyV_relT_unitV. assumption.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relT_inputUnitV_simpl</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log),
                                        <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : V(0 B |- A )0),  b  ~~ ( (V(1I b |- A )0)  (@IdenV _ A) ).
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> polyV_relT_inputUnitV <span style="font-weight: bold; text-decoration: underline;">with</span> (f:=(<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; b)).
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">ConsIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0 -&gt; V(0 U0 |- [0 U1 ~&gt; [0 V ~&gt; W ]0 ]0 )0 .
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> Cons. <span style="text-decoration: underline;">apply</span> Cons. <span style="font-weight: bold;">Check</span> @Assoc. <span style="text-decoration: underline;">eapply</span> polyV_relT_identitary. <span style="text-decoration: underline;">eapply</span> Des.  2:  <span style="text-decoration: underline;">eapply</span> Assoc_Rev. exact X.
    <span style="font-weight: bold;">Defined</span>.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyV_relV</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
                               V(0 U |- [0 W ~&gt; V ]0 )0 -&gt;
                               <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log, V(0 [0 V ~&gt; X ]0  |- [0 U ~&gt; [0 W ~&gt; X ]0 ]0 )0 .
      <span style="text-decoration: underline;">intros</span> ? ? ? v ?.  exact  (ConsIn( [1 Des v ~&gt; X]0)).
    <span style="font-weight: bold;">Defined</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongConsIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0),
                         v' ~~ v -&gt; ConsIn v' ~~ ConsIn v .
    Admitted.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">DesIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}, <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log}, V(0 U0 |- [0 U1 ~&gt; [0 V ~&gt; W ]0 ]0 )0 -&gt; V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">apply</span> Cons. <span style="text-decoration: underline;">eapply</span> polyV_relT_identitary. <span style="font-weight: bold;">Check</span> @Assoc. 2: <span style="text-decoration: underline;">eapply</span> Assoc. <span style="text-decoration: underline;">eapply</span> Des.
      <span style="text-decoration: underline;">eapply</span> Des. exact X.
    <span style="font-weight: bold;">Defined</span>.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">polyV_relT_constant_rel_identitary  :  b o&gt; a ~~ a &lt;o b </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relT_constant_rel_identitary</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log) , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log) ,
                                                <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">a</span> : V(0 A |- X )0),  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">b</span> : V(0 B |- A )0),
                                                  @polyV_relT_constant log B A b X a  ~~  a &lt;o b .
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">unfold</span> polyV_relT_identitary. <span style="text-decoration: underline;">unfold</span> polyV_relT_constant.
      <span style="text-decoration: underline;">intros</span>.  <span style="text-decoration: underline;">eapply</span> (@polyV_relT_arrow _ log) <span style="font-weight: bold; text-decoration: underline;">with</span> (f := <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">b0</span> =&gt; b0) (v := <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; b). <span style="text-decoration: underline;">eapply</span> ReflV.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cong_polyV_relT_constant</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log),
                                     <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 B |- A )0), f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log,
                                                                        <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">a1 a2</span>, a1 ~~ a2 -&gt; @polyV_relT_constant log B A f' X a1 ~~  @polyV_relT_constant _ B A f X a2.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span>  (@Cong_polyV_relT _ log)  <span style="font-weight: bold; text-decoration: underline;">with</span> (f:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; f)  (f':=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; f'); <span style="text-decoration: underline;">intros</span>; assumption.
    <span style="font-weight: bold;">Qed</span>.
    <span style="font-weight: bold;">Arguments</span> Cong_polyV_relT_constant [_ _ _ _ _ _ _] _ _ .

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongCom_identitary</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A2 A3</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f2 f2'</span> : V(0 A2 |- A3 )0), f2 ~~ f2' -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1</span>, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f1 f1'</span> : V(0 A1 |- A2 )0), f1 ~~ f1' -&gt; f2 &lt;o f1 ~~ f2' &lt;o f1'.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> polyV_relT_constant_rel_identitary |].
      <span style="text-decoration: underline;">eapply</span> TransV; [| <span style="text-decoration: underline;">eapply</span> SymV, polyV_relT_constant_rel_identitary].
      <span style="text-decoration: underline;">eapply</span> Cong_polyV_relT_constant;  assumption.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongCom_constant</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A2 A3</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f2 f2'</span> : V(0 A2 |- A3 )0), f2 ~~ f2' -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A1</span>, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f1 f1'</span> : V(0 A1 |- A2 )0), f1 ~~ f1' -&gt; f1 o&gt; f2 ~~ f1' o&gt; f2'.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> Cong_polyV_relT_constant;  assumption.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relT_morphism_simpl</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log), 
                                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 A |- A')0),
                                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">X</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">pull</span> : V(0 B |- A)0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">push</span> : V(0 A'  |- X )0 ),
                                        V(1I V(0 A' |- g )1 pull |- X )0 push
                                         ~~ V(0 X |- V(1I g |- X )0 push )1 pull.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">generalize</span> (@polyV_relT_morphism log log). <span style="text-decoration: underline;">intros</span> H_polyV_relT_morphism.
      <span style="text-decoration: underline;">specialize</span> H_polyV_relT_morphism <span style="font-weight: bold; text-decoration: underline;">with</span> (V:=unit)(B:=B)(A:=A)(W:=unit)(g:=(<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; g))(f:=(<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; pull))(X:=X)(a':=push)(_w_v:=(tt,tt)).
      <span style="text-decoration: underline;">unfold</span> polyV_relT_constant. <span style="text-decoration: underline;">unfold</span> polyV_relT_identitary.
      <span style="text-decoration: underline;">unfold</span> DesInT, DesT, ConsT, AssocT, polyT_relT_identitary, polyT_relT, consT10, consT01, idT, cstT <span style="font-weight: bold; text-decoration: underline;">in</span> H_polyV_relT_morphism.
      <span style="text-decoration: underline;">eapply</span> TransV <span style="font-weight: bold; text-decoration: underline;">in</span> H_polyV_relT_morphism; [|<span style="text-decoration: underline;">eapply</span> polyV_relT_arrow <span style="font-weight: bold; text-decoration: underline;">with</span> (f := idT); <span style="text-decoration: underline;">eapply</span> ReflV].
      <span style="text-decoration: underline;">unfold</span> DesInT, DesT, ConsT, AssocT, polyT_relT_identitary, polyT_relT, consT10, consT01, idT, cstT <span style="font-weight: bold; text-decoration: underline;">in</span> H_polyV_relT_morphism.
      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">remember that polyV_relT_arrow , relate in particular the polyV_relT_constant to polyV_relT_identitary </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">eapply</span> SymV, TransV, SymV <span style="font-weight: bold; text-decoration: underline;">in</span> H_polyV_relT_morphism; [|<span style="text-decoration: underline;">eapply</span> polyV_relT_arrow <span style="font-weight: bold; text-decoration: underline;">with</span> (f:=idT); <span style="text-decoration: underline;">eapply</span> ReflV].
      <span style="text-decoration: underline;">eapply</span> TransV; [| <span style="text-decoration: underline;">eapply</span> polyV_relT_arrow <span style="font-weight: bold; text-decoration: underline;">with</span> (v:=<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; (V(1 idT |- _ )0) g pull) (f:=idT); <span style="text-decoration: underline;">eapply</span> ReflV].
      <span style="text-decoration: underline;">unfold</span> DesInT, DesT, ConsT, AssocT, polyT_relT_identitary, polyT_relT, consT10, consT01, idT, cstT <span style="font-weight: bold; text-decoration: underline;">in</span> H_polyV_relT_morphism |- *.
      <span style="text-decoration: underline;">eapply</span> H_polyV_relT_morphism.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongDesIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 U0 |- [0 U1 ~&gt; [0 V ~&gt; W ]0 ]0 )0),
                        v' ~~ v -&gt; DesIn v' ~~ DesIn v.
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">ConsIn_DesIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 U0 |- [0 U1 ~&gt; [0 V ~&gt; W ]0 ]0 )0),
                           ConsIn (DesIn f) ~~ f .
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">DesIn_Input</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U0 |- [0 U1 ~&gt; [0 V ~&gt; W ]0 ]0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">i</span> : V(0 U0' |- U0 )0),
                          (DesIn v) &lt;o i ~~ DesIn( v &lt;o i ) .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Des_Input</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U U'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 U' |- U )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U |- [0 V ~&gt; W ]0 )0), 
                        Des( v &lt;o w ) ~~ Des( v ) &lt;o desV10 V w .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">ConsIn_Output</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U1 U1'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">u1</span> : V(0 U1' |- U1 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0),
                            ConsIn( [1 (1 u1 &amp; V )0 ~&gt; W ]0 &lt;o v ) ~~ [1 u1 ~&gt; [0 V ~&gt; W ]0 ]0 &lt;o ConsIn( v ) .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongConsV01</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V2 V2'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 V2 |- V2' )0),
                          v' ~~ v -&gt; [0 V1 ~&gt; v' ]1 ~~ [0 V1 ~&gt; v ]1 .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">ConsIn_Input</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">i</span> : V(0 U0' |- U0 )0),
                           ConsIn( v &lt;o i ) ~~ (ConsIn v) &lt;o i .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">consV01_functorial</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> V2 V2' (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V2 |- V2' )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> V2'' (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V2' |- V2'' )0),
                                 [0 V1 ~&gt; v' &lt;o v ]1 ~~  [0 V1 ~&gt; v' ]1 &lt;o  [0 V1  ~&gt; v ]1 .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">DesIn_ConsIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0 U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0),
                           DesIn (ConsIn f) ~~ f.
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Assoc_Iso</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U</span>: obV log),
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Y X</span> : obV log) (<span style="font-weight: bold; font-style: italic;">f g</span> : V(0 Y |-  [0 (0 ((0 U &amp; V )0) &amp; W )0 ~&gt; X ]0 )0 ), 
                        [1 Assoc ~&gt; X ]0 &lt;o f ~~ [1 Assoc  ~&gt; X ]0 &lt;o g -&gt; f ~~ g .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Assoc_nat0</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U U'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 U |- U' )0 ),
                         Assoc &lt;o (1 f &amp; (0 V &amp; W )0 )0 ~~ (1 ((1 f &amp; V )0) &amp; W )0 &lt;o Assoc .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Des_consV10_functorial</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> V B PA (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- [0 B ~&gt; PA ]0 )0) PA' QA (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 [0 B ~&gt; PA ]0 |- [0 B ~&gt; QA ]0 )0) ,
                                     (Des ([1 Des (g &lt;o f) ~&gt; PA' ]0 ))
                                       ~~ ( ( Des (Des ([1 f ~&gt; [0 B ~&gt; PA' ]0 ]0 &lt;o ConsIn ([1 Des (g) ~&gt; PA' ]0))) ) &lt;o Assoc
                                            : V(0 (0 ([0 QA ~&gt; PA' ]0) &amp; (0V &amp; B )0 )0 |- PA' )0 ).
    Admitted.
    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">Lemma Assoc_Des_Des_old : forall V B PA PA' (f : V(0 V |- [0 B ~&gt; PA ]0 )0),</span>
<span style="font-weight: bold; font-style: italic;">                                     ( (Des ([1 Des f ~&gt; PA' ]0 )) : V(0 (0 ([0 PA ~&gt; PA' ]0) &amp; (0V &amp; B )0 )0 |- PA' )0 )</span>
<span style="font-weight: bold; font-style: italic;">                                       ~~ ( ( Des (Des ([1 f ~&gt; [0 B ~&gt; PA' ]0 ]0 &lt;o ConsIn ([1 Des (@IdenV ([0 B ~&gt; PA ]0)) ~&gt; PA' ]0))) ) &lt;o Assoc )\; *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Assoc_DesIn_DesIn</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">W PX</span>, <span style="font-weight: bold; text-decoration: underline;">forall</span>  V B PA (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- [0 B ~&gt; PA ]0 )0),
                                 DesIn ([0 W ~&gt;  ([1 Des f ~&gt; PX ]0) ]1)
                                       ~~ [1 Assoc ~&gt; PX ]0 &lt;o DesIn( DesIn ([0 W ~&gt;  ConsIn([1 Des f ~&gt; PX ]0) ]1) ) .
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cons_Output</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> :  V(0 (0 U &amp; V )0 |-  W )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> W' (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- W' )0),
                          [0 V ~&gt; w ]1 &lt;o Cons( v ) ~~ Cons( w &lt;o v ) .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">ConsIn_Output2</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U0</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U1</span> : obV log) , <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- W' )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U0 |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0),
                             ConsIn( [0 (0 U1 &amp; V )0 ~&gt; w ]1 &lt;o v ) ~~ [0 U1 ~&gt; [0 V ~&gt; w ]1 ]1 &lt;o ConsIn( v ) .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">ConsIn_consV10_functorial</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> V B PA (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- [0 B ~&gt; PA ]0 )0) PA' QA (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 [0 B ~&gt; PA ]0 |- [0 B ~&gt; QA ]0 )0),
                                        ( ConsIn (([1 Des (g &lt;o f) ~&gt; PA' ]0)) )
                                          ~~ ( ([1 f ~&gt; [0 B ~&gt; PA' ]0 ]0 &lt;o ConsIn ([1 Des (g) ~&gt; PA' ]0))
                                               : V(0 [0 QA ~&gt; PA' ]0 |- [0 V ~&gt; [0 B ~&gt; PA' ]0 ]0 )0 ) .
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Des_I_Iso</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log),
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Y X</span> : obV log) (<span style="font-weight: bold; font-style: italic;">f g</span> : V(0 Y |-  [0  A ~&gt; X ]0 )0 ), 
                        [1 Des (@IdenV _ ([0 I ~&gt; A ]0)) ~&gt; X ]0 &lt;o f ~~ [1  Des (@IdenV _ ([0 I ~&gt; A ]0))  ~&gt; X ]0 &lt;o g -&gt; f ~~ g .
    Admitted.
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations3</span>.
    <span style="font-weight: bold;">Export</span> Ex_Notations2.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V[1 v ~&gt; X ]0"</span> := (@polyV_relV dat _ _ _ v X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V[0 X ~&gt; w ]1"</span> := ((@polyV_relV dat _ _ _ 1 X) &lt;`dat`&lt;o w) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-V[0 W ~&gt; - ]1"</span> := (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">V X</span> =&gt; @polyV_relV dat _ _ _ (@IdenV dat (dat.-V[0 W ~&gt; V ]0)) X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations3</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations3.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V[1 v ~&gt; X ]0"</span> := (_ .-V[1 v ~&gt; X ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V[0 X ~&gt; w ]1"</span> := (_ .-V[0 X ~&gt; w ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"V[0 W ~&gt; - ]1"</span> := (_ .-V[0 W ~&gt; - ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context2</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relV_polyV_relT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U</span> : obV log) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
                                  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 U |- [0 W ~&gt; V ]0 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log,
                                    [1 Des v ~&gt; X]0
                                                  ~~ DesIn( V[1 v ~&gt; X ]0 ) .
    Admitted.

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">TODO: PUT IN DATA OR CLASS *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">CongDesIdenObR</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 U |- [0 I ~&gt; W ]0 )0),
                             v' ~~ v -&gt; DesIdenObR v' ~~ DesIdenObR v .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">DesIdenObR_output</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U</span> : obV log) (<span style="font-weight: bold; font-style: italic;">W W'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W |- W' )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">v</span> : V(0 U |- [0 I ~&gt; W ]0 )0, 
                                DesIdenObR( [0 I ~&gt; w ]1 &lt;o v ) ~~ w &lt;o DesIdenObR( v ) .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">DesIdenObR_Input</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">U'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 U' |- U )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">v</span> : V(0 U |- [0 I ~&gt; W ]0 )0, 
                               DesIdenObR( v &lt;o w ) ~~ DesIdenObR( v ) &lt;o w .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">DesIdenObRInCons</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U W</span> : obV log),
                               [1 DesIdenObR (Cons (@IdenV _ ((0 U &amp; I )0))) ~&gt; W ]0 ~~
                                                                                   ([0 U ~&gt; DesIdenObR (@IdenV _ ([0 I ~&gt; W ]0)) ]1 &lt;o
                                                                                                                                       ConsIn (@IdenV _ ([0 (0 U &amp; I )0 ~&gt; W ]0)) 
                                                                                    : V(0 [0 (0 U &amp; I )0 ~&gt; W ]0 |- [0 U ~&gt; W ]0 )0 ) .

    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">CongDesIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 I |- [0 V ~&gt; W ]0 )0),
                             v' ~~ v -&gt; DesIdenObL v' ~~ DesIdenObL v .
    <span style="font-weight: bold;">Parameter</span> <span style="font-weight: bold; font-style: italic;">ConsIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), V(0 V |- W )0 -&gt; V(0 I |- [0 V ~&gt; W ]0 )0 .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">ConsIdenObL_DesIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">v</span> : V(0 I |- [0 V ~&gt; W ]0 )0,
                                     v ~~ ConsIdenObL( DesIdenObL v) .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">DesIdenObR_ConsIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">v</span> : V(0 I |- V )0,
                                     v ~~ DesIdenObR( ConsIdenObL v) .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">Des_ConsIn</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">U1 W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 I |- [0 (0 U1 &amp; V )0 ~&gt; W ]0 )0),
                          DesIdenObL (v) ~~ Des (DesIdenObL (ConsIn (v))).
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">DesIdenObRConsIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V W</span> : obV log),
                                    (@IdenV log ([0 V ~&gt; W ]0)) ~~ DesIdenObR (ConsIn ([1 Des (ConsIdenObL 1) ~&gt;  W ]0)).
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">CongConsIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 V |- W )0),
                              v' ~~ v -&gt; ConsIdenObL v' ~~ ConsIdenObL v .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">consV10_functorial</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V1' V1</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> :  V(0 V1' |- V1 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> V1'' (<span style="font-weight: bold; font-style: italic;">v'</span> : V(0 V1'' |- V1' )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obV log,
                                 [1 v &lt;o v' ~&gt; V2 ]0 ~~  [1 v' ~&gt; V2 ]0 &lt;o  [1 v ~&gt; V2 ]0 .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">consV11_bifunctorial</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V1' V1</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V1' |- V1 )0), <span style="font-weight: bold; text-decoration: underline;">forall</span> W1 W1' (<span style="font-weight: bold; font-style: italic;">w</span> : V(0 W1 |- W1' )0),
                                   [0 V1' ~&gt; w ]1 &lt;o  [1 v ~&gt; W1 ]0 ~~ [1 v ~&gt; W1' ]0 &lt;o [0 V1 ~&gt; w ]1 .
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">CongConsV10</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V1' V1</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v v'</span> : V(0 V1' |- V1)0), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obV log,
                          v' ~~ v -&gt; [1 v' ~&gt; V2 ]0 ~~ [1 v ~&gt; V2 ]0 .


    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">consV10_DesIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">U</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V</span> : obV log, <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">W</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 I |- [0 V ~&gt; W ]0 )0), 
                                 [1 DesIdenObL  v ~&gt; U ]0  ~~ DesIdenObR( ConsIn( [1 Des v ~&gt; U ]0 ) ) .  <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">/!\SAME/!\</span><span style="font-weight: bold; font-style: italic;">*)</span><span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">DesIdenObR_DesIdenObL</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> ( <span style="font-weight: bold; font-style: italic;">V W X</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 I |- [0 V ~&gt; W ]0 )0),
                                                                                                                                                        [1 DesIdenObL v ~&gt; X ]0 ~~ DesIdenObR (ConsIn ([1 Des v ~&gt; X ]0)) .

    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">consV10_functorial_fun1</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V1</span>, <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V2</span> : obV log,
                                      (@IdenV _ _) ~~    [1 (@IdenV _ V1) ~&gt; V2 ]0 .


    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">remember that  unitV is not really primitive *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Axiom</span> <span style="font-weight: bold; font-style: italic;">unitV_IdenV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A</span> : obV log,  (@IdenV log A) ~~ DesIdenObL (@unitV log A).

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">even/same for these that the decision are recursively-decidable because still purely logical after unfolding polyV_relV *</span><span style="font-weight: bold; font-style: italic;">*)</span> 
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">CongPolyV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V B A</span> : obV log) (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 V |- V[0 B ~&gt; A ]0 )0),
                        f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log, V[1 f' ~&gt; X ]0 ~~ V[1 f ~&gt; X ]0 .
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relV_arrow</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A</span> : obV log) (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),
                              <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0),
                              <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- [0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obV log),
                                V[1 (f &lt;o v) ~&gt; X ]0
                                 ~~ [1 v ~&gt; [0 B ~&gt; X ]0 ]0 &lt;o (V[1 f ~&gt;  X ]0) .
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relV_morphism</span> :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V B A W A'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 W |-V[0 A ~&gt; A' ]0 )0)
                                   (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- V[0 B ~&gt; idT A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obV log),
                                   V[1 Des ([1 f ~&gt; [0 B ~&gt; idT A' ]0 ]0 &lt;o V[0 A' ~&gt; g ]1) ~&gt; X ]0 ~~
                                    DesIn ([0 W ~&gt; V[1 f ~&gt; X ]0 ]1 &lt;o V[1 g ~&gt; X ]0) .
    Admitted.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relV_unitV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obV log, (@IdenV log (V[0 A ~&gt; X ]0)) ~~ DesIdenObR( V[1 (@unitV log A) ~&gt; X ]0 ) .
    Admitted.
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyV_relV_inputUnitV</span> :<span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log),  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obV log),  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obV log),
                                 <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- V[0 B ~&gt; A ]0 )0),
                                   f  ~~ DesIdenObL( (V[1 f ~&gt; A ]0) &lt;o (@unitV log A) ).
    Admitted.


    <span style="font-weight: bold; font-style: italic;">(**  </span><span style="font-weight: bold; font-style: italic;">Section: common categories </span><span style="font-weight: bold; font-style: italic;">*)</span>

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">ComV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V1</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">UCom</span>, V(0 V1 |-  UCom )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">V3</span>, V(0 UCom |- V3 )0 -&gt; V(0 V1 |- V3 )0 := polyV_relT_constant .

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">CongCom</span> := (@CongCom_identitary).

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cat2V</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A3 A4</span> : obV log) (<span style="font-weight: bold; font-style: italic;">f3</span> : V(0 A3 |- A4)0), <span style="font-weight: bold; text-decoration: underline;">forall</span> A2 (<span style="font-weight: bold; font-style: italic;">f2</span> : V(0 A2 |- A3)0), <span style="font-weight: bold; text-decoration: underline;">forall</span> A1 (<span style="font-weight: bold; font-style: italic;">f1</span> : V(0 A1 |- A2)0),
                    (f3 &lt;o f2) &lt;o f1 ~~ f3 &lt;o (f2 &lt;o f1).
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> polyV_relT_constant_rel_identitary  |].
      <span style="text-decoration: underline;">eapply</span> TransV; [| <span style="text-decoration: underline;">eapply</span> CongCom; [|<span style="text-decoration: underline;">eapply</span> ReflV]; <span style="text-decoration: underline;">eapply</span> SymV, polyV_relT_constant_rel_identitary  ].
      <span style="text-decoration: underline;">apply</span> SymV, polyV_relT_morphism_simpl.
      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">OLD DEFINITIONALLY intros\; apply SymV, polyV_relT_morphism\; </span><span style="font-weight: bold; font-style: italic;">*)</span> 
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cat1RightV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">f</span> : V(0 A1 |- A2)0,  f ~~ f &lt;o 1.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> polyV_relT_constant_rel_identitary |].
      <span style="text-decoration: underline;">apply</span> polyV_relT_unitV.
      <span style="text-decoration: underline;">apply</span> ReflV.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">Cat1LeftV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1 A2</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">f</span> : V(0 A1 |- A2)0,  f ~~ 1 &lt;o f.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>. <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> polyV_relT_constant_rel_identitary |].
      <span style="text-decoration: underline;">apply</span> polyV_relT_inputUnitV_simpl. 
    <span style="font-weight: bold;">Qed</span>.      
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context2</span>.

  <span style="font-weight: bold;">Canonical Structure</span> <span style="font-weight: bold;">logT</span> : logic :=
    @Logic _ (@<span style="font-weight: bold;">Class</span>
                (@Data obT polyT_relT00 convT polyT_relT 
                       (@IdenT) consT00 (@consT01) consT10 desT00 desT10 ConsT DesT
                       IdenObT (@unitT) (@AssocT) (@DesIdenObRT) (@DesIdenObLT))
                ReflT TransT SymT Cong_polyT_relT polyT_relT_arrow
                polyT_relT_morphism polyT_relT_unitT polyT_relT_inputUnitT CongDesT
                Des_ConsT Des_OutputT CongConsT Cons_DesT Cons_InputT (@Assoc_RevT) Assoc_Assoc_RevT Assoc_Rev_AssocT).
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">LOGIC</span>.
</pre>
</div>
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">FUNCTOR</span>.
  <span style="font-weight: bold;">Export</span> LOGIC.
  <span style="font-weight: bold;">Set Implicit Arguments</span>.
  Unset <span style="font-weight: bold;">Strict Implicit</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Record</span> <span style="font-weight: bold;">data</span> :=
      Data {
          <span style="font-weight: bold; font-style: italic;">obA</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>;
          polyA00 : obA -&gt; obA -&gt; obV log;
          polyA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A2</span> : obA), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1</span> : obA),
                    V(0 V |- (polyA00 A2 A1) )0 -&gt;
                    <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA, V(0 (polyA00 A1 X)  |- [0 V ~&gt; (polyA00 A2 X) ]0 )0;
          obB : <span style="font-weight: bold; text-decoration: underline;">Type</span>;
          polyB00 : obB -&gt; obB -&gt; obV log;
          polyB : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B2</span> : obB),  <span style="font-weight: bold; text-decoration: underline;">forall</span>(<span style="font-weight: bold; font-style: italic;">B1</span> : obB),
                    V(0 V |- (polyB00 B2 B1) )0 -&gt;
                    <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">Y</span> : obB, V(0 (polyB00 B1 Y)  |- [0 V ~&gt; (polyB00 B2 Y) ]0 )0;
          polyF0 : obA -&gt; obB;
          polyF : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB) (<span style="font-weight: bold; font-style: italic;">A</span> : obA),
                    V(0 V |- (polyB00 B (polyF0 A)) )0 -&gt;
                    <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA, V(0 (polyA00 A X)  |- [0 V ~&gt; (polyB00 B (polyF0 X)) ]0 )0;
          unitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">A</span> : obA}, V(0 I |- (polyA00 A A) )0;
        }.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations3</span>.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-A[0 A1 ~&gt; A2 ]0"</span> := (@polyA00 _ dat A1 A2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-A[0  A1  ~&gt;  A2  ]0"</span>).
    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">therefore "A[1 f ~&gt; X ]0" is similar to ( f _3 o&gt; _2 ) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-A[1 f ~&gt; X ]0"</span> := (@polyA _ dat _ _ _ f X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-A[1  f  ~&gt;  X  ]0"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-uA"</span> := (@unitA _ dat _) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0, format <span style="font-style: italic;">"dat .-uA"</span>).

    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-B[0 B1 ~&gt; B2 ]0"</span> := (@polyB00 _ dat B1 B2) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-B[0  B1  ~&gt;  B2  ]0"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-B[1 m ~&gt; Y ]0"</span> := (@polyB _ dat _ _ _ m Y) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-B[1  m  ~&gt;  Y  ]0"</span>).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations3</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations3.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"A[0 A1 ~&gt; A2 ]0"</span> := (_  .-A[0 A1 ~&gt; A2 ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"A[1 f ~&gt; X ]0"</span> := (_.-A[1 f ~&gt; X ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"'uA'"</span> := (_ .-uA) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"B[0 B1 ~&gt; B2 ]0"</span> := (_.-B[0 B1 ~&gt; B2 ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"B[1 m ~&gt; Y ]0"</span> := (_.-B[1 m ~&gt; Y ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context2</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.
    Context {<span style="font-weight: bold; font-style: italic;">dat</span> : @data log}.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyA_IdenV</span>  : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                              <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA dat, V(0 A[0 A ~&gt; X ]0  |- [0 A[0 B ~&gt; A ]0 ~&gt; A[0 B ~&gt; X ]0 ]0 )0
      := (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">B A X</span> =&gt; @polyA _ _ (A[0 B ~&gt; A ]0) B A (@IdenV _ (A[0 B ~&gt; A ]0)) X).

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyB_IdenV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obB dat),
                             <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obB dat, V(0 B[0 A ~&gt; X ]0  |- [0 B[0 B ~&gt; A ]0 ~&gt; B[0 B ~&gt; X ]0 ]0 )0
      := (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">B A X</span> =&gt; @polyB _ _ (B[0 B ~&gt; A ]0) B A (@IdenV _ (B[0 B ~&gt; A ]0)) X).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context2</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations4'</span>.
    <span style="font-weight: bold;">Export</span> Ex_Notations3.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-A[0 B ~&gt; - ]1"</span> := (@polyA_IdenV _ dat B) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format  <span style="font-style: italic;">"dat .-A[0  B  ~&gt;  -  ]1"</span>).
    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">therefore "A[0 X ~&gt; g ]1" is similar to the common ( _ &lt;o g ) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-A[0 X ~&gt; a ]1"</span> := ( (dat.-A[0 _ ~&gt; - ]1) _ X &lt;o (<span style="font-weight: bold; font-style: italic;">a</span> : V(0 _ |- dat.-A[0 _ ~&gt; X ]0 )0)) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-A[0  X  ~&gt;  a  ]1"</span>).      

    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-B[0 B ~&gt; - ]1"</span> := (@polyB_IdenV _ dat B) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-B[0  B  ~&gt;  -  ]1"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-B[0 Y ~&gt; n ]1"</span> := ( (dat.-B[0 _ ~&gt; - ]1) _ Y &lt;o (<span style="font-weight: bold; font-style: italic;">n</span> : V(0 _ |- dat.-B[0 _ ~&gt; Y ]0 )0)) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-B[0  Y  ~&gt;  n  ]1"</span>).

    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-F|0 A"</span> := (@polyF0 _ dat A) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 4, <span style="text-decoration: underline;">right</span> associativity, format <span style="font-style: italic;">"dat .-F|0  A"</span>).
    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">:^) *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-F[0 B ~&gt; A ]0"</span> := (dat.-B[0 B ~&gt; (dat.-F|0 A) ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-F[0  B  ~&gt;  A  ]0"</span>).
    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">therefore "F[1 b ~&gt; X ]0" is similar to   ( b o&gt; ( F|1 _ ) )   , alternatively   ( b o&gt;F _ )   *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-F[1 b ~&gt; X ]0"</span> := (@polyF _ dat _ _ _ b X) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-F[1  b  ~&gt;  X  ]0"</span>).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations4'</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations4'.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"A[0 B ~&gt; - ]1"</span> := (_ .-A[0 B ~&gt; - ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"A[0 X ~&gt; g ]1"</span> := (_.-A[0 X ~&gt; g ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"B[0 B ~&gt; - ]1"</span> := (_ .-B[0 B ~&gt; - ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"B[0 Y ~&gt; n ]1"</span> := (_.-B[0 Y ~&gt; n ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"F|0 A"</span> := (_ .-F|0 A) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 4, <span style="text-decoration: underline;">right</span> associativity).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"F[0 B ~&gt; A ]0"</span> := (_ .-F[0 B ~&gt; A ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"F[1 b ~&gt; X ]0"</span> := (_ .-F[1 b ~&gt; X ]0) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context3</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.
    Context {<span style="font-weight: bold; font-style: italic;">dat</span> : @data log}.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyF_IdenV</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat) (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                             <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA dat, V(0 A[0 A ~&gt; X ]0  |- [0 F[0 B ~&gt; A ]0 ~&gt; F[0 B ~&gt; X ]0 ]0 )0
      := (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">B A X</span> =&gt; @polyF _ dat (F[0 B ~&gt; A ]0) B A (@IdenV _ (F[0 B ~&gt; A ]0)) X).

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context3</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations4</span>.
    <span style="font-weight: bold;">Export</span> Ex_Notations4'.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-F[0 B ~&gt; - ]1"</span> := (@polyF_IdenV _ dat B) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-F[0  B  ~&gt;  -  ]1"</span>).
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-F[0 X ~&gt; a ]1"</span> := ( (dat.-F[0 _ ~&gt; - ]1) _ X &lt;o (<span style="font-weight: bold; font-style: italic;">a</span> : V(0 _ |- dat.-A[0 _ ~&gt; X ]0 )0)) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25, format <span style="font-style: italic;">"dat .-F[0  X  ~&gt;  a  ]1"</span>).      

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">therefore "F[0 X ~&gt; a ]1" is similar to   ( B[0 B ~&gt; ( F|1 a ) ]1 ) which is ( _ o&gt; ( F|1 a ) )  , alternatively  ( _ o&gt;F a )   *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Check</span> <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic) (<span style="font-weight: bold; font-style: italic;">dat</span> : data) (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat) =&gt;
            ( dat.-F[0 B ~&gt; - ]1 : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A X</span> : obA dat), V(0 dat.-A[0 A ~&gt; X ]0 |- [0 dat.-F[0 B ~&gt; A ]0 ~&gt; dat.-F[0 B ~&gt; X ]0 ]0 )0 ).
    <span style="font-weight: bold;">Check</span> <span style="font-weight: bold; text-decoration: underline;">fun</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic) (<span style="font-weight: bold; font-style: italic;">dat</span> : data) (<span style="font-weight: bold; font-style: italic;">_B</span> : obB dat) (<span style="font-weight: bold; font-style: italic;">_A</span> : obA dat) (<span style="font-weight: bold; font-style: italic;">X</span> : obA dat) (<span style="font-weight: bold; font-style: italic;">_W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">a</span> : V(0 _W |- A[0 _A ~&gt; X ]0 )0) =&gt;
            ( dat.-F[0 X ~&gt; a ]1 : V(0 _W |- [0 dat.-F[0 _B ~&gt; _A ]0 ~&gt; dat.-F[0 _B ~&gt; X ]0 ]0 )0 ).

  <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">Lemma tmp_dkdkd  : forall (log : logic) (dat : data) (_B : obB dat) (_A : obA dat) (X : obA dat) (_W : obV log) (a : V(0 _W |- dat\;-A[0 _A ~&gt; X ]0 )0) ,</span>
<span style="font-weight: bold; font-style: italic;">                       ( @eq (V(0 _W |- [0 dat\;-F[0 _B ~&gt; _A ]0 ~&gt; dat\;-F[0 _B ~&gt; X ]0 ]0 )0)</span>
<span style="font-weight: bold; font-style: italic;">                             (dat\;-F[0 X ~&gt; a ]1)  (@polyF _ dat _ _ _ (@IdenV _ _) X &lt;o (a : V(0 _ |- A[0 _ ~&gt; X ]0 )0)) )\;</span>
<span style="font-weight: bold; font-style: italic;">        reflexivity\;</span>
<span style="font-weight: bold; font-style: italic;">      Qed\; </span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations4</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations4.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"F[0 B ~&gt; - ]1"</span> := (_.-F[0 B ~&gt; - ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"F[0 X ~&gt; a ]1"</span> := (_ .-F[0 X ~&gt; a ]1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 25).

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context4</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">class</span> (<span style="font-weight: bold; font-style: italic;">dat</span> : @data log) :=
      <span style="font-weight: bold;">Class</span> {
          <span style="font-weight: bold; font-style: italic;">CongPolyA</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 V |- A[0 B ~&gt; A ]0 )0),
                        f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA dat, polyA f' X ~~ polyA f X;
          polyA_arrow :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                         <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0),
                         <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- A[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obA dat),
                           A[1 f &lt;o v ~&gt; X ]0
                            ~~ [1 v ~&gt; A[0 B ~&gt; X ]0 ]0 &lt;o A[1 f ~&gt; X ]0;
          polyF_arrow : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat) (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                        <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0),
                        <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- F[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obA dat),
                          F[1 f &lt;o v ~&gt; X ]0
                           ~~ [1 v ~&gt; F[0 B ~&gt; X ]0 ]0 &lt;o F[1 f ~&gt; X ]0;
          polyF_morphism : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat),
                           <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat) (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obA dat) (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 W |- A[0 A ~&gt; A']0 )0),
                           <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |-F[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obA dat),
                             <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">may use ( F[1 f ~&gt; A']0 &lt;o g ) because polyF_arrow is present \;\; may use ( DesIn( _ ) &lt;o _ ) \;\; ConsIn </span><span style="font-weight: bold; font-style: italic;">*)</span>
                             F[1 Des( [1 f ~&gt; F[0 B ~&gt; A' ]0 ]0 &lt;o F[0 A' ~&gt; g ]1 ) ~&gt; X]0
                              ~~  ( DesIn( [0 W ~&gt; F[1 f ~&gt; X ]0 ]1 &lt;o A[1 g ~&gt; X ]0 )
                                    :  V(0 A[0 A' ~&gt; X ]0 |- [0 (0 W &amp; V )0 ~&gt; F[0 B ~&gt; X ]0 ]0 )0 );
          CongPolyF : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat) (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 V |- F[0 B ~&gt; A ]0 )0),
                        f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA dat, polyF f' X ~~ polyF f X;
          polyA_unitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA dat, (@IdenV _ (A[0 A ~&gt; X ]0)) ~~ DesIdenObR( A[1 (@unitA _ dat A) ~&gt; X ]0 );
          polyF_inputUnitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB dat) (<span style="font-weight: bold; font-style: italic;">A</span> : obA dat),
                             <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- F[0 B ~&gt; A ]0 )0),
                               f ~~ DesIdenObL( (F[1 f ~&gt; A ]0) &lt;o (@unitA _ dat A) )
        }.

    Global <span style="font-weight: bold;">Arguments</span> CongPolyA {_ _} [_ _ _ _ _] _ _  .
    Global <span style="font-weight: bold;">Arguments</span> polyA_arrow {_ _} [_ _ _ _] _ _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_arrow {_ _} [_ _ _ _] _ _  _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_morphism {_ _} [_ _ _ _ _] _ _ _ .
    Global <span style="font-weight: bold;">Arguments</span> CongPolyF {_ _} [_ _ _ _ _] _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyA_unitA {_ _} _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_inputUnitA {_ _} [_ _ _] _  .

  <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">(** possible but yoneda does not require polymorphism in B **)</span>
<span style="font-weight: bold; font-style: italic;">      Parameter polyF_morphism_codomain : forall (dat : data) (V : obV log) (B : obB dat),</span>
<span style="font-weight: bold; font-style: italic;">                             forall (A : obA dat) (W : obV log) (B' : obB dat) (b : V(0 W |- B[0 B' ~&gt; B]0 )0),</span>
<span style="font-weight: bold; font-style: italic;">                             forall (f : V(0 V |-F[0 B ~&gt; A ]0 )0) (X : obA dat), (* use ( B[1 b ~&gt; F|0 A ]0 &lt;o f  ) because no polyB_arrow *)</span>
<span style="font-weight: bold; font-style: italic;">                               F[1 Des( B[1 b ~&gt; F|0 A ]0 &lt;o f ) ~&gt; X]0</span>
<span style="font-weight: bold; font-style: italic;">                                ~~ ( DesIn( [0 V ~&gt; B[1 b ~&gt; F|0 X ]0 ]1 &lt;o F[1 f ~&gt; X ]0 )</span>
<span style="font-weight: bold; font-style: italic;">                                        : V(0 A[0 A ~&gt; X ]0 |- [0 (0 V &amp; W )0 ~&gt; F[0 B' ~&gt; X ]0 ]0 )0 ) \;</span>
<span style="font-weight: bold; font-style: italic;">   *</span><span style="font-weight: bold; font-style: italic;">*)</span>
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context4</span>.

  <span style="font-weight: bold;">Coercion</span> dat {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">dat</span> : @data log} (<span style="font-weight: bold; font-style: italic;">ext</span> : @class log dat) := dat.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context5</span>.
    <span style="font-weight: bold;">Variable</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic).

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">printing for documentation</span>
<span style="font-weight: bold; font-style: italic;">    Import LOGIC\;Ex_Notations2\;</span>
<span style="font-weight: bold; font-style: italic;">    Check @polyF : forall (log : logic) (dat : data) (V : obV log) (B : obB dat) (A : obA dat),</span>
<span style="font-weight: bold; font-style: italic;">                     log\;-V(0 V |- dat\;-F[0 B ~&gt; A ]0 )0 -&gt;</span>
<span style="font-weight: bold; font-style: italic;">                     forall X : obA dat, log\;-V(0 dat\;-A[0 A ~&gt; X ]0 |- log\;-[0 V ~&gt; dat\;-F[0 B ~&gt; X ]0 ]0 )0 \; *</span><span style="font-weight: bold; font-style: italic;">*)</span>

    <span style="font-weight: bold;">Structure</span> <span style="font-weight: bold;">functor</span> :=
      Functor {
          data_of :&gt; @data log;
          class_of :&gt; @class _ data_of
        }.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">not critical, only for easy proofs without doing (class_of _) </span><span style="font-weight: bold; font-style: italic;">*)</span>
    Global <span style="font-weight: bold;">Existing Instance</span> <span style="font-weight: bold;">class_of</span>. 
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context5</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context8</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.
    Context {<span style="font-weight: bold; font-style: italic;">dat_</span> : @data log}.
    Context {<span style="font-weight: bold; font-style: italic;">func</span> : @class _ dat_}.

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">for polymorph functor, get this copy-paste same deduction as for polymorph category *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyF_arrowIn</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : obB func) (<span style="font-weight: bold; font-style: italic;">A</span> : obA func),
                          <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V W V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 W |- [0 V' ~&gt; V ]0 )0),
                          <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- F[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obA func),
                            F[1 f &lt;o (Des v) ~&gt; X ]0
                             ~~ DesIn( V[1 v ~&gt; F[0 B ~&gt; X ]0 ]0 &lt;o F[1 f ~&gt; X ]0 ) .
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> DesIn_Input | ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> polyF_arrow ]. 
      <span style="text-decoration: underline;">eapply</span> CongCom; [ | <span style="text-decoration: underline;">eapply</span> ReflV]; <span style="text-decoration: underline;">apply</span> polyV_relV_polyV_relT. 
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyF_natural</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB func) (<span style="font-weight: bold; font-style: italic;">A</span> : obA func) (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- F[0 B ~&gt; A ]0)0),
                          <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Y X</span> : obA func),
                            ( [0 A[0 A ~&gt; Y ]0 ~&gt; F[1 f ~&gt; X ]0 ]1
                              &lt;o A[0 A ~&gt; - ]1 Y X )
                              ~~ ( [1 F[1 f ~&gt; Y ]0 ~&gt; [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 ]0
                                   &lt;o ( V[0 V ~&gt; - ]1 (F[0 B ~&gt; Y ]0) (F[0 B ~&gt; X ]0) ) &lt;o F[0 B ~&gt; - ]1 Y X ) .
    <span style="font-weight: bold;">Proof</span>.
      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">enough ( DesIn( _ ) ~~ DesIn( _ ) ) </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">intros</span>;  <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> TransV | ]; [ <span style="text-decoration: underline;">apply</span> ConsIn_DesIn | <span style="text-decoration: underline;">idtac</span> | <span style="text-decoration: underline;">apply</span> SymV, ConsIn_DesIn].
      <span style="text-decoration: underline;">apply</span> CongConsIn.

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">convert left hand side : outer polyF_morphism then inner polyF_arrow </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">assert</span> ( <span style="font-weight: bold; font-style: italic;">LHS1</span> : F[1 Des( [1 f ~&gt; F[0 B ~&gt; Y ]0 ]0 &lt;o F[0 Y ~&gt; (@IdenV _ (A[0 A ~&gt; Y]0)) ]1 ) ~&gt; X ]0
                       ~~ DesIn( [0 A[0 A ~&gt; Y ]0 ~&gt; F[1 f ~&gt; X ]0 ]1 &lt;o A[0 A ~&gt; - ]1 Y X ) )
        by <span style="text-decoration: underline;">apply</span> polyF_morphism.

      <span style="text-decoration: underline;">assert</span> ( <span style="font-weight: bold; font-style: italic;">LHS2</span> : F[1 Des( F[1 (@IdenV _ (F[0 B ~&gt; A ]0)) &lt;o f ~&gt; Y ]0 ) ~&gt; X ]0
                       ~~ F[1 Des( [1 f ~&gt; F[0 B ~&gt; Y ]0 ]0 &lt;o F[0 Y ~&gt; (@IdenV _ (A[0 A ~&gt; Y ]0)) ]1 ) ~&gt; X ]0 )
        by ( <span style="text-decoration: underline;">apply</span> CongPolyF, CongDes;  <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> Cat2V | ]; <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> Cat1RightV | ];
             <span style="text-decoration: underline;">apply</span> polyF_arrow ).

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">convert right hand side : outer polyV_relV_arrow then outer polyF_arrowIn which is inner form of polyF_arrow </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">assert</span> ( <span style="font-weight: bold; font-style: italic;">RHS1</span> : DesIn( ( V[1 (@IdenV _ (V[0 V ~&gt; (F[0 B ~&gt; Y ]0) ]0)) &lt;o (F[1 f ~&gt; Y ]0) ~&gt; (F[0 B ~&gt; X ]0) ]0 ) &lt;o F[0 B ~&gt; - ]1 Y X )
                           ~~ DesIn( [1 F[1 f ~&gt; Y ]0 ~&gt; [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 ]0 &lt;o ( V[0 V ~&gt; - ]1 (F[0 B ~&gt; Y ]0) (F[0 B ~&gt; X ]0) ) &lt;o F[0 B ~&gt; - ]1 Y X ) )
        by ( <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">eapply</span> CongDesIn; <span style="text-decoration: underline;">eapply</span> Cat2V | ];
             <span style="text-decoration: underline;">apply</span> CongDesIn; <span style="text-decoration: underline;">apply</span> CongCom; [ | <span style="text-decoration: underline;">apply</span> ReflV];
             <span style="text-decoration: underline;">apply</span> polyV_relV_arrow ).

      <span style="text-decoration: underline;">assert</span> ( <span style="font-weight: bold; font-style: italic;">RHS2</span> : ( F[1 (@IdenV _ (F[0 B ~&gt; Y ]0)) &lt;o Des( (@IdenV _ (V[0 V ~&gt; (F[0 B ~&gt; Y ]0) ]0)) &lt;o (F[1 f ~&gt; Y ]0) ) ~&gt; X ]0 )
                        ~~ DesIn( ( V[1 (@IdenV _ (V[0 V ~&gt; (F[0 B ~&gt; Y ]0) ]0)) &lt;o (F[1 f ~&gt; Y ]0) ~&gt; (F[0 B ~&gt; X ]0) ]0 ) &lt;o F[0 B ~&gt; - ]1 Y X ) )
        by <span style="text-decoration: underline;">apply</span> polyF_arrowIn.

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">clean right hand side </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> RHS1 | ] .  <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> RHS2 | ]. <span style="text-decoration: underline;">clear</span> RHS2 RHS1.
      <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> CongPolyF, Cat1LeftV | ]. <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> CongPolyF, CongDes, Cat1LeftV | ].

      <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">clean left hand side </span><span style="font-weight: bold; font-style: italic;">*)</span>
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">apply</span> SymV, LHS1 ] .  <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">apply</span> SymV, LHS2 ]. <span style="text-decoration: underline;">clear</span> LHS2 LHS1.
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">apply</span> CongPolyF, CongDes, CongPolyF, SymV, Cat1LeftV ].

      <span style="text-decoration: underline;">apply</span> ReflV.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">natural</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB func) (<span style="font-weight: bold; font-style: italic;">A</span> : obA func) (<span style="font-weight: bold; font-style: italic;">&#946;</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA func, V(0 A[0 A ~&gt; X ]0  |- [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 )0) :=
      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">Y X</span> : obA func),
        ( [0 A[0 A ~&gt; Y ]0 ~&gt; &#946; X ]1
          &lt;o A[0 A ~&gt; - ]1 Y X )
          ~~ ( [1 &#946; Y ~&gt; [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 ]0
               &lt;o ( V[0 V ~&gt; - ]1 (F[0 B ~&gt; Y ]0) (F[0 B ~&gt; X ]0) ) &lt;o F[0 B ~&gt; - ]1 Y X ) .

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">for polymorph functor, get this copy-paste same deduction as for polymorph category *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">natural_unitF_explicit</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB func) (<span style="font-weight: bold; font-style: italic;">A</span> : obA func) (<span style="font-weight: bold; font-style: italic;">&#966;</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA func, V(0 A[0 A ~&gt; X ]0  |- [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 )0),
                                     natural &#966; -&gt;
                                     <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">X</span> : obA func),
                                       DesIdenObR( [1 &#966; A &lt;o (@unitA _ func A) ~&gt; [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 ]0
                                                   &lt;o ( V[0 V ~&gt; - ]1 (F[0 B ~&gt; A ]0) (F[0 B ~&gt; X ]0) ) &lt;o F[0 B ~&gt; - ]1 A X )
                                                 ~~ ( &#966; X ) .
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> CongCom; [ | <span style="text-decoration: underline;">apply</span> ReflV]; <span style="text-decoration: underline;">apply</span> consV10_functorial ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> Cat2V ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> CongCom; [ <span style="text-decoration: underline;">apply</span> ReflV | ]; <span style="text-decoration: underline;">apply</span> SymV, H ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> SymV, Cat2V ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> CongCom; [ | <span style="text-decoration: underline;">apply</span> ReflV ]; <span style="text-decoration: underline;">apply</span> SymV, consV11_bifunctorial ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> Cat2V ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> CongCom; [ <span style="text-decoration: underline;">apply</span> ReflV | ]; <span style="text-decoration: underline;">apply</span> SymV, polyA_arrow ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongDesIdenObR; <span style="text-decoration: underline;">eapply</span> CongCom; [ <span style="text-decoration: underline;">apply</span> ReflV | ]; <span style="text-decoration: underline;">apply</span> CongPolyA, SymV, Cat1LeftV ].  
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> DesIdenObR_output].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">eapply</span> CongCom; [ <span style="text-decoration: underline;">apply</span> ReflV | ]; <span style="text-decoration: underline;">apply</span> SymV, polyA_unitA ].
      <span style="text-decoration: underline;">apply</span> SymV, Cat1RightV.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">for polymorph functor, get this copy-paste same deduction as for polymorph category *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">natural_unitF</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB func) (<span style="font-weight: bold; font-style: italic;">A</span> : obA func) (<span style="font-weight: bold; font-style: italic;">&#966; &#966;'</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA func, V(0 A[0 A ~&gt; X ]0  |- [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 )0),
                            natural &#966; -&gt; natural &#966;' -&gt;
                            &#966;' A &lt;o (@unitA _ func A)  ~~ &#966; A &lt;o (@unitA _ func A) -&gt;
                            <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA func, &#966;' X ~~ &#966; X.
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> natural_unitF_explicit; assumption |
                               <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">apply</span> SymV, natural_unitF_explicit; assumption ] ].
      <span style="text-decoration: underline;">apply</span> CongDesIdenObR, CongCom; [ | <span style="text-decoration: underline;">apply</span> ReflV ]; <span style="text-decoration: underline;">apply</span> CongConsV10.
      assumption.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">for polymorph functor, get this copy-paste same deduction as for polymorph category *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">YONEDA</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obB func) (<span style="font-weight: bold; font-style: italic;">A</span> : obA func) (<span style="font-weight: bold; font-style: italic;">&#966; &#966;'</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA func, V(0 A[0 A ~&gt; X ]0  |- [0 V ~&gt; F[0 B ~&gt; X ]0 ]0 )0),
                     natural &#966; -&gt;
                     <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA func, &#966; X ~~ F[1 DesIdenObL( (&#966; A) &lt;o (@unitA _ func A) ) ~&gt; X ]0 .
    <span style="font-weight: bold;">Proof</span>.
      <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">enough</span>( &#966; A &lt;o (@unitA _ func A) ~~ F[1 DesIdenObL( (&#966; A) &lt;o (@unitA _ func A) ) ~&gt; A ]0 &lt;o (@unitA _ func A) ).
      <span style="text-decoration: underline;">apply</span> natural_unitF; [ |  assumption | assumption ] .
      <span style="text-decoration: underline;">unfold</span> natural; <span style="text-decoration: underline;">intros</span>; <span style="text-decoration: underline;">apply</span> polyF_natural.

      <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> SymV, ConsIdenObL_DesIdenObL | ].
      <span style="text-decoration: underline;">eapply</span> TransV; [ | <span style="text-decoration: underline;">apply</span> ConsIdenObL_DesIdenObL].
      <span style="text-decoration: underline;">apply</span> CongConsIdenObL.
      <span style="text-decoration: underline;">eapply</span> TransV; [ <span style="text-decoration: underline;">apply</span> polyF_inputUnitA |  <span style="text-decoration: underline;">apply</span> ReflV ].
    <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context8</span>.

  <span style="font-weight: bold;">Check</span> <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">log</span> =&gt; <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">ff</span> : @functor log  =&gt;  polyF_arrowIn (func:=ff).
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">FUNCTOR</span>.

<span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">FORM</span>.
  <span style="font-weight: bold;">Import</span> FUNCTOR.
  <span style="font-weight: bold;">Set Implicit Arguments</span>.
  Unset  <span style="font-weight: bold;">Strict Implicit</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context6</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Record</span> <span style="font-weight: bold;">data</span> :=
      Data {
          <span style="font-weight: bold; font-style: italic;">obA</span> : <span style="font-weight: bold; text-decoration: underline;">Type</span>;
          polyA00 : obA -&gt; obA -&gt; obV log;
          polyA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A2</span> : obA), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A1</span> : obA),
                    V(0 V |- (polyA00 A2 A1) )0 -&gt;
                    <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA, V(0 (polyA00 A1 X)  |- [0 V ~&gt; (polyA00 A2 X) ]0 )0;
          unitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">A</span> : obA, V(0 I |- polyA00 A A )0;
        }.

    <span style="font-weight: bold;">Coercion</span> dataFun_of_dataCatForm (<span style="font-weight: bold; font-style: italic;">d</span> : data)
    : @FUNCTOR.data log := {|
                            FUNCTOR.obA := obA d;
                            FUNCTOR.polyA00 := @polyA00 d;
                            FUNCTOR.polyA := @polyA d;
                            FUNCTOR.obB := obA d;
                            FUNCTOR.polyB00 := @polyA00 d;
                            FUNCTOR.polyB := @polyA d;
                            FUNCTOR.polyF0 := (@idT (obA d));
                            FUNCTOR.polyF := @polyA d;
                            FUNCTOR.unitA := @unitA d|}.

    Global <span style="font-weight: bold;">Arguments</span> dataFun_of_dataCatForm : <span style="text-decoration: underline;">simpl</span> never.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context6</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context7</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">class</span> (<span style="font-weight: bold; font-style: italic;">dat</span> : data) :=
      <span style="font-weight: bold;">Class</span> {
          <span style="font-weight: bold; font-style: italic;">CongPolyA</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : FUNCTOR.obA dat),
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 V |- A[0 B ~&gt; A ]0 )0),
                        f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : FUNCTOR.obA dat, polyA f' X ~~ polyA f X;
          polyA_arrow :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : FUNCTOR.obA dat),
                         <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0),
                         <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- A[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> :  FUNCTOR.obA dat),
                           A[1 f &lt;o v ~&gt; X ]0
                            ~~ [1 v ~&gt; A[0 B ~&gt; X ]0 ]0 &lt;o A[1 f ~&gt; X ]0;
          polyA_unitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> :  FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> :  FUNCTOR.obA dat, (@IdenV _ (A[0 A ~&gt; X ]0)) ~~ DesIdenObR( A[1 (@FUNCTOR.unitA _ dat A) ~&gt; X ]0 );
        }.

    Global <span style="font-weight: bold;">Arguments</span> CongPolyA {_ _} [_ _ _ _ _] _ _  .
    Global <span style="font-weight: bold;">Arguments</span> polyA_arrow {_ _} [_ _ _ _] _ _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyA_unitA {_ _} _ _ .

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context7</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context8</span>.
    <span style="font-weight: bold;">Structure</span> <span style="font-weight: bold;">form</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic) :=
      Form {
          data_of :&gt; @data log;
          class_of :&gt; @class log (data_of)
        }.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">is this necessary?</span><span style="font-weight: bold; font-style: italic;">*)</span>
    Global <span style="font-weight: bold;">Existing Instance</span> <span style="font-weight: bold;">class_of</span>.

    <span style="font-weight: bold;">Coercion</span> dataForm_of_dataFun {log} (<span style="font-weight: bold; font-style: italic;">dat</span> : @FUNCTOR.data log)
    : @data log := {|
                    obA := FUNCTOR.obA dat;
                    polyA00 := @FUNCTOR.polyA00 _ dat;
                    polyA := @FUNCTOR.polyA _ dat;
                    unitA := @FUNCTOR.unitA _ dat |}.

    Global <span style="font-weight: bold;">Arguments</span> dataForm_of_dataFun : <span style="text-decoration: underline;">simpl</span> never.

    <span style="font-weight: bold;">Coercion</span> classForm_of_classFun {log} (<span style="font-weight: bold; font-style: italic;">dat</span> : @FUNCTOR.data log) (<span style="font-weight: bold; font-style: italic;">ext</span> : @FUNCTOR.class log dat)
    : @FORM.class log dat :=
      @FORM.<span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">log</span> dat (@FUNCTOR.CongPolyA log dat ext) (@FUNCTOR.polyA_arrow log dat ext)
                  (@FUNCTOR.polyA_unitA log dat ext).

    Global <span style="font-weight: bold;">Arguments</span> classForm_of_classFun : <span style="text-decoration: underline;">simpl</span> never.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">form_of_functor</span> {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">func</span> : @functor log)
    : @form log :=  {| data_of := func ; class_of := func |}.
    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">?? Canonical Structure form_of_functor\; ?? *</span><span style="font-weight: bold; font-style: italic;">*)</span>

    <span style="font-weight: bold;">Goal</span> <span style="font-weight: bold; text-decoration: underline;">forall</span> log (<span style="font-weight: bold; font-style: italic;">func</span> : @functor log), 
           FUNCTOR.data_of func = (@dataFun_of_dataCatForm log (@data_of log (@form_of_functor log func))) .
      Fail reflexivity.
      <span style="text-decoration: underline;">destruct</span> func <span style="font-weight: bold; text-decoration: underline;">as</span> [datfunc extfunc]. <span style="text-decoration: underline;">simpl</span>. <span style="font-weight: bold;">Set Printing All</span>.  <span style="font-weight: bold;">Show</span>. Fail reflexivity.
      <span style="text-decoration: underline;">destruct</span> datfunc. <span style="font-weight: bold;">Unset Printing All</span>.   <span style="text-decoration: underline;">compute</span>. Fail reflexivity.
    <span style="font-weight: bold;">Abort</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context8</span>.

  <span style="font-weight: bold;">Notation</span> form_of func := (@form_of_functor _ func).

  <span style="font-weight: bold;">Export</span> FUNCTOR.
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">FORM</span>.
</pre>
</div>
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">CATEGORY</span>.
  <span style="font-weight: bold;">Export</span> FORM.
  <span style="font-weight: bold;">Set Implicit Arguments</span>.
  Unset  <span style="font-weight: bold;">Strict Implicit</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context8</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic}.

    <span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">class</span> (<span style="font-weight: bold; font-style: italic;">dat</span> : FORM.data) :=
      <span style="font-weight: bold;">Class</span> {
          <span style="font-weight: bold; font-style: italic;">CongPolyA</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : FUNCTOR.obA dat),
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 V |- A[0 B ~&gt; A ]0 )0),
                        f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : FUNCTOR.obA dat, polyA f' X ~~ polyA f X;
          <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">remember that polyV_relT_arrow , relate in particular the polyV_relT_constant to polyV_relT_identitary </span><span style="font-weight: bold; font-style: italic;">*)</span>
          polyA_arrow :  <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> : FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : FUNCTOR.obA dat),
                         <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log) (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0),
                         <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- A[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> :  FUNCTOR.obA dat),
                           A[1 f &lt;o v ~&gt; X ]0
                            ~~ [1 v ~&gt; A[0 B ~&gt; X ]0 ]0 &lt;o A[1 f ~&gt; X ]0;
          polyF_morphism : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> :  FUNCTOR.obB dat),
                           <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> :  FUNCTOR.obA dat) (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> :  FUNCTOR.obA dat) (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 W |- A[0 A ~&gt; A']0 )0),
                           <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |-F[0 B ~&gt; A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obA dat),
                             F[1 Des( [1 f ~&gt; F[0 B ~&gt; A' ]0 ]0 &lt;o F[0 A' ~&gt; g ]1 ) ~&gt; X]0
                              ~~  DesIn( [0 W ~&gt; F[1 f ~&gt; X ]0 ]1 &lt;o A[1 g ~&gt; X ]0 );
          polyA_unitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> :  FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> :  FUNCTOR.obA dat, (@IdenV _ (A[0 A ~&gt; X ]0)) ~~ DesIdenObR( A[1 (@FUNCTOR.unitA _ dat A) ~&gt; X ]0 );
          polyF_inputUnitA : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">B</span> :  FUNCTOR.obA dat), <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> :  FUNCTOR.obA dat),
                             <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- A[0 B ~&gt; A ]0 )0),
                               f  ~~ DesIdenObL( (A[1 f ~&gt; A ]0) &lt;o (@FUNCTOR.unitA _ dat A) );
        }.

    Global <span style="font-weight: bold;">Arguments</span> CongPolyA {_ _} [_ _ _ _ _] _ _  .
    Global <span style="font-weight: bold;">Arguments</span> polyA_arrow {_ _} [_ _ _ _] _ _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_morphism {_ _} [_ _ _ _ _] _ _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyA_unitA {_ _} _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_inputUnitA {_ _} [_ _ _] _ .

    <span style="font-weight: bold;">Coercion</span> classFun_of_classCat (<span style="font-weight: bold; font-style: italic;">dat</span> : @FORM.data log) (<span style="font-weight: bold; font-style: italic;">ext</span> : @class  dat)
    : @FUNCTOR.class log (dataFun_of_dataCatForm dat) := 
      {|
        FUNCTOR.CongPolyA := CongPolyA;
        FUNCTOR.polyA_arrow := polyA_arrow;
        FUNCTOR.polyF_arrow := polyA_arrow;
        FUNCTOR.polyF_morphism := polyF_morphism;
        FUNCTOR.CongPolyF := CongPolyA;
        FUNCTOR.polyA_unitA := polyA_unitA;
        FUNCTOR.polyF_inputUnitA := polyF_inputUnitA |}.

    Global <span style="font-weight: bold;">Arguments</span> classFun_of_classCat : <span style="text-decoration: underline;">simpl</span> never.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context8</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context9</span>.
    <span style="font-weight: bold;">Structure</span> <span style="font-weight: bold;">category</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic) :=
      Category {
          data_of :&gt; @FORM.data log;
          class_of :&gt; @class  log (data_of)
        }.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">is this necessary?</span><span style="font-weight: bold; font-style: italic;">*)</span>
    Global <span style="font-weight: bold;">Existing Instance</span> <span style="font-weight: bold;">class_of</span>.

    <span style="font-weight: bold;">Coercion</span> functor_of_category {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">c</span> : @category log)
    : @FUNCTOR.functor log :=  {| FUNCTOR.data_of := data_of c; FUNCTOR.class_of :=  class_of c |}.
    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">false ambiguity : new coercion produce same output as old coercion ; the new coercion will be used to coerce but also the notational hiddenness/implicitness of old coercion is kept for printing </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Canonical Structure</span> <span style="font-weight: bold;">functor_of_category</span>.

    <span style="font-weight: bold;">Goal</span> <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic) (<span style="font-weight: bold; font-style: italic;">func</span> : @category log),
           FUNCTOR.data_of func = (@dataFun_of_dataCatForm log (@FORM.data_of log (@form_of_functor log func))) .
      reflexivity.
    <span style="font-weight: bold;">Qed</span>.

    <span style="font-weight: bold;">Coercion</span> category_of_logic (<span style="font-weight: bold; font-style: italic;">log</span> : logic) : @category log :=
      @Category log _
                (@<span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">log</span>
                        {|
                          FORM.obA := obV log;
                          FORM.polyA00 := @consV00 log;
                          FORM.polyA := @polyV_relV log;
                          FORM.unitA := @unitV log |} (@CongPolyV log) (@polyV_relV_arrow log)
                        (@polyV_relV_morphism log) (@polyV_relV_unitV log)
                        (@polyV_relV_inputUnitV log)) .

    <span style="font-weight: bold;">Canonical Structure</span> <span style="font-weight: bold;">category_of_logic</span>.
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context9</span>.
  <span style="font-weight: bold;">Export</span> FUNCTOR.
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">CATEGORY</span>.
</pre>
</div>
<div class="org-src-container">
<pre class="src src-coq"><span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">FUNCTORTOCAT</span>.
  <span style="font-weight: bold;">Export</span> CATEGORY.
  <span style="font-weight: bold;">Import</span> FUNCTOR.Ex_Notations4.
  <span style="font-weight: bold;">Set Implicit Arguments</span>.
  Unset  <span style="font-weight: bold;">Strict Implicit</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">from</span> : @form log) (<span style="font-weight: bold; font-style: italic;">to</span> : @category log).

    <span style="font-weight: bold;">Record</span> <span style="font-weight: bold;">data</span> :=
      Data {
          <span style="font-weight: bold; font-style: italic;">polyF0</span> : obA from -&gt; obA to;
          polyF :   <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">V</span> : obV log}{<span style="font-weight: bold; font-style: italic;">B</span> : obA to} {<span style="font-weight: bold; font-style: italic;">A</span> : obA from},
                      V(0 V |- to .-A[0 B ~&gt; polyF0 A ]0 )0 -&gt;
                      <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA from,
                        V(0 from .-A[0 A ~&gt; X ]0 |- [0V ~&gt; to .-A[0 B ~&gt; polyF0 X ]0 ]0 )0;
        }.

    <span style="font-weight: bold;">Coercion</span> dataFun_of_dataFuntoCat (<span style="font-weight: bold; font-style: italic;">d</span> : data)
    : @FUNCTOR.data log :=  {|
                            FUNCTOR.obA := @obA _ from;
                            FUNCTOR.polyA00 := @polyA00 _ from;
                            FUNCTOR.polyA := @polyA _ from;
                            FUNCTOR.obB := @obA _ to;
                            FUNCTOR.polyB00 := @polyA00 _ to;
                            FUNCTOR.polyB := @polyA _ to;
                            FUNCTOR.polyF0 := polyF0 d;
                            FUNCTOR.polyF := @polyF d;
                            FUNCTOR.unitA := @unitA _ from |}.

    Global <span style="font-weight: bold;">Arguments</span> dataFun_of_dataFuntoCat : <span style="text-decoration: underline;">simpl</span> never. <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">really useful with cbn *</span><span style="font-weight: bold; font-style: italic;">*)</span>

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context2</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic} {<span style="font-weight: bold; font-style: italic;">from</span> : @form log} {<span style="font-weight: bold; font-style: italic;">to</span> : @category log}.

    <span style="font-weight: bold;">Class</span> <span style="font-weight: bold;">class</span> (<span style="font-weight: bold; font-style: italic;">dat</span> : @data log from to) :=
      <span style="font-weight: bold;">Class</span> {
          <span style="font-weight: bold; font-style: italic;">polyF_arrow</span> :    <span style="font-weight: bold; text-decoration: underline;">forall</span> {<span style="font-weight: bold; font-style: italic;">B</span> : obA to} {<span style="font-weight: bold; font-style: italic;">A</span> : obA from} {<span style="font-weight: bold; font-style: italic;">V V'</span> : obV log} 
                             (<span style="font-weight: bold; font-style: italic;">v</span> : V(0 V' |- V )0) (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- to .-A[0 B ~&gt; polyF0 dat A ]0 )0)
                             (<span style="font-weight: bold; font-style: italic;">X</span> : obA from),
                             dat.-F[1  (f &lt;o v) ~&gt; X ]0 ~~
                                [1v ~&gt; to .-A[0 B ~&gt; dat.-F|0 X ]0 ]0 &lt;o dat.-F[1 f ~&gt; X ]0 ;
          polyF_morphism :    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obA to) (<span style="font-weight: bold; font-style: italic;">A</span> : obA from) 
                                (<span style="font-weight: bold; font-style: italic;">W</span> : obV log) (<span style="font-weight: bold; font-style: italic;">A'</span> : obA from) (<span style="font-weight: bold; font-style: italic;">g</span> : V(0 W |- from .-A[0 A ~&gt; A' ]0 )0)
                                (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- to .-A[0 B ~&gt; polyF0 dat A ]0 )0) (<span style="font-weight: bold; font-style: italic;">X</span> : obA from),
                                dat.-F[1 (Des ([1f ~&gt; to .-A[0 B ~&gt; dat.-F|0 A' ]0 ]0 &lt;o dat.-F[1 1 ~&gt; A' ]0 &lt;o g)) ~&gt; X ]0 ~~
                                   DesIn ([0W ~&gt; dat.-F[1 f ~&gt; X ]0 ]1 &lt;o from .-A[1 g ~&gt; X ]0) ;
          CongPolyF :    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obA to) (<span style="font-weight: bold; font-style: italic;">A</span> : obA from)
                           (<span style="font-weight: bold; font-style: italic;">f f'</span> : V(0 V |- to .-A[0 B ~&gt; dat.-F|0 A ]0 )0),
                           f' ~~ f -&gt; <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA from, dat.-F[1 f' ~&gt; X ]0 ~~ dat.-F[1 f ~&gt; X ]0 ;
          polyF_inputUnitA :    <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">V</span> : obV log) (<span style="font-weight: bold; font-style: italic;">B</span> : obA to) (<span style="font-weight: bold; font-style: italic;">A</span> : obA from)
                                  (<span style="font-weight: bold; font-style: italic;">f</span> : V(0 V |- to .-A[0 B ~&gt; dat.-F|0 A ]0 )0),
                                  f ~~ DesIdenObL (dat.-F[1 f ~&gt; A ]0 &lt;o (from) .-uA)
        }.

    Global <span style="font-weight: bold;">Arguments</span> polyF_arrow {_ _} [_ _ _ _] _ _  _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_morphism {_ _} [_ _ _ _ _] _ _ _ .
    Global <span style="font-weight: bold;">Arguments</span> CongPolyF {_ _} [_ _ _ _ _] _ _ .
    Global <span style="font-weight: bold;">Arguments</span> polyF_inputUnitA {_ _} [_ _ _] _  .

    <span style="font-weight: bold;">Coercion</span> classFun_of_classFuntoCat (<span style="font-weight: bold; font-style: italic;">dat</span> : @data log from to) (<span style="font-weight: bold; font-style: italic;">ext</span> : @class dat)  :  @FUNCTOR.class log dat :=
      FUNCTOR.<span style="font-weight: bold;">Class</span> (dat:=dat) (@FORM.CongPolyA _ _ from) (@FORM.polyA_arrow _ _ from) (@polyF_arrow dat ext)
                    (@polyF_morphism _ ext) (@CongPolyF _ ext) (@FORM.polyA_unitA _ _ from)
                    (@polyF_inputUnitA _ ext).

    Global <span style="font-weight: bold;">Arguments</span> classFun_of_classFuntoCat : <span style="text-decoration: underline;">simpl</span> never.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context2</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context3</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">from</span> : @form log) (<span style="font-weight: bold; font-style: italic;">to</span> : @category log).

    <span style="font-weight: bold;">Structure</span> <span style="font-weight: bold;">functorToCat</span> :=
      FunctorToCat {
          data_of :&gt; @data log from to;
          class_of :&gt; @class _ _ _ (data_of)
        }.

    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">is this necessary?</span><span style="font-weight: bold; font-style: italic;">*)</span>
    Global <span style="font-weight: bold;">Existing Instance</span> <span style="font-weight: bold;">class_of</span>.

    <span style="font-weight: bold;">Coercion</span> functor_of_functorToCat (<span style="font-weight: bold; font-style: italic;">func</span> : functorToCat)
    : @FUNCTOR.functor log :=  {| FUNCTOR.data_of := data_of func; FUNCTOR.class_of := class_of func |}.
    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">false ambiguity : new coercion produce same output as old coercion ; the new coercion will be used to coerce but also the notational hiddenness/implicitness of old coercion is kept for printing </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Canonical Structure</span> <span style="font-weight: bold;">functor_of_functorToCat</span>.

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">polyF_unitB</span> {<span style="font-weight: bold; font-style: italic;">func</span> : functorToCat} : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A</span> : obA from),
                                                   <span style="font-weight: bold; text-decoration: underline;">forall</span> <span style="font-weight: bold; font-style: italic;">X</span> : obA from, V(0 from.-A[0 A ~&gt; X ]0  |- to.-A[0 func.-F|0 A ~&gt; func.-F|0 X ]0 )0.
      <span style="text-decoration: underline;">intros</span>.
      <span style="text-decoration: underline;">apply</span> DesIdenObR.
      <span style="text-decoration: underline;">eapply</span> polyF.
      <span style="text-decoration: underline;">apply</span> (@unitA _ to).
      <span style="font-weight: bold;">Show</span> <span style="font-weight: bold;">Proof</span>.
    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">(fun (func : functorToCat) (A X : obA from) =&gt;</span>
<span style="font-weight: bold; font-style: italic;"> DesIdenObR (polyF (d:=func) (to) \;-uA X)) </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Defined</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context3</span>.

  <span style="font-weight: bold;">Module</span> <span style="font-weight: bold;">Ex_Notations6</span>.
    <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"dat .-F|1"</span> := (@polyF_unitB _ _ _ dat) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0, format <span style="font-style: italic;">"dat .-F|1"</span>).
  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Ex_Notations6</span>.
  <span style="font-weight: bold;">Import</span> Ex_Notations6.
  <span style="font-weight: bold;">Notation</span> <span style="font-style: italic;">"F|1"</span> := (_ .-F|1) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 0).

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context4</span>.
    Context {<span style="font-weight: bold; font-style: italic;">log</span> : logic} (<span style="font-weight: bold; font-style: italic;">catA</span> : form log) (<span style="font-weight: bold; font-style: italic;">catB</span> : category log) (<span style="font-weight: bold; font-style: italic;">funF</span> : functorToCat catA catB) (<span style="font-weight: bold; font-style: italic;">B</span> : obB catB).

    <span style="font-weight: bold; font-style: italic;">(** </span><span style="font-weight: bold; font-style: italic;">functors are very primitive therefore no reason for this sequencing lemma to hold,         </span>
<span style="font-weight: bold; font-style: italic;">but later polyF_identitary_rel_polyF_unitB do hold    for alone functorToCat_of_metafunctor    or   for funComp composition of two functors  ,</span>
<span style="font-weight: bold; font-style: italic;">also later with the polymorphism in B assumption and the B is category (polyB_inputUnitB) assumption then this lemma hold *</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Lemma</span> <span style="font-weight: bold;">polyF_identitary_rel_polyF_unitB_ABORT</span> : <span style="font-weight: bold; text-decoration: underline;">forall</span> (<span style="font-weight: bold; font-style: italic;">A X</span> : obA catA),
                                                     (catB.-F[0 B ~&gt; - ]1) (funF.-F|0 A) (funF.-F|0 X) &lt;o funF.-F|1 A X ~~
                                                                                                                    (funF.-F[0 B ~&gt; - ]1) A X  .
    <span style="font-weight: bold;">Proof</span>. <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">intros\;</span>
<span style="font-weight: bold; font-style: italic;">        Check  (funF\;-F[0 B ~&gt; - ]1) A X \; Check F|1 A X\; Check  (catB\;-F[0 B ~&gt; - ]1)\;</span>
<span style="font-weight: bold; font-style: italic;">        Set Printing Coercions\; intros\; Show\;</span>
<span style="font-weight: bold; font-style: italic;">        intros\; simpl\;   simpl\; Unset Printing Implicit Defensive\; Show\; unfold polyF_unitB\; simpl\; </span>
<span style="font-weight: bold; font-style: italic;">        eapply TransV; [| eapply SymV, DesIdenObR_output ]\;</span>

<span style="font-weight: bold; font-style: italic;">        unfold polyF_IdenV\;</span>
<span style="font-weight: bold; font-style: italic;">        eapply CongDesIdenObR\;</span>
<span style="font-weight: bold; font-style: italic;">         apply DesIdenObR_output\;</span>
<span style="font-weight: bold; font-style: italic;">      Qed\;</span><span style="font-weight: bold; font-style: italic;">*)</span> 
    <span style="font-weight: bold;">Abort</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context4</span>.

  <span style="font-weight: bold;">Section</span> <span style="font-weight: bold;">Context5</span>.   
    <span style="font-weight: bold; font-style: italic;">(*    </span><span style="font-weight: bold; font-style: italic;">Import Ex_Notations\;</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Import</span> LOGIC.Ex_Notations3.
    <span style="font-weight: bold;">Import</span> FUNCTOR.Ex_Notations4.
    <span style="font-weight: bold;">Variable</span> (<span style="font-weight: bold; font-style: italic;">log</span> : logic).
    <span style="font-weight: bold;">Variable</span> (<span style="font-weight: bold; font-style: italic;">pf</span> : @convV log = <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">V1 V2</span> =&gt; (<span style="font-weight: bold; font-style: italic;">eq</span> : V(0 V1 |- V2 )0 -&gt; V(0 V1 |- V2 )0 -&gt; <span style="font-weight: bold; text-decoration: underline;">Prop</span>) ).

    <span style="font-weight: bold;">Eval</span> <span style="text-decoration: underline;">unfold</span> polyT_relT_identitary, idT <span style="font-weight: bold; text-decoration: underline;">in</span> <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">a b</span> =&gt; a &lt;&lt;o b.
    <span style="font-weight: bold;">Eval</span> <span style="text-decoration: underline;">unfold</span> polyT_relT_constant, cstT <span style="font-weight: bold; text-decoration: underline;">in</span> <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">b a</span> =&gt; b o&gt;&gt; a.
    <span style="font-weight: bold; font-style: italic;">(*</span><span style="font-weight: bold; font-style: italic;">BUG fix </span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Local Notation</span> <span style="font-style: italic;">"a &lt;&lt;o b"</span> := ((T(1 (<span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">h</span> : _ =&gt; h) |- _ )0) a b) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).
    <span style="font-weight: bold;">Local Notation</span> <span style="font-style: italic;">"b o&gt;&gt; a"</span> := ( (T(1 <span style="font-weight: bold; text-decoration: underline;">fun</span> <span style="font-weight: bold; font-style: italic;">_</span> : unit =&gt; b |- _ )0) a tt) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).
    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">ATTEMPT   Notation "a &lt;o b" := (@polyV_relT_identitary _ _ _ _ a b) (at level 33, right associativity)\;</span>
<span style="font-weight: bold; font-style: italic;">    Notation "b o&gt; a" := (@polyV_relT_constant _ _ _ b _ a) (at level 33, right associativity)\;</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold; font-style: italic;">(* </span><span style="font-weight: bold; font-style: italic;">ATTEMPT Local Notation "b o&gt; a" := (b o&gt;_&gt; a) (at level 33, right associativity)\;</span>
<span style="font-weight: bold; font-style: italic;">    Local Notation "a &lt;o b" := (a &lt;_&lt;o b) (at level 33, right associativity)\;</span><span style="font-weight: bold; font-style: italic;">*)</span>
    <span style="font-weight: bold;">Local Notation</span> <span style="font-style: italic;">"b o&gt;' a"</span> := (b o&gt; _ &gt; a) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity). <span style="font-weight: bold;">Print</span> Grammar constr.
    <span style="font-weight: bold;">Local Notation</span> <span style="font-style: italic;">"a &lt;o' b"</span> := (a &lt;` _ `&lt;o b) (<span style="font-weight: bold; text-decoration: underline;">at</span> level 33, <span style="text-decoration: underline;">right</span> associativity).

    <span style="font-weight: bold;">Definition</span> <span style="font-weight: bold;">category_relT_of_logic</span> : @category logT.
      unshelve <span style="text-decoration: underline;">econstructor</span>.
      - unshelve <span style="text-decoration: underline;">econstructor</span>.
        + <span style="text-decoration: underline;">eapply</span> (@obV log).
        + <span style="text-decoration: underline;">eapply</span> (@polyV_relT00 log).
        + <span style="text-decoration: underline;">eapply</span> (@polyV_relT log).
        + <span style="text-decoration: underline;">eapply</span> (@unitV_relT log).
      - unshelve <span style="text-decoration: underline;">econstructor</span>.
        + <span style="text-decoration: underline;">simpl</span>. <span style="text-decoration: underline;">intros</span> * -&gt; . reflexivity.
        +  <span style="text-decoration: underline;">simpl</span>. <span style="text-decoration: underline;">generalize</span> (@polyV_relT_arrow log log).
           <span style="text-decoration: underline;">intros</span> H_polyV_relT_arrow; <span style="text-decoration: underline;">intros</span>.  <span style="text-decoration: underline;">erewrite</span>  !pf <span style="font-weight: bold; text-decoration: underline;">in</span> *.
           do 2 (<span style="text-decoration: underline;">apply</span> functional_extensionality_T; <span style="text-decoration: underline;">intros</span>).
           <span style="text-decoration: underline;">apply</span> H_polyV_relT_arrow; reflexivity.
        + <span style="text-decoration: underline;">simpl</span>. <span style="text-decoration: underline;">generalize</span> (@polyV_relT_morphism log log).
          <span style="text-decoration: underline;">intros</span> H_polyV_relT_morphism; <span style="text-decoration: underline;">intros</span>.  <span style="text-decoration: underline;">erewrite</span>  !pf <span style="font-weight: bold; text-decoration: underline;">in</span> *.
          do 2 (<span style="text-decoration: underline;">apply</span> functional_extensionality_T; <span style="text-decoration: underline;">intros</span>).
          <span style="text-decoration: underline;">apply</span> H_polyV_relT_morphism.
        + <span style="text-decoration: underline;">simpl</span>. <span style="text-decoration: underline;">generalize</span> (@polyV_relT_unitV log log).
          <span style="text-decoration: underline;">intros</span> H_polyV_relT_unitV; <span style="text-decoration: underline;">intros</span>.  <span style="text-decoration: underline;">erewrite</span>  !pf <span style="font-weight: bold; text-decoration: underline;">in</span> *.
          do 1 (<span style="text-decoration: underline;">apply</span> functional_extensionality_T; <span style="text-decoration: underline;">intros</span>). 
          <span style="text-decoration: underline;">eapply</span> H_polyV_relT_unitV; reflexivity.
        + <span style="text-decoration: underline;">simpl</span>. <span style="text-decoration: underline;">generalize</span> (@polyV_relT_inputUnitV log log).
          <span style="text-decoration: underline;">intros</span> H_polyV_relT_inputUnitV; <span style="text-decoration: underline;">intros</span>.  <span style="text-decoration: underline;">erewrite</span>  !pf <span style="font-weight: bold; text-decoration: underline;">in</span> *.
          do 1 (<span style="text-decoration: underline;">apply</span> functional_extensionality_T; <span style="text-decoration: underline;">intros</span>). 
          <span style="text-decoration: underline;">eapply</span> H_polyV_relT_inputUnitV; reflexivity.
    <span style="font-weight: bold;">Qed</span>.

  <span style="font-weight: bold;">End</span> <span style="font-weight: bold;">Context5</span>.
  <span style="font-weight: bold;">Export</span> FUNCTOR.
<span style="font-weight: bold;">End</span> <span style="font-weight: bold;">FUNCTORTOCAT</span>.
</pre>
</div>
</div>
</body>
</html>
