{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/taskpane/taskpane.js","webpack:///(webpack)/buildin/global.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Array","last","this","length","sizes","self","Resizable","initialise","window","addEventListener","activeContentWindows","changeSize","innerWidth","innerHeight","childrenResize","jscoq_src","jscoq_ids","jscoq_opts","show","line_numbers","prelude","base_path","init_pkgs","all_pkgs","implicit_libs","editor","keyMap","coq","getGlobal","global","undefined","g","coq365script_regexp","RegExp","transcriptButtonChecked","tryCatch","callback","console","log","error","transcriptSeparator","coqObserver","selectStatement","span_id","stm","doc","sentences","filter","coq_sid","Word","run","context","v","document","contentControls","getById","sp","ccid","getRange","split","load","sync","items","rgstart","text","start","line","search","rgend","end","rg","slice","forEach","expandTo","select","transcriptStatement","isHtml","cont","cctitle","title","replace","pccc","getByTitle","cc","insertParagraph","InsertLocation","after","insertContentControl","appearance","ContentControlAppearance","tags","color","tag","insertHtml","insertText","formatCC","goals2DOM","goals","$","createTextNode","ngoals","head","focused_goal","goal2DOM","pending_goals","map","goal","append","pprint","pp2Text","ty","hyps","hyp","h","codelang","docEl","createElement","Office","platform","PlatformType","PC","valRtext","op","join","innerHTML","hljs","highlight","substr","body","getElementsByClassName","appendChild","computedStyleToInlineStyle","recursive","properties","styleBuiltIn","jk","clear","j","font","removeChild","readSelected","foundRanges","getSelection","parentContentControlOrNullObject","readCC","provider","snippets","find","trim","id","writeSelected","writeBack","siR","cid","valR","setValue","normalize","readFrom","getByTag","iR","aR","setTimeout","writeAll","currentFocus","write","getValue","outerHTML","span_ids","includes","lvl","loc","msg","onReady","info","host","HostType","workspaces","querySelector","paragraphs","match","substring","evalresult","eval","err","workspace","setAttribute","push","scriptFile","type","src","onload","loadJsCoq","then","CoqManager","observers","coqlayoutlog","layout","level","coqlayoutupdate_goals","update_goals","str","buttons","readSelectedButton","innerText","onclick","writeSelectedButton","writeBackButton","transcriptButton","checked","Function","e"],"mappings":"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","file":"taskpane.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 310);\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n\n/* global console, document, Excel, Office */\n\n\n//import * as Resizable from './resizable.js';\n\n// Note: Word consolas 12 gives adjustWidth() \"Setting printing width to: \"  67 \n\nArray.prototype.last = function () { return this[this.length - 1]; };\n\nvar sizes = {\n  \"ide-wrapper\": 0.5,\n  \"code-wrapper\": 0.5\n};\n\nself.Resizable.initialise(\"main\", sizes);\n\nwindow.addEventListener(\"resize\", () => {\n  self.Resizable.activeContentWindows[0].changeSize(window.innerWidth, window.innerHeight);\n  self.Resizable.activeContentWindows[0].childrenResize();\n});\n\nself.Resizable.activeContentWindows[0].changeSize(window.innerWidth, window.innerHeight);\nself.Resizable.activeContentWindows[0].childrenResize();\n\n\nvar jscoq_src = \"/ui-js/jscoq-loader.js\";\nvar jscoq_ids = [];\nvar jscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: '',\n  init_pkgs: ['init', 'qoc'],\n  all_pkgs: ['init', 'qoc', 'coq-base', 'coq-collections', 'coq-arith', 'coq-reals', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n/*\njscoq_src  = \"/jscoq-builds-v88/ui-js/jscoq-loader.js\";\njscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: '/jscoq-builds-v88/',\n  init_pkgs: ['init'],\n  all_pkgs: ['init', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n\njscoq_src = \"/ui-js/jscoq-loader.js\";\njscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: '',\n  init_pkgs: ['init', 'qoc'],\n  all_pkgs: ['init', 'qoc', 'coq-base', 'coq-collections', 'coq-arith', 'coq-reals', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n\n*/\n\n/* Global reference */\nvar coq;\n\nfunction getGlobal() {\n  return typeof self !== \"undefined\"\n    ? self\n    : typeof window !== \"undefined\"\n      ? window\n      : typeof global !== \"undefined\"\n        ? global\n        : undefined;\n}\n\nconst g = getGlobal();\n\n// the add-in command functions need to be available in global scope\n\nconst coq365script_regexp = RegExp('[(][*]/[*]coq365[*]/([^]*?)[*][)]', 'ig');\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n  try {\n    console.log('Now executing some WorkSchool 365 function...');\n    await callback();\n  } catch (error) {\n    // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\n    console.error(error);\n  }\n}\n\nvar transcriptButtonChecked;\nwindow.transcriptSeparator = '             ▽'; //'▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽';\n\nvar coqObserver = {};\n\ncoqObserver['coqGoalInfo'] = async (span_id, cont) => {\n  console.log('_______________MYGOALINFO______________________');\n  if (transcriptButtonChecked && cont) {\n    setTimeout(async () => {\n      await transcriptStatement(span_id, true, goals2DOM(cont)[0].outerHTML);\n      selectStatement(span_id);\n    }, 50);\n  } else {\n    selectStatement(span_id);\n  };\n};\n\ncoqObserver['coqCancelled'] = async (span_ids, ...cont) => {\n  console.log('_______________MYCOQCANCELLED______________________');\n  selectStatement(coq.doc.sentences.filter(s => !span_ids.includes(s.coq_sid)).last().coq_sid);\n};\n\ncoqObserver['feedMessage'] = async (span_id, lvl, loc, msg) => {\n  console.log('______________MYFEEDMESSAGE______________________');\n  if (transcriptButtonChecked) {\n    await transcriptStatement(span_id, false, coq.pprint.pp2Text(msg))\n  };\n  selectStatement(span_id);\n\n  //  console.log( coq.pprint.pp2Text(stm.feedback[0].msg)) ;\n\n};\n\n//document.body.innerHTML = \"<p>KOKOK\" + Office.HostType.Word + \"OKOK</p>\";\nOffice.onReady(info => {\n\n\n  if (info.host === Office.HostType.Word) {\n    Word.run(async context => {\n      var workspaces = document.querySelector(\"#document\");\n      var workspace;\n      var foundRanges = context.document.contentControls.getByTag('ws365_code_coq');\n\n      foundRanges.load(['id', 'title', 'paragraphs/text']);\n      await context.sync();\n\n      console.log(foundRanges.items);\n      foundRanges.items.forEach(\n        (valR, iR, aR) => {\n          try {\n            /* for (const match of valR.paragraphs.items.map(i => i.text).join('\\n').matchAll(coq365script_regexp)) {\n              console.log(\"Eval Coq365 javascript\", match[1]);\n              var evalresult = eval(match[1]);\n              console.log(\"Result Eval Coq365 javascript\", evalresult);\n            } */\n            valR.paragraphs.items.map(i => i.text).join('\\n').match(coq365script_regexp).forEach(\n              function (match) {\n                console.log(\"Eval Coq365 javascript\", match.substring(2, match.length - 2));\n                var evalresult = eval(match.substring(2, match.length - 2));\n                console.log(\"Result Eval Coq365 javascript\", evalresult);\n              })\n          } catch (err) { console.error(err); }\n          workspace = document.createElement(\"TEXTAREA\");\n          //workspace.setAttribute(\"id\", \"workspace_\" + valR.title.split('/')[0].trim());\n          workspace.setAttribute(\"id\", \"workspace_\" + valR.id);\n          workspaces.appendChild(workspace);\n          //jscoq_ids.push(\"workspace_\" + valR.title.split('/')[0].trim());\n          jscoq_ids.push(\"workspace_\" + valR.id);\n        }\n      );\n\n      var scriptFile = document.createElement(\"script\");\n      //document.body.append(scriptFile);\n      scriptFile.type = \"text/javascript\";\n      scriptFile.src = jscoq_src;\n      console.log(\"SET scriptFile.src\");\n      scriptFile.onload = /* setTimeout */(function () {\n        console.log(\"START RUN scriptFile.onload\");\n        loadJsCoq(jscoq_opts.base_path)\n          .then(\n            () => {\n              coq = new CoqManager(jscoq_ids, jscoq_opts);\n              g.coq = coq;\n\n              readFrom();\n              try { coq.coq.observers.push(coqObserver); }\n\n              catch {\n                //document.querySelector('#buttons').setAttribute('style', 'height : 100px; ' + document.querySelector('#buttons').getAttribute('style'));\n\n                var coqlayoutlog = coq.layout.log.bind(coq.layout);\n                coq.layout.log = (async (text, level) => {\n                  try {\n                    console.log('coq.layout.log_____________________________', level, text, coq.sentences.length, coq.sentences);\n                    var stm = coq.sentences.last().coq_sid;\n                    if (level == \"info\" || level == \"error\" || level == \"warn\" /* || !( /^feedback for [[]sid:/i.test(text)) */) {\n                      if (transcriptButtonChecked) {\n                        await transcriptStatement(stm, false, text.replace(/============================/g,\n                          '____________________________').replace(/<br [/]>/g, '\\n').replace(/&lt;/g, '<').replace(/&amp;/g, '&'));\n                      }\n                    }\n                    stm = coq.sentences.last().coq_sid;\n                    selectStatement(stm);\n                  }\n                  catch { }\n                  return coqlayoutlog(text, level);\n                })\n\n                var coqlayoutupdate_goals = coq.layout.update_goals.bind(coq.layout);\n                coq.layout.update_goals = (async (str) => {\n                  try {\n                    console.log('coq.layout.update_goals_____________________________', str, coq.sentences.length, coq.sentences);\n                    if (str != \"\") {\n                      if (transcriptButtonChecked) {\n                        setTimeout(async () => {\n                          var stm = coq.sentences.last().coq_sid;\n                          await transcriptStatement(stm, false, '★ ' + str.replace(/============================/g,\n                            '____________________________').replace(/\\nsubgoal (\\d+) is:/g, '\\n★ subgoal $1 is'));\n                          stm = coq.sentences.last().coq_sid;\n                          selectStatement(stm);\n                        }, 50);\n                      } else {\n                        var stm = coq.sentences.last().coq_sid;\n                        selectStatement(stm);\n                      }\n                    }\n                  }\n                  catch { }\n                  return coqlayoutupdate_goals(str);\n                })\n\n              }\n\n\n\n              let buttons = document.querySelector(\"#buttons\");\n\n              var readSelectedButton = document.createElement(\"BUTTON\");\n              readSelectedButton.innerText = \"READ\";\n              //readSelectedButton.setAttribute(\"style\", \"height : 30px\");\n              buttons.appendChild(readSelectedButton);\n              readSelectedButton.onclick = (() => tryCatch(readSelected));\n\n              var writeSelectedButton = document.createElement(\"BUTTON\");\n              writeSelectedButton.innerText = \"WRITE\";\n              buttons.appendChild(writeSelectedButton);\n              writeSelectedButton.onclick = (() => tryCatch(() => writeBack(false)));\n\n              var writeBackButton = document.createElement(\"BUTTON\");\n              writeBackButton.innerText = \"WRITEALL\";\n              buttons.appendChild(writeBackButton);\n              writeBackButton.onclick = (() => tryCatch(() => writeBack(true)));\n\n              buttons.append(\" \");\n              var transcriptButton = document.createElement(\"INPUT\");\n              transcriptButton.setAttribute(\"type\", \"checkbox\");\n              transcriptButton.setAttribute(\"id\", \"transcriptButton\");\n              buttons.appendChild(transcriptButton);\n              transcriptButton.onclick = (() => { transcriptButtonChecked = document.querySelector(\"#transcriptButton\").checked; });\n              buttons.append(\"TRANSCRIPT\");\n\n\n            }\n          )\n      } /* , 3000 */);\n      document.body.append(scriptFile);\n\n      await context.sync();\n\n    });\n  }\n\n});\n\n\n\n\nfunction selectStatement(span_id) {\n  var stm;\n  if (coq.doc && coq.doc.sentences) {\n    stm = coq.doc.sentences.filter(s => s.coq_sid == span_id).last()\n  } else if (coq.sentences) {\n    stm = coq.sentences.filter(s => s.coq_sid == span_id).last()\n  }\n\n  Word.run(async function (context) {\n    var v = context.document.contentControls.getById(stm.sp.ccid).getRange('Content').split([\"\\u000B\", \"\\n\", \"\\r\", \"\u000b\"]);\n    v.load(['length', 'items', 'text']);\n    await context.sync();\n    console.log(v.items);\n    var rgstart;\n\n    if (stm.text.split(\"\\n\")[0] == \"\") {\n      rgstart = v.items[stm.start.line + 1].search(stm.text.split(\"\\n\")[1]);\n    }\n    else {\n      rgstart = v.items[stm.start.line].search(stm.text.split(\"\\n\")[0]);\n    }\n    rgstart.load(['length']);\n    await context.sync();\n    var rgend = v.items[stm.end.line].search(stm.text.split(\"\\n\").last());\n    rgend.load(['length']);\n    await context.sync();\n\n    var rg = rgstart.items[0];\n    v.items.slice(stm.start.line + 1, stm.end.line).forEach(function (r) { rg = rg.expandTo(r); });\n    rg = rg.expandTo(rgend.items[0]);\n    rg.select();\n    await context.sync();\n  });\n}\n\n\nasync function transcriptStatement(span_id, isHtml, cont) {\n  var stm;\n  if (coq.doc && coq.doc.sentences) {\n    stm = coq.doc.sentences.filter(s => s.coq_sid == span_id).last()\n  } else if (coq.sentences) {\n    stm = coq.sentences.filter(s => s.coq_sid == span_id).last()\n  }\n\n  Word.run(async function (context) {\n    var v = context.document.contentControls.getById(stm.sp.ccid);\n    v.load(['length', 'title', 'items']);\n    await context.sync();\n\n    //let codelang = v.tag.match(/ws365_code_(.*)/i)[1];\n    let cctitle = v.title.replace(/\\s*([^/\\s]+)(.*)/, ' O_$1 / output ');\n    // Note: Word consolas 12 gives adjustWidth() \"Setting printing width to: \"  67 \n    pccc = context.document.contentControls.getByTitle(cctitle);\n    pccc.load(['items', 'length', 'text']);\n    await context.sync();\n    var cc;\n\n    if (pccc.items.length == 0) {\n      cc = v.insertParagraph('', Word.InsertLocation.after).insertContentControl();\n      cc.appearance = Word.ContentControlAppearance.tags;\n      cc.color = \"purple\";\n      cc.tag = \"ws365_code_output\";\n      cc.title = cctitle;\n      cc.load(['text']);\n      await context.sync();\n    }\n    else {\n      cc = pccc.items[0]\n    }\n\n    // if (stm.start.line == 0 && stm.start.ch == 0) {\n    // /!\\INFO AND GOAL DUPLICATE CLEAR PROBLEM/!\\ cc.clear(); }\n    if (cc.text != '')  {\n      cc.insertParagraph(transcriptSeparator, \"End\");\n      cc.insertParagraph('', \"End\");       //v.insertBreak(\"Line\", \"After\"); \n    }\n\n    if (isHtml) {\n      // coq.company_coq.markup.applyToDOM(goals2DOM(cont)[0])\n      cc.insertHtml(cont, \"End\");\n    } else {\n      //  cont_ = '<div>' + coq.pprint.pp2Text(cont).replace(/\\n/g, '<p></p>').replace(/  /g, '&nbsp;&nbsp;') + '</div>';\n      cc.insertText(cont, \"End\");\n    }\n    await context.sync();\n\n    await formatCC(context, cc, 'text');\n  });\n}\n\n\n/**\n * Formats the current proof state.\n * @param {object} goals a record of proof goals \n *                       ({goals, stack, shelf, given_up})\n */\nfunction goals2DOM(goals) {\n  if (goals.goals.length == 0) {\n    return $(document.createTextNode(\"No more goals\"));\n  }\n  else {\n    let ngoals = goals.goals.length;\n    let head = $('<p>')/* .addClass('num-goals') */\n      .text(ngoals === 1 ? `★ 1 goal.` : `★ ${ngoals} goals`);\n\n    let focused_goal = goal2DOM(goals.goals[0]);\n\n    let pending_goals = goals.goals.slice(1).map((goal, i) =>\n      $('<div>')/* .addClass('coq-subgoal-pending') */\n        .append($('<p>').text('★ subgoal ' + (i + 2) + ' is:'))\n        .append(coq.pprint.pp2Text(goal.ty)));\n\n    return $('<div>').append(head, focused_goal, pending_goals);\n  }\n}\n\n/**\n * Formats a single, focused goal.\n * Shows an environment containing hypothesis and goal type.\n * @param {object} goal current goal record ({name, hyp, ty})\n */\nfunction goal2DOM(goal) {\n  let hyps = goal.hyp/* .reverse() */.map(h =>\n    $('<p>')/* .addClass('coq-hypothesis') */\n      .append($('<span>').text(h[0] + ' : '))\n      .append(coq.pprint.pp2Text(h[2])));\n  let ty = coq.pprint.pp2Text(goal.ty);\n  return $('<div>')/* .addClass('coq-env') */.append(hyps, $('<p>').text('____________________________'), ty);\n}\n\nasync function formatCC(context, pccc, codelang) {\n  let docEl = document.createElement(\"PRE\");\n\n  if (Office.context.platform == Office.PlatformType.PC) {\n    /* pccc.load('text');\n    await context.sync(); */\n    var valRtext = pccc.split([\"\\n\"], false, false); //.getTextRanges([\"\\n\", \"\\u000B\"], false) //.split([\"\\n\"], false, false); // getTextRanges([], false);          \n    valRtext.load(['items', 'text']);\n    await context.sync();\n    console.log(valRtext);\n    // coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    let op = valRtext.items.map(i => i.text).join('');\n\n    docEl.innerHTML = hljs.highlight(codelang, op.substr(0, op.length)).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    //docEl.style = \"font-family: consolas; color: yellow\";\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    console.log(docEl.innerHTML);\n    //pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p> </p>').replace( /<[/]p>\\n/g , '</p><p> </p>').replace(/\\n/g, '<p/>').replace(/  /g, '  ') + '</pre>', \"Replace\");\n    pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '\\r\\n') + '\\r\\n</pre>', \"Replace\");\n    //pccc.insertHtml('<pre>' + docEl.innerHTML/* .replace(/\\u000B/g, '\\n') */.replace(/\\n\\n/g, '\\n<br/>').replace( /<br[/]>\\n/g , '<br/><br/>').replace(/\\n/g, '<p/>').replace(/  /g, '  ') + '</pre>', \"Replace\");\n    pccc.styleBuiltIn = \"NoSpacing\";\n  }\n  else {\n    /* pccc.load('text');\n    await context.sync(); */\n    var valRtext = pccc.split([\"\\n\"], false, false); // getTextRanges([], false);          \n    valRtext.load(['items', 'text']);\n    await context.sync();\n    //var arr = valRtext.items.map(i => i.text.split([\"\\u000B\"]) ).flat(1) ;\n    // coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    let op = valRtext.items.map(i => i.text).join('');\n    docEl.innerHTML = hljs.highlight(codelang, op.substr(0, op.length - 1)).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    //docEl.style = \"font-family: consolas; color: yellow\";\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    var jk = docEl.innerHTML.split(/\\r\\n|\\n|\\r|\\u000B/g);\n    console.log(jk);\n    pccc.clear();\n\n    for (let j = 0; j < jk.length; j++) {\n      //      pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '<p></p>') + '</pre>', \"Replace\");\n      if (j != jk.length - 1) {\n        pccc.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;') + '<br/>', \"End\");\n\n      } else if (jk[j].length != 0) {\n        pccc.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;'), \"End\");\n      }\n\n      //                pccc.insertHtml('' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p>&nbsp;</p>').replace( /<[/]p>\\n/g , '</p><p>&nbsp;</p>').replace(/\\n/g, '<p/>').replace(/  /g, '&nbsp;&nbsp;') + '', \"Replace\");\n    }\n    /* /!\\ pccc.styleBuiltIn = \"NoSpacing\"; */\n  }\n\n  pccc.font.name = \"Consolas\";\n  await context.sync();\n  document.body.getElementsByClassName('ws365_canvas')[0].removeChild(docEl);\n  docEl.innerHTML = '';\n}\n\nasync function readSelected() {\n  Word.run(async function (context) {\n\n    var foundRanges = context.document.getSelection().parentContentControlOrNullObject;\n    foundRanges.load(['text', 'title']);\n    await context.sync();\n\n    readCC(coq.provider.snippets.find(s => s.title == foundRanges.title.split(\"/\")[0].trim()), foundRanges.id);\n    //coq.provider.snippets.find(s => s.title == foundRanges.title.split(\"/\")[0].trim()).editor.setValue(foundRanges.text);\n  });\n}\n\n\nasync function writeSelected() {\n  writeBack(false);\n}\n\nasync function readCC(siR, cid) {\n  Word.run(async function (context) {\n    var valR = context.document.contentControls.getById(cid);\n    if (Office.context.platform == Office.PlatformType.PC) {\n      var valRtext = valR.split([]); // getTextRanges([], false);          \n      valRtext.load(['items', 'text']);\n      /* valR.load([ 'text']); */\n      await context.sync();\n      siR.editor.setValue(/* valR.text */valRtext.items.map(i => i.text).join('\\n').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    } else {\n      var valRtext = valR.split([]); // getTextRanges([], false);          \n      valRtext.load(['items', 'text']);\n      await context.sync();\n      siR.editor.setValue(valRtext.items.map(i => i.text).join('\\n').replace(/\\r/g, '').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    }\n    //  coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('\\n').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n  });\n  //  coq.provider.snippets[iR].editor.setValue(valR.text.replace(/\\u000B/g, '\\n').normalize('NFKD'));\n\n}\n\nasync function readFrom() {\n  Word.run(async function (context) {\n\n    var foundRanges = context.document.contentControls.getByTag('ws365_code_coq');\n    foundRanges.load(['length', 'items', 'text', 'title']);\n    await context.sync();\n\n    foundRanges.items.forEach(\n      async (valR, iR, aR) => {\n        if (coq.provider.snippets[iR]) {\n          coq.provider.snippets[iR].title = valR.title.split('/')[0].trim();\n          coq.provider.snippets[iR].ccid = valR.id;\n          var cid = valR.id;\n          var ctitle = valR.title.split('/')[0].trim();\n          window.setTimeout(async () => {\n            await readCC(coq.provider.snippets[iR], cid);\n            console.log('-----------------settimeout', iR);\n            //context.sync();\n          }, 50 * iR);\n        }\n      }\n    );\n\n    return context.sync();\n  })\n}\n\n\nasync function writeBack(writeAll) {\n  Word.run(async function (context) {\n\n    var foundRanges = context.document.contentControls.getByTag('ws365_code_coq');\n\n    foundRanges.load(['length', 'title']);\n    await context.sync();\n\n    //foundRanges.items.forEach(\n    //    (valR, iR, aR) => {\n    for (let iR = 0; iR < foundRanges.items.length; iR++) {\n      const valR = foundRanges.items[iR];\n      if (writeAll || coq.provider.currentFocus.title == valR.title.split(\"/\")[0].trim()) {\n        await write(context, valR);\n      }\n    }\n\n  })\n}\n\n\nasync function write(context, valR) {\n  try {\n    //valR.insertText(coq.provider.snippets.find(s => s.title == foundRanges.title.split(\"/\")[0].trim()).editor.getValue(), Word.InsertLocation.replace);\n    // valR.insertHtml(\"<pre>\" + coq.provider.snippets[iR].editor.getValue().replace(/\\n/g, \"<p></p>\") + \"</pre>\", Word.InsertLocation.replace);\n    var docEl = document.createElement(\"PRE\");\n    docEl.innerHTML = hljs.highlight('coq', coq.provider.snippets.find(s => s.title == valR.title.split(\"/\")[0].trim()).editor.getValue()).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    //console.log('-----------------replace', docEl.outerHTML.replaceAll(/\\n(.*?)\\n/g, '<p>$1</p>').replaceAll(/  /g, '&nbsp&nbsp'));\n    //valR.insertHtml('<pre><p>'+ docEl.innerHTML.replaceAll(/\\n/g, '</p><p>') + '</p></pre>', \"Replace\");\n\n    if (Office.context.platform == Office.PlatformType.PC) {\n      console.log(docEl.innerHTML);\n\n      valR.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '\\r\\n') + '\\r\\n</pre>', \"Replace\");\n      valR.styleBuiltIn = \"NoSpacing\";\n    }\n    else {\n      console.log(docEl.innerHTML);\n      var jk = docEl.innerHTML.split(/\\r\\n|\\n|\\r|\\u000B/g);\n      valR.clear();\n      for (let j = 0; j < jk.length; j++) {\n        if (j != jk.length - 1) {\n          valR.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;') + '<br/>', \"End\");\n\n        } else if (jk[j].length != 0) {\n          valR.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;'), \"End\");\n        }\n      }\n      /* /!\\ valR.styleBuiltIn = \"NoSpacing\"; */\n    }\n    //valR.insertHtml('' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p>&nbsp;</p>').replace( /<[/]p>\\n/g , '</p><p>&nbsp;</p>').replace(/\\n/g, '<p/>').replace(/  /g, '&nbsp;&nbsp;') + '', \"Replace\");\n\n\n    valR.font.name = \"Consolas\";\n    docEl.innerHTML = '';\n    document.body.getElementsByClassName('ws365_canvas')[0].removeChild(docEl);\n    await context.sync();\n\n\n    // window.setTimeout( () => {\n    //   console.log('-----------------settimeout', iR);\n    //    context.sync();            \n    // }, 10000*iR);\n  } catch (err) { console.error(err); }\n}","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}