{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/taskpane/taskpane.js","webpack:///(webpack)/buildin/global.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","document","documentMode","console","error","el","createElement","innerHTML","body","insertBefore","firstChild","Array","last","this","length","sizes","self","Resizable","initialise","window","addEventListener","activeContentWindows","changeSize","innerWidth","innerHeight","childrenResize","jscoq_src","jscoq_ids","jscoq_opts","show","line_numbers","prelude","base_path","init_pkgs","all_pkgs","implicit_libs","editor","keyMap","coq","getGlobal","global","undefined","g","coq365script_regexp","RegExp","transcriptButtonChecked","tryCatch","callback","transcriptSeparator","coqObserver","selectStatement","span_id","stm","doc","sentences","filter","coq_sid","Word","run","context","v","contentControls","getById","sp","ccid","getRange","split","load","sync","rgstart","text","items","start","line","search","rgend","end","rg","slice","forEach","expandTo","select","transcriptStatement","isHtml","cont","cctitle","title","replace","pccc","getByTitle","cc","insertParagraph","InsertLocation","after","insertContentControl","appearance","ContentControlAppearance","tags","color","tag","insertHtml","insertText","formatCC","goals2DOM","goals","$","createTextNode","ngoals","head","focused_goal","goal2DOM","pending_goals","map","goal","append","pprint","pp2Text","ty","hyps","hyp","h","codelang","docEl","Office","platform","PlatformType","OfficeOnline","valRtext","op","join","hljs","highlight","substr","getElementsByClassName","appendChild","computedStyleToInlineStyle","recursive","properties","styleBuiltIn","jk","clear","j","font","removeChild","readSelected","foundRanges","getSelection","parentContentControlOrNullObject","readCC","provider","snippets","find","trim","id","writeSelected","writeBack","siR","cid","valR","setValue","normalize","readFrom","getByTag","count","iR","aR","test","setTimeout","writeAll","currentFocus","write","getValue","outerHTML","span_ids","includes","lvl","loc","msg","onReady","info","host","HostType","workspaces","querySelector","matches","paragraphs","match","evalresult","eval","substring","err","workspace","setAttribute","push","scriptFile","type","src","onload","loadJsCoq","then","CoqManager","observers","coqlayoutlog","layout","log","level","coqlayoutupdate_goals","update_goals","str","buttons","readSelectedButton","innerText","onclick","writeSelectedButton","writeBackButton","transcriptButton","checked","Function","e"],"mappings":"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","file":"taskpane.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 310);\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n\n/* global console, document, Excel, Office */\n\nif (document.documentMode) {\n  console.error('Unsupported Browser!');\n  var el = document.createElement(\"div\");\n  el.innerHTML = (`<h1 style=\"color: orange\">Unsupported Browser!</h1>\n   <h3>This add-in does not support the Internet Explorer web browser, \n  consider upgrading your host to Microsoft Edge \n  ( <a target=\"_blank\" href=\"https://developer.microsoft.com/en-us/microsoft-edge/\">https://developer.microsoft.com/en-us/microsoft-edge/</a> ) \n  or to Microsoft Word with the latest Microsoft Edge WebView 2 \n  ( <a target=\"_blank\" href=\"https://developer.microsoft.com/en-us/microsoft-edge/webview2/\">https://developer.microsoft.com/en-us/microsoft-edge/webview2/</a> ) </h3>`);\n  document.body.insertBefore(el, document.body.firstChild);\n}\n\n//import * as Resizable from './resizable.js';\n\n// Note: Word consolas 12 gives adjustWidth() \"Setting printing width to: \"  67 \n\nArray.prototype.last = function () { return this[this.length - 1]; };\n\nvar sizes = {\n  \"ide-wrapper\": 0.5,\n  \"code-wrapper\": 0.5\n};\n\nself.Resizable.initialise(\"main\", sizes);\n\nwindow.addEventListener(\"resize\", () => {\n  self.Resizable.activeContentWindows[0].changeSize(window.innerWidth, window.innerHeight);\n  self.Resizable.activeContentWindows[0].childrenResize();\n});\n\nself.Resizable.activeContentWindows[0].changeSize(window.innerWidth, window.innerHeight);\nself.Resizable.activeContentWindows[0].childrenResize();\n\n\nvar jscoq_src = \"../../ui-js/jscoq-loader.js\";\nvar jscoq_ids = [];\nvar jscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: '../',\n  init_pkgs: ['init', 'qoc'],\n  all_pkgs: ['init', 'qoc', 'coq-base', 'coq-collections', 'coq-arith', 'coq-reals', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n\n/*\njscoq_src  = \"/jscoq-builds-v88/ui-js/jscoq-loader.js\";\njscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: '/jscoq-builds-v88/',\n  init_pkgs: ['init'],\n  all_pkgs: ['init', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n\njscoq_src = \"../../ui-js/jscoq-loader.js\";\njscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: '../',\n  init_pkgs: ['init', 'qoc'],\n  all_pkgs: ['init', 'qoc', 'coq-base', 'coq-collections', 'coq-arith', 'coq-reals', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n\n\njscoq_src  = \"https://1337777.github.io/ui-js/jscoq-loader.js\";\njscoq_opts = {\n  show: true,\n  line_numbers: 'continue',\n  prelude: true,\n  base_path: 'https://1337777.github.io/',\n  init_pkgs: ['init'],\n  all_pkgs: ['init', 'math-comp'],\n  implicit_libs: true,\n  editor: { mode: { 'company-coq': true }, keyMap: 'default' }\n};\n\n*/\n\n/* Global reference */\nvar coq;\n\nfunction getGlobal() {\n  return typeof self !== \"undefined\"\n    ? self\n    : typeof window !== \"undefined\"\n      ? window\n      : typeof global !== \"undefined\"\n        ? global\n        : undefined;\n}\n\nconst g = getGlobal();\n\n// the add-in command functions need to be available in global scope\n\nconst coq365script_regexp = RegExp('[(][*]/[*]coq365[*]/([^]*?)[*][)]', 'ig');\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch(callback) {\n  try {\n    await callback();\n  } catch (error) {\n    // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\n    console.error(error);\n  }\n}\n\nvar transcriptButtonChecked;\nwindow.transcriptSeparator = '             ▽'; //'▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽';\n\nvar coqObserver = {};\n\ncoqObserver['coqGoalInfo'] = async (span_id, cont) => {\n  if (transcriptButtonChecked && cont) {\n    setTimeout(async () => {\n      await transcriptStatement(span_id, true, goals2DOM(cont)[0].outerHTML);\n      selectStatement(span_id);\n    }, 50);\n  } else {\n    selectStatement(span_id);\n  };\n};\n\ncoqObserver['coqCancelled'] = async (span_ids, ...cont) => {\n  selectStatement(coq.doc.sentences.filter(s => !span_ids.includes(s.coq_sid)).last().coq_sid);\n};\n\ncoqObserver['feedMessage'] = async (span_id, lvl, loc, msg) => {\n  if (transcriptButtonChecked) {\n    await transcriptStatement(span_id, false, coq.pprint.pp2Text(msg))\n  };\n  selectStatement(span_id);\n\n\n};\n\n//document.body.innerHTML = \"<p>KOKOK\" + Office.HostType.Word + \"OKOK</p>\";\nOffice.onReady(info => {\n\n\n  if (info.host === Office.HostType.Word) {\n    Word.run(async context => {\n      var workspaces = document.querySelector(\"#document\");\n      var workspace;\n      var foundRanges = context.document.contentControls.getByTag('ws365_code_coq');\n\n      foundRanges.load(['id', 'title', 'length', 'paragraphs/text']);\n      await context.sync();\n\n      if (foundRanges.items.length != 0) {\n        foundRanges.items.forEach(\n          (valR, iR, aR) => {\n            try {\n              /* for (const match of valR.paragraphs.items.map(i => i.text).join('\\n').matchAll(coq365script_regexp)) {\n                var evalresult = eval(match[1]);\n              } */\n              let matches = valR.paragraphs.items.map(i => i.text).join('\\n').match(coq365script_regexp);\n              if (matches.length > 0) {\n                matches.forEach(\n                function (match) {\n                  var evalresult = eval(match.substring(2, match.length - 2));\n                });\n              }\n            } catch (err) { console.error(err); }\n            if ( (/_prelude/i.test(valR.title)) ) {\n              workspace = document.createElement(\"TEXTAREA\");\n              //workspace.setAttribute(\"id\", \"workspace_\" + valR.title.split('/')[0].trim());\n              workspace.setAttribute(\"id\", \"workspace_\" + valR.id);\n              workspaces.appendChild(workspace);\n              //jscoq_ids.push(\"workspace_\" + valR.title.split('/')[0].trim());\n              jscoq_ids.push(\"workspace_\" + valR.id);\n            }\n          }\n        );\n      foundRanges.items.forEach(\n        (valR, iR, aR) => {\n          if (! ((/_prelude/i.test(valR.title)) || (/_format/i.test(valR.title))) ) {\n            workspace = document.createElement(\"TEXTAREA\");\n            //workspace.setAttribute(\"id\", \"workspace_\" + valR.title.split('/')[0].trim());\n            workspace.setAttribute(\"id\", \"workspace_\" + valR.id);\n            workspaces.appendChild(workspace);\n            //jscoq_ids.push(\"workspace_\" + valR.title.split('/')[0].trim());\n            jscoq_ids.push(\"workspace_\" + valR.id);\n          }\n        }\n      );\n      }\n\n      var scriptFile = document.createElement(\"script\");\n      //document.body.append(scriptFile);\n      scriptFile.type = \"text/javascript\";\n      scriptFile.src = jscoq_src;\n      scriptFile.onload = /* setTimeout */(function () {\n        loadJsCoq(jscoq_opts.base_path)\n          .then(\n            () => {\n              coq = new CoqManager(jscoq_ids, jscoq_opts);\n              g.coq = coq;\n\n              readFrom();\n              try { coq.coq.observers.push(coqObserver); }\n\n              catch {\n                //document.querySelector('#buttons').setAttribute('style', 'height : 100px; ' + document.querySelector('#buttons').getAttribute('style'));\n\n                var coqlayoutlog = coq.layout.log.bind(coq.layout);\n                coq.layout.log = (async (text, level) => {\n                  try {\n                    var stm = coq.sentences.last().coq_sid;\n                    if (level == \"info\" || level == \"error\" || level == \"warn\" /* || !( /^feedback for [[]sid:/i.test(text)) */) {\n                      if (transcriptButtonChecked) {\n                        await transcriptStatement(stm, false, text.replace(/============================/g,\n                          '____________________________').replace(/<br [/]>/g, '\\n').replace(/&lt;/g, '<').replace(/&amp;/g, '&'));\n                      }\n                    }\n                    stm = coq.sentences.last().coq_sid;\n                    selectStatement(stm);\n                  }\n                  catch { }\n                  return coqlayoutlog(text, level);\n                })\n\n                var coqlayoutupdate_goals = coq.layout.update_goals.bind(coq.layout);\n                coq.layout.update_goals = (async (str) => {\n                  try {\n                    if (str != \"\") {\n                      if (transcriptButtonChecked) {\n                        setTimeout(async () => {\n                          var stm = coq.sentences.last().coq_sid;\n                          await transcriptStatement(stm, false, '★ ' + str.replace(/============================/g,\n                            '____________________________').replace(/\\nsubgoal (\\d+) is:/g, '\\n★ subgoal $1 is'));\n                          stm = coq.sentences.last().coq_sid;\n                          selectStatement(stm);\n                        }, 50);\n                      } else {\n                        var stm = coq.sentences.last().coq_sid;\n                        selectStatement(stm);\n                      }\n                    }\n                  }\n                  catch { }\n                  return coqlayoutupdate_goals(str);\n                })\n\n              }\n\n\n\n              let buttons = document.querySelector(\"#buttons\");\n\n              var readSelectedButton = document.createElement(\"BUTTON\");\n              readSelectedButton.innerText = \"READ\";\n              //readSelectedButton.setAttribute(\"style\", \"height : 30px\");\n              buttons.appendChild(readSelectedButton);\n              readSelectedButton.onclick = (() => tryCatch(readSelected));\n\n              var writeSelectedButton = document.createElement(\"BUTTON\");\n              writeSelectedButton.innerText = \"WRITE\";\n              buttons.appendChild(writeSelectedButton);\n              writeSelectedButton.onclick = (() => tryCatch(() => writeBack(false)));\n\n              var writeBackButton = document.createElement(\"BUTTON\");\n              writeBackButton.innerText = \"WRITEALL\";\n              buttons.appendChild(writeBackButton);\n              writeBackButton.onclick = (() => tryCatch(() => writeBack(true)));\n\n              buttons.append(\" \");\n              var transcriptButton = document.createElement(\"INPUT\");\n              transcriptButton.setAttribute(\"type\", \"checkbox\");\n              transcriptButton.setAttribute(\"id\", \"transcriptButton\");\n              buttons.appendChild(transcriptButton);\n              transcriptButton.onclick = (() => { transcriptButtonChecked = document.querySelector(\"#transcriptButton\").checked; });\n              buttons.append(\"SCRIPT\");\n\n\n            }\n          )\n      } /* , 3000 */);\n      document.body.append(scriptFile);\n\n      await context.sync();\n\n    });\n  }\n\n});\n\n\n\n\nfunction selectStatement(span_id) {\n  var stm;\n  if (coq.doc && coq.doc.sentences) {\n    stm = coq.doc.sentences.filter(s => s.coq_sid == span_id).last()\n  } else if (coq.sentences) {\n    stm = coq.sentences.filter(s => s.coq_sid == span_id).last()\n  }\n\n  Word.run(async function (context) {\n    var v = context.document.contentControls.getById(stm.sp.ccid).getRange('Content').split([\"\\u000B\", \"\\n\", \"\\r\", \"\u000b\"]);\n    v.load(['length', 'items', 'text']);\n    await context.sync();\n    var rgstart;\n\n    if (stm.text.split(\"\\n\")[0] == \"\") {\n      rgstart = v.items[stm.start.line + 1].search(stm.text.split(\"\\n\")[1]);\n    }\n    else {\n      rgstart = v.items[stm.start.line].search(stm.text.split(\"\\n\")[0]);\n    }\n    rgstart.load(['length']);\n    await context.sync();\n    var rgend = v.items[stm.end.line].search(stm.text.split(\"\\n\").last());\n    rgend.load(['length']);\n    await context.sync();\n\n    var rg = rgstart.items[0];\n    v.items.slice(stm.start.line + 1, stm.end.line).forEach(function (r) { rg = rg.expandTo(r); });\n    rg = rg.expandTo(rgend.items[0]);\n    rg.select();\n    await context.sync();\n  });\n}\n\n\nasync function transcriptStatement(span_id, isHtml, cont) {\n  var stm;\n  if (coq.doc && coq.doc.sentences) {\n    stm = coq.doc.sentences.filter(s => s.coq_sid == span_id).last()\n  } else if (coq.sentences) {\n    stm = coq.sentences.filter(s => s.coq_sid == span_id).last()\n  }\n\n  Word.run(async function (context) {\n    var v = context.document.contentControls.getById(stm.sp.ccid);\n    v.load(['length', 'title', 'items']);\n    await context.sync();\n\n    //let codelang = v.tag.match(/ws365_code_(.*)/i)[1];\n    let cctitle = v.title.replace(/\\s*([^/\\s]+)(.*)/, ' O_$1 / output ');\n    // Note: Word consolas 12 gives adjustWidth() \"Setting printing width to: \"  67 \n    pccc = context.document.contentControls.getByTitle(cctitle);\n    pccc.load(['items', 'length', 'text']);\n    await context.sync();\n    var cc;\n\n    if (pccc.items.length == 0) {\n      cc = v.insertParagraph('', Word.InsertLocation.after).insertContentControl();\n      cc.appearance = Word.ContentControlAppearance.tags;\n      cc.color = \"purple\";\n      cc.tag = \"ws365_code_output\";\n      cc.title = cctitle;\n      cc.load(['text']);\n      await context.sync();\n    }\n    else {\n      cc = pccc.items[0]\n    }\n\n    // if (stm.start.line == 0 && stm.start.ch == 0) {\n    // /!\\INFO AND GOAL DUPLICATE CLEAR PROBLEM/!\\ cc.clear(); }\n    if (cc.text != '')  {\n      cc.insertParagraph(transcriptSeparator, \"End\");\n      cc.insertParagraph('', \"End\");       //v.insertBreak(\"Line\", \"After\"); \n    }\n\n    if (isHtml) {\n      // coq.company_coq.markup.applyToDOM(goals2DOM(cont)[0])\n      cc.insertHtml(cont, \"End\");\n    } else {\n      //  cont_ = '<div>' + coq.pprint.pp2Text(cont).replace(/\\n/g, '<p></p>').replace(/  /g, '&nbsp;&nbsp;') + '</div>';\n      cc.insertText(cont, \"End\");\n    }\n    await context.sync();\n\n    await formatCC(context, cc, 'text');\n  });\n}\n\n\n/**\n * Formats the current proof state.\n * @param {object} goals a record of proof goals \n *                       ({goals, stack, shelf, given_up})\n */\nfunction goals2DOM(goals) {\n  if (goals.goals.length == 0) {\n    return $(document.createTextNode(\"No more goals\"));\n  }\n  else {\n    let ngoals = goals.goals.length;\n    let head = $('<p>')/* .addClass('num-goals') */\n      .text(ngoals === 1 ? `★ 1 goal.` : `★ ${ngoals} goals`);\n\n    let focused_goal = goal2DOM(goals.goals[0]);\n\n    let pending_goals = goals.goals.slice(1).map((goal, i) =>\n      $('<div>')/* .addClass('coq-subgoal-pending') */\n        .append($('<p>').text('★ subgoal ' + (i + 2) + ' is:'))\n        .append(coq.pprint.pp2Text(goal.ty)));\n\n    return $('<div>').append(head, focused_goal, pending_goals);\n  }\n}\n\n/**\n * Formats a single, focused goal.\n * Shows an environment containing hypothesis and goal type.\n * @param {object} goal current goal record ({name, hyp, ty})\n */\nfunction goal2DOM(goal) {\n  let hyps = goal.hyp/* .reverse() */.map(h =>\n    $('<p>')/* .addClass('coq-hypothesis') */\n      .append($('<span>').text(h[0] + ' : '))\n      .append(coq.pprint.pp2Text(h[2])));\n  let ty = coq.pprint.pp2Text(goal.ty);\n  return $('<div>')/* .addClass('coq-env') */.append(hyps, $('<p>').text('____________________________'), ty);\n}\n\nasync function formatCC(context, pccc, codelang) {\n  let docEl = document.createElement(\"PRE\");\n\n  if (Office.context.platform != Office.PlatformType.OfficeOnline) {\n    /* pccc.load('text');\n    await context.sync(); */\n    var valRtext = pccc.split([\"\\n\"], false, false); //.getTextRanges([\"\\n\", \"\\u000B\"], false) //.split([\"\\n\"], false, false); // getTextRanges([], false);          \n    valRtext.load(['items', 'text']);\n    await context.sync();\n    // coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    let op = valRtext.items.map(i => i.text).join('');\n\n    docEl.innerHTML = hljs.highlight(codelang, op.substr(0, op.length)).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    //docEl.style = \"font-family: consolas; color: yellow\";\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    //pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p> </p>').replace( /<[/]p>\\n/g , '</p><p> </p>').replace(/\\n/g, '<p/>').replace(/  /g, '  ') + '</pre>', \"Replace\");\n    pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '\\r\\n') + '\\r\\n</pre>', \"Replace\");\n    //pccc.insertHtml('<pre>' + docEl.innerHTML/* .replace(/\\u000B/g, '\\n') */.replace(/\\n\\n/g, '\\n<br/>').replace( /<br[/]>\\n/g , '<br/><br/>').replace(/\\n/g, '<p/>').replace(/  /g, '  ') + '</pre>', \"Replace\");\n    pccc.styleBuiltIn = \"NoSpacing\";\n  }\n  else {\n    /* pccc.load('text');\n    await context.sync(); */\n    var valRtext = pccc.split([\"\\n\"], false, false); // getTextRanges([], false);          \n    valRtext.load(['items', 'text']);\n    await context.sync();\n    //var arr = valRtext.items.map(i => i.text.split([\"\\u000B\"]) ).flat(1) ;\n    // coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    let op = valRtext.items.map(i => i.text).join('');\n    docEl.innerHTML = hljs.highlight(codelang, op.substr(0, op.length - 1)).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    //docEl.style = \"font-family: consolas; color: yellow\";\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    var jk = docEl.innerHTML.split(/\\r\\n|\\n|\\r|\\u000B/g);\n    pccc.clear();\n\n    for (let j = 0; j < jk.length; j++) {\n      //      pccc.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '<p></p>') + '</pre>', \"Replace\");\n      if (j != jk.length - 1) {\n        pccc.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;') + '<br/>', \"End\");\n\n      } else if (jk[j].length != 0) {\n        pccc.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;'), \"End\");\n      }\n\n      //                pccc.insertHtml('' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p>&nbsp;</p>').replace( /<[/]p>\\n/g , '</p><p>&nbsp;</p>').replace(/\\n/g, '<p/>').replace(/  /g, '&nbsp;&nbsp;') + '', \"Replace\");\n    }\n    /* /!\\ pccc.styleBuiltIn = \"NoSpacing\"; */\n  }\n\n  pccc.font.name = \"Consolas\";\n  await context.sync();\n  document.body.getElementsByClassName('ws365_canvas')[0].removeChild(docEl);\n  docEl.innerHTML = '';\n}\n\nasync function readSelected() {\n  Word.run(async function (context) {\n\n    var foundRanges = context.document.getSelection().parentContentControlOrNullObject;\n    foundRanges.load(['text', 'title']);\n    await context.sync();\n\n    readCC(coq.provider.snippets.find(s => s.title == foundRanges.title.split(\"/\")[0].trim()), foundRanges.id);\n    //coq.provider.snippets.find(s => s.title == foundRanges.title.split(\"/\")[0].trim()).editor.setValue(foundRanges.text);\n  });\n}\n\n\nasync function writeSelected() {\n  writeBack(false);\n}\n\nasync function readCC(siR, cid) {\n  Word.run(async function (context) {\n    var valR = context.document.contentControls.getById(cid);\n    if (Office.context.platform != Office.PlatformType.OfficeOnline) {\n      var valRtext = valR.split([]); // getTextRanges([], false);          \n      valRtext.load(['items', 'text']);\n      /* valR.load([ 'text']); */\n      await context.sync();\n      siR.editor.setValue(/* valR.text */valRtext.items.map(i => i.text).join('\\n').replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    } else {\n      var valRtext = valR.split([]); // getTextRanges([], false);          \n      valRtext.load(['items', 'text']);\n      await context.sync();\n      siR.editor.setValue(valRtext.items.map(i => i.text).join('\\n').replace(/\\r/g, '').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n    }\n    //  coq.provider.snippets[iR].editor.setValue(valRtext.items.map(i => i.text).join('\\n').replace(/\\u000B/g, '\\n').normalize('NFKD'));\n  });\n  //  coq.provider.snippets[iR].editor.setValue(valR.text.replace(/\\u000B/g, '\\n').normalize('NFKD'));\n\n}\n\nasync function readFrom() {\n  Word.run(async function (context) {\n\n    var foundRanges = context.document.contentControls.getByTag('ws365_code_coq');\n    foundRanges.load(['length', 'items', 'text', 'title']);\n    await context.sync();\n    var count = 0;\n\n    foundRanges.items.filter((valR, iR, aR) => (/_prelude/i.test(valR.title)) ).forEach(\n      async (valR, iR, aR) => {\n        if (coq.provider.snippets[iR]) {\n          count = count + 1;\n          coq.provider.snippets[iR].title = valR.title.split('/')[0].trim();\n          coq.provider.snippets[iR].ccid = valR.id;\n          var cid = valR.id;\n          var ctitle = valR.title.split('/')[0].trim();\n          window.setTimeout(async () => {\n            await readCC(coq.provider.snippets[iR], cid);\n            //context.sync();\n          }, 50 * iR);\n        }\n      }\n    );\n    foundRanges.items.filter((valR, iR, aR) => (! ((/_prelude/i.test(valR.title)) || (/_format/i.test(valR.title))) ) ).forEach(\n      async (valR, iR, aR) => {\n        if (coq.provider.snippets[count+iR]) {\n          coq.provider.snippets[count+iR].title = valR.title.split('/')[0].trim();\n          coq.provider.snippets[count+iR].ccid = valR.id;\n          var cid = valR.id;\n          var ctitle = valR.title.split('/')[0].trim();\n          window.setTimeout(async () => {\n            await readCC(coq.provider.snippets[count+iR], cid);\n            //context.sync();\n          }, 50 * iR);\n        }\n      }\n    );\n    \n\n    return context.sync();\n  })\n}\n\n\nasync function writeBack(writeAll) {\n  Word.run(async function (context) {\n\n    var foundRanges = context.document.contentControls.getByTag('ws365_code_coq');\n\n    foundRanges.load(['length', 'title']);\n    await context.sync();\n\n    //foundRanges.items.forEach(\n    //    (valR, iR, aR) => {\n    for (let iR = 0; iR < foundRanges.items.length; iR++) {\n      const valR = foundRanges.items[iR];\n      if (writeAll || coq.provider.currentFocus.title == valR.title.split(\"/\")[0].trim()) {\n        await write(context, valR);\n      }\n    }\n\n  })\n}\n\n\nasync function write(context, valR) {\n  try {\n    //valR.insertText(coq.provider.snippets.find(s => s.title == foundRanges.title.split(\"/\")[0].trim()).editor.getValue(), Word.InsertLocation.replace);\n    // valR.insertHtml(\"<pre>\" + coq.provider.snippets[iR].editor.getValue().replace(/\\n/g, \"<p></p>\") + \"</pre>\", Word.InsertLocation.replace);\n    var docEl = document.createElement(\"PRE\");\n    docEl.innerHTML = hljs.highlight('coq', coq.provider.snippets.find(s => s.title == valR.title.split(\"/\")[0].trim()).editor.getValue()).value;\n    document.body.getElementsByClassName('ws365_canvas')[0].appendChild(docEl);\n    computedStyleToInlineStyle(docEl, { recursive: true, properties: [\"color\", \"font-style\", \"font-weight\"] });\n    //console.log('-----------------replace', docEl.outerHTML.replaceAll(/\\n(.*?)\\n/g, '<p>$1</p>').replaceAll(/  /g, '&nbsp&nbsp'));\n    //valR.insertHtml('<pre><p>'+ docEl.innerHTML.replaceAll(/\\n/g, '</p><p>') + '</p></pre>', \"Replace\");\n\n    if (Office.context.platform != Office.PlatformType.OfficeOnline) {\n      valR.insertHtml('<pre>' + docEl.innerHTML.replace(/\\u000B/g, '<br/>').replace(/\\n/g, '\\r\\n') + '\\r\\n</pre>', \"Replace\");\n      valR.styleBuiltIn = \"NoSpacing\";\n    }\n    else {\n      var jk = docEl.innerHTML.split(/\\r\\n|\\n|\\r|\\u000B/g);\n      valR.clear();\n      for (let j = 0; j < jk.length; j++) {\n        if (j != jk.length - 1) {\n          valR.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;') + '<br/>', \"End\");\n\n        } else if (jk[j].length != 0) {\n          valR.insertHtml(jk[j].replace(/  /g, '&nbsp;&nbsp;'), \"End\");\n        }\n      }\n      /* /!\\ valR.styleBuiltIn = \"NoSpacing\"; */\n    }\n    //valR.insertHtml('' + docEl.innerHTML.replace(/\\u000B/g, '\\n').replace(/\\n\\n/g, '\\n<p>&nbsp;</p>').replace( /<[/]p>\\n/g , '</p><p>&nbsp;</p>').replace(/\\n/g, '<p/>').replace(/  /g, '&nbsp;&nbsp;') + '', \"Replace\");\n\n\n    valR.font.name = \"Consolas\";\n    docEl.innerHTML = '';\n    document.body.getElementsByClassName('ws365_canvas')[0].removeChild(docEl);\n    await context.sync();\n\n\n    // window.setTimeout( () => {\n    //   console.log('-----------------settimeout', iR);\n    //    context.sync();            \n    // }, 10000*iR);\n  } catch (err) { console.error(err); }\n}","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}